(function(u,Mt){typeof exports=="object"&&typeof module<"u"?Mt(exports):typeof define=="function"&&define.amd?define(["exports"],Mt):(u=typeof globalThis<"u"?globalThis:u||self,Mt(u.deepslate={}))})(this,function(u){"use strict";var mu=Object.defineProperty;var gu=(u,Mt,Se)=>Mt in u?mu(u,Mt,{enumerable:!0,configurable:!0,writable:!0,value:Se}):u[Mt]=Se;var _=(u,Mt,Se)=>(gu(u,typeof Mt!="symbol"?Mt+"":Mt,Se),Se);function Mt(n){var t=n.slice(0,2);return t.length===2&&t[0]===31&&t[1]===139}function Se(n){const t=n.slice(0,2);return t.length===2&&t[0]===120&&(t[1]===1||t[1]===94||t[1]===156||t[2]===218)}function oa(n){const t=n.slice(0,8),e=new DataView(t.buffer,t.byteOffset),r=e.getUint32(0,!0),i=e.getUint32(4,!0);if(t.length===8&&r>0&&r<100&&i===n.byteLength-8)return r}function ca(n){var t=[],e,r;for(e=0;e<n.length;e++)r=n.charCodeAt(e),r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|r&63)):r<65536?(t.push(224|r>>12),t.push(128|r>>6&63),t.push(128|r&63)):(t.push(240|r>>18&7),t.push(128|r>>12&63),t.push(128|r>>6&63),t.push(128|r&63));return t}function la(n){var t=[],e;for(e=0;e<n.length;e++)(n[e]&128)===0?t.push(n[e]&127):e+1<n.length&&(n[e]&224)===192&&(n[e+1]&192)===128?t.push((n[e]&31)<<6|n[e+1]&63):e+2<n.length&&(n[e]&240)===224&&(n[e+1]&192)===128&&(n[e+2]&192)===128?t.push((n[e]&15)<<12|(n[e+1]&63)<<6|n[e+2]&63):e+3<n.length&&(n[e]&248)===240&&(n[e+1]&192)===128&&(n[e+2]&192)===128&&(n[e+3]&192)===128&&t.push((n[e]&7)<<18|(n[e+1]&63)<<12|(n[e+2]&63)<<6|n[e+3]&63);return String.fromCharCode.apply(null,t)}class hi{constructor(t,e){_(this,"littleEndian");_(this,"offset");_(this,"array");_(this,"view");_(this,"readByte",this.readNumber.bind(this,"getInt8",1));_(this,"readShort",this.readNumber.bind(this,"getInt16",2));_(this,"readInt",this.readNumber.bind(this,"getInt32",4));_(this,"readFloat",this.readNumber.bind(this,"getFloat32",4));_(this,"readDouble",this.readNumber.bind(this,"getFloat64",8));var r,i;this.littleEndian=(r=e==null?void 0:e.littleEndian)!=null?r:!1,this.offset=(i=e==null?void 0:e.offset)!=null?i:0,this.array=t instanceof Uint8Array?t:new Uint8Array(t),this.view=new DataView(this.array.buffer,this.array.byteOffset)}readNumber(t,e){const r=this.view[t](this.offset,this.littleEndian);return this.offset+=e,r}readBytes(t){const e=this.array.slice(this.offset,this.offset+t);return this.offset+=t,e}readString(){const t=this.readShort(),e=this.readBytes(t);return la(e)}}class fi{constructor(t){_(this,"littleEndian");_(this,"offset");_(this,"buffer");_(this,"array");_(this,"view");_(this,"writeByte",this.writeNumber.bind(this,"setInt8",1));_(this,"writeShort",this.writeNumber.bind(this,"setInt16",2));_(this,"writeInt",this.writeNumber.bind(this,"setInt32",4));_(this,"writeFloat",this.writeNumber.bind(this,"setFloat32",4));_(this,"writeDouble",this.writeNumber.bind(this,"setFloat64",8));var e,r,i;this.littleEndian=(e=t==null?void 0:t.littleEndian)!=null?e:!1,this.offset=(r=t==null?void 0:t.offset)!=null?r:0,this.buffer=new ArrayBuffer((i=t==null?void 0:t.initialSize)!=null?i:1024),this.array=new Uint8Array(this.buffer),this.view=new DataView(this.buffer)}accommodate(t){const e=this.offset+t;if(this.buffer.byteLength>=e)return;let r=this.buffer.byteLength;for(;r<e;)r*=2;const i=new ArrayBuffer(r),s=new Uint8Array(i);s.set(this.array),this.offset>this.buffer.byteLength&&s.fill(0,this.buffer.byteLength,this.offset),this.buffer=i,this.view=new DataView(i),this.array=s}writeNumber(t,e,r){this.accommodate(e),this.view[t](this.offset,r,this.littleEndian),this.offset+=e}writeBytes(t){this.accommodate(t.length),this.array.set(t,this.offset),this.offset+=t.length}writeString(t){const e=ca(t);this.writeShort(e.length),this.writeBytes(e)}getData(){return this.accommodate(0),this.array.slice(0,this.offset)}}u.Json=void 0,(n=>{function t(h){return typeof h=="number"?h:void 0}n.readNumber=t;function e(h){return typeof h=="number"?Math.floor(h):void 0}n.readInt=e;function r(h){return typeof h=="string"?h:void 0}n.readString=r;function i(h){return typeof h=="boolean"?h:void 0}n.readBoolean=i;function s(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)?h:void 0}n.readObject=s;function a(h,d){if(!!Array.isArray(h))return d?h.map(f=>d(f)):h}n.readArray=a;function o(h,d){if(!!Array.isArray(h))return[0,1].map(f=>d(h[f]))}n.readPair=o;function m(h,d){var p;const f=(p=s(h))!=null?p:{};return Object.fromEntries(Object.entries(f).map(([v,g])=>[v,d(g)]))}n.readMap=m;function c(h,d,f){const p=d(h);return p?f(p):void 0}n.compose=c;function l(h,d){return typeof h!="string"?d[0]:d.includes(h)?h:d[0]}n.readEnum=l})(u.Json||(u.Json={})),u.Color=void 0,(n=>{function t(i){const s=u.Json.readNumber(i);if(s)return r(s);const a=u.Json.readArray(i,o=>{var m;return(m=u.Json.readNumber(o))!=null?m:0});if(!(a===void 0||a.length!==3))return a}n.fromJson=t;function e(i){if(i.isNumber())return r(i.getAsNumber());if(!i.isListOrArray())return;const s=i.getItems();if(!(s.length<3))return s.map(a=>a.getAsNumber())}n.fromNbt=e;function r(i){const s=i>>16&255,a=i>>8&255,o=i&255;return[s/255,a/255,o/255]}n.intToRgb=r})(u.Color||(u.Color={}));class Et{constructor(t){_(this,"source");_(this,"cursor");this.source=t,this.cursor=0}get remainingLength(){return this.source.length-this.cursor}get totalLength(){return this.source.length}getRead(t=0){return this.source.substring(t,this.cursor)}getRemaining(){return this.source.substring(this.cursor)}canRead(t=1){return this.cursor+t<=this.source.length}peek(t=0){return this.source.charAt(this.cursor+t)}read(){return this.source.charAt(this.cursor++)}skip(){this.cursor+=1}skipWhitespace(){for(;this.canRead()&&Et.isWhitespace(this.peek());)this.skip()}expect(t,e=!1){if(e&&this.skipWhitespace(),!this.canRead()||this.peek()!==t)throw this.createError(`Expected '${t}'`);this.skip()}readInt(){const t=this.cursor;for(;this.canRead()&&Et.isAllowedInNumber(this.peek());)this.skip();const e=this.getRead(t);if(e.length===0)throw this.createError("Expected integer");try{const r=Number(e);if(isNaN(r)||!Number.isInteger(r))throw new Error;return r}catch{throw this.cursor=t,this.createError(`Invalid integer '${e}'`)}}readFloat(){const t=this.cursor;for(;this.canRead()&&Et.isAllowedInNumber(this.peek());)this.skip();const e=this.getRead(t);if(e.length===0)throw this.createError("Expected float");try{const r=Number(e);if(isNaN(r))throw new Error;return r}catch{throw this.cursor=t,this.createError(`Invalid float '${e}'`)}}readUnquotedString(){const t=this.cursor;for(;this.canRead()&&Et.isAllowedInUnquotedString(this.peek());)this.skip();return this.getRead(t)}readQuotedString(){if(!this.canRead())return"";const t=this.peek();if(!Et.isQuotedStringStart(t))throw this.createError("Expected quote to start a string");return this.skip(),this.readStringUntil(t)}readString(){if(!this.canRead())return"";const t=this.peek();return Et.isQuotedStringStart(t)?(this.skip(),this.readStringUntil(t)):this.readUnquotedString()}readStringUntil(t){const e=[];let r=!1;for(;this.canRead();){const i=this.read();if(r)if(i===t||i==="\\")e.push(i),r=!1;else throw this.cursor-=1,this.createError(`Invalid escape sequence '${i}' in quoted string`);else if(i==="\\")r=!0;else{if(i===t)return e.join("");e.push(i)}}throw this.createError("Unclosed quoted string")}readBoolean(){const t=this.cursor,e=this.readUnquotedString();if(e.length===0)throw this.createError("Expected bool");if(e==="true")return!0;if(e==="false")return!1;throw this.cursor=t,this.createError(`Invalid bool, expected true or false but found '${e}'`)}static isAllowedInNumber(t){return t>="0"&&t<="9"||t==="."||t==="-"}static isAllowedInUnquotedString(t){return t>="0"&&t<="9"||t>="A"&&t<="Z"||t>="a"&&t<="z"||t==="_"||t==="-"||t==="."||t==="+"}static isQuotedStringStart(t){return t==="'"||t==='"'}static isWhitespace(t){return t===" "||t==="	"||t===`
`||t==="\r"}createError(t){const e=Math.min(this.source.length,this.cursor),r=(e>10?"...":"")+this.source.substring(Math.max(0,e-10),e);return new Error(`${t} at position ${this.cursor}: ${r}<--[HERE]`)}}function an(n){let t=null;return()=>(t==null&&(t=n()),t)}function Ee(n,t,e){const r=n.get(t);if(r!==void 0)return r;const i=e(t);return n.set(t,i),i}function _r(n,t,e,r){const i=n.get(t),s=i!=null?i:e;return r(s,t),n.set(t,s),s}/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const ua=4,di=0,mi=1,ha=2;function Ge(n){let t=n.length;for(;--t>=0;)n[t]=0}const fa=0,gi=1,da=2,ma=3,ga=258,br=29,on=256,cn=on+1+br,Ve=30,yr=19,pi=2*cn+1,Ie=15,Sr=16,pa=7,Er=256,wi=16,vi=17,_i=18,Ir=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Dn=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),wa=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bi=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),va=512,jt=new Array((cn+2)*2);Ge(jt);const ln=new Array(Ve*2);Ge(ln);const un=new Array(va);Ge(un);const hn=new Array(ga-ma+1);Ge(hn);const kr=new Array(br);Ge(kr);const Fn=new Array(Ve);Ge(Fn);function Ar(n,t,e,r,i){this.static_tree=n,this.extra_bits=t,this.extra_base=e,this.elems=r,this.max_length=i,this.has_stree=n&&n.length}let yi,Si,Ei;function Mr(n,t){this.dyn_tree=n,this.max_code=0,this.stat_desc=t}const Ii=n=>n<256?un[n]:un[256+(n>>>7)],fn=(n,t)=>{n.pending_buf[n.pending++]=t&255,n.pending_buf[n.pending++]=t>>>8&255},It=(n,t,e)=>{n.bi_valid>Sr-e?(n.bi_buf|=t<<n.bi_valid&65535,fn(n,n.bi_buf),n.bi_buf=t>>Sr-n.bi_valid,n.bi_valid+=e-Sr):(n.bi_buf|=t<<n.bi_valid&65535,n.bi_valid+=e)},Zt=(n,t,e)=>{It(n,e[t*2],e[t*2+1])},ki=(n,t)=>{let e=0;do e|=n&1,n>>>=1,e<<=1;while(--t>0);return e>>>1},_a=n=>{n.bi_valid===16?(fn(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=n.bi_buf&255,n.bi_buf>>=8,n.bi_valid-=8)},ba=(n,t)=>{const e=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,m=t.stat_desc.max_length;let c,l,h,d,f,p,v=0;for(d=0;d<=Ie;d++)n.bl_count[d]=0;for(e[n.heap[n.heap_max]*2+1]=0,c=n.heap_max+1;c<pi;c++)l=n.heap[c],d=e[e[l*2+1]*2+1]+1,d>m&&(d=m,v++),e[l*2+1]=d,!(l>r)&&(n.bl_count[d]++,f=0,l>=o&&(f=a[l-o]),p=e[l*2],n.opt_len+=p*(d+f),s&&(n.static_len+=p*(i[l*2+1]+f)));if(v!==0){do{for(d=m-1;n.bl_count[d]===0;)d--;n.bl_count[d]--,n.bl_count[d+1]+=2,n.bl_count[m]--,v-=2}while(v>0);for(d=m;d!==0;d--)for(l=n.bl_count[d];l!==0;)h=n.heap[--c],!(h>r)&&(e[h*2+1]!==d&&(n.opt_len+=(d-e[h*2+1])*e[h*2],e[h*2+1]=d),l--)}},Ai=(n,t,e)=>{const r=new Array(Ie+1);let i=0,s,a;for(s=1;s<=Ie;s++)r[s]=i=i+e[s-1]<<1;for(a=0;a<=t;a++){let o=n[a*2+1];o!==0&&(n[a*2]=ki(r[o]++,o))}},ya=()=>{let n,t,e,r,i;const s=new Array(Ie+1);for(e=0,r=0;r<br-1;r++)for(kr[r]=e,n=0;n<1<<Ir[r];n++)hn[e++]=r;for(hn[e-1]=r,i=0,r=0;r<16;r++)for(Fn[r]=i,n=0;n<1<<Dn[r];n++)un[i++]=r;for(i>>=7;r<Ve;r++)for(Fn[r]=i<<7,n=0;n<1<<Dn[r]-7;n++)un[256+i++]=r;for(t=0;t<=Ie;t++)s[t]=0;for(n=0;n<=143;)jt[n*2+1]=8,n++,s[8]++;for(;n<=255;)jt[n*2+1]=9,n++,s[9]++;for(;n<=279;)jt[n*2+1]=7,n++,s[7]++;for(;n<=287;)jt[n*2+1]=8,n++,s[8]++;for(Ai(jt,cn+1,s),n=0;n<Ve;n++)ln[n*2+1]=5,ln[n*2]=ki(n,5);yi=new Ar(jt,Ir,on+1,cn,Ie),Si=new Ar(ln,Dn,0,Ve,Ie),Ei=new Ar(new Array(0),wa,0,yr,pa)},Mi=n=>{let t;for(t=0;t<cn;t++)n.dyn_ltree[t*2]=0;for(t=0;t<Ve;t++)n.dyn_dtree[t*2]=0;for(t=0;t<yr;t++)n.bl_tree[t*2]=0;n.dyn_ltree[Er*2]=1,n.opt_len=n.static_len=0,n.last_lit=n.matches=0},xi=n=>{n.bi_valid>8?fn(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},Sa=(n,t,e,r)=>{xi(n),r&&(fn(n,e),fn(n,~e)),n.pending_buf.set(n.window.subarray(t,t+e),n.pending),n.pending+=e},Ri=(n,t,e,r)=>{const i=t*2,s=e*2;return n[i]<n[s]||n[i]===n[s]&&r[t]<=r[e]},xr=(n,t,e)=>{const r=n.heap[e];let i=e<<1;for(;i<=n.heap_len&&(i<n.heap_len&&Ri(t,n.heap[i+1],n.heap[i],n.depth)&&i++,!Ri(t,r,n.heap[i],n.depth));)n.heap[e]=n.heap[i],e=i,i<<=1;n.heap[e]=r},Ci=(n,t,e)=>{let r,i,s=0,a,o;if(n.last_lit!==0)do r=n.pending_buf[n.d_buf+s*2]<<8|n.pending_buf[n.d_buf+s*2+1],i=n.pending_buf[n.l_buf+s],s++,r===0?Zt(n,i,t):(a=hn[i],Zt(n,a+on+1,t),o=Ir[a],o!==0&&(i-=kr[a],It(n,i,o)),r--,a=Ii(r),Zt(n,a,e),o=Dn[a],o!==0&&(r-=Fn[a],It(n,r,o)));while(s<n.last_lit);Zt(n,Er,t)},Rr=(n,t)=>{const e=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let a,o,m=-1,c;for(n.heap_len=0,n.heap_max=pi,a=0;a<s;a++)e[a*2]!==0?(n.heap[++n.heap_len]=m=a,n.depth[a]=0):e[a*2+1]=0;for(;n.heap_len<2;)c=n.heap[++n.heap_len]=m<2?++m:0,e[c*2]=1,n.depth[c]=0,n.opt_len--,i&&(n.static_len-=r[c*2+1]);for(t.max_code=m,a=n.heap_len>>1;a>=1;a--)xr(n,e,a);c=s;do a=n.heap[1],n.heap[1]=n.heap[n.heap_len--],xr(n,e,1),o=n.heap[1],n.heap[--n.heap_max]=a,n.heap[--n.heap_max]=o,e[c*2]=e[a*2]+e[o*2],n.depth[c]=(n.depth[a]>=n.depth[o]?n.depth[a]:n.depth[o])+1,e[a*2+1]=e[o*2+1]=c,n.heap[1]=c++,xr(n,e,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],ba(n,t),Ai(e,m,n.bl_count)},Ni=(n,t,e)=>{let r,i=-1,s,a=t[0*2+1],o=0,m=7,c=4;for(a===0&&(m=138,c=3),t[(e+1)*2+1]=65535,r=0;r<=e;r++)s=a,a=t[(r+1)*2+1],!(++o<m&&s===a)&&(o<c?n.bl_tree[s*2]+=o:s!==0?(s!==i&&n.bl_tree[s*2]++,n.bl_tree[wi*2]++):o<=10?n.bl_tree[vi*2]++:n.bl_tree[_i*2]++,o=0,i=s,a===0?(m=138,c=3):s===a?(m=6,c=3):(m=7,c=4))},Bi=(n,t,e)=>{let r,i=-1,s,a=t[0*2+1],o=0,m=7,c=4;for(a===0&&(m=138,c=3),r=0;r<=e;r++)if(s=a,a=t[(r+1)*2+1],!(++o<m&&s===a)){if(o<c)do Zt(n,s,n.bl_tree);while(--o!==0);else s!==0?(s!==i&&(Zt(n,s,n.bl_tree),o--),Zt(n,wi,n.bl_tree),It(n,o-3,2)):o<=10?(Zt(n,vi,n.bl_tree),It(n,o-3,3)):(Zt(n,_i,n.bl_tree),It(n,o-11,7));o=0,i=s,a===0?(m=138,c=3):s===a?(m=6,c=3):(m=7,c=4)}},Ea=n=>{let t;for(Ni(n,n.dyn_ltree,n.l_desc.max_code),Ni(n,n.dyn_dtree,n.d_desc.max_code),Rr(n,n.bl_desc),t=yr-1;t>=3&&n.bl_tree[bi[t]*2+1]===0;t--);return n.opt_len+=3*(t+1)+5+5+4,t},Ia=(n,t,e,r)=>{let i;for(It(n,t-257,5),It(n,e-1,5),It(n,r-4,4),i=0;i<r;i++)It(n,n.bl_tree[bi[i]*2+1],3);Bi(n,n.dyn_ltree,t-1),Bi(n,n.dyn_dtree,e-1)},ka=n=>{let t=4093624447,e;for(e=0;e<=31;e++,t>>>=1)if(t&1&&n.dyn_ltree[e*2]!==0)return di;if(n.dyn_ltree[9*2]!==0||n.dyn_ltree[10*2]!==0||n.dyn_ltree[13*2]!==0)return mi;for(e=32;e<on;e++)if(n.dyn_ltree[e*2]!==0)return mi;return di};let Ti=!1;const Aa=n=>{Ti||(ya(),Ti=!0),n.l_desc=new Mr(n.dyn_ltree,yi),n.d_desc=new Mr(n.dyn_dtree,Si),n.bl_desc=new Mr(n.bl_tree,Ei),n.bi_buf=0,n.bi_valid=0,Mi(n)},Li=(n,t,e,r)=>{It(n,(fa<<1)+(r?1:0),3),Sa(n,t,e,!0)},Ma=n=>{It(n,gi<<1,3),Zt(n,Er,jt),_a(n)},xa=(n,t,e,r)=>{let i,s,a=0;n.level>0?(n.strm.data_type===ha&&(n.strm.data_type=ka(n)),Rr(n,n.l_desc),Rr(n,n.d_desc),a=Ea(n),i=n.opt_len+3+7>>>3,s=n.static_len+3+7>>>3,s<=i&&(i=s)):i=s=e+5,e+4<=i&&t!==-1?Li(n,t,e,r):n.strategy===ua||s===i?(It(n,(gi<<1)+(r?1:0),3),Ci(n,jt,ln)):(It(n,(da<<1)+(r?1:0),3),Ia(n,n.l_desc.max_code+1,n.d_desc.max_code+1,a+1),Ci(n,n.dyn_ltree,n.dyn_dtree)),Mi(n),r&&xi(n)},Ra=(n,t,e)=>(n.pending_buf[n.d_buf+n.last_lit*2]=t>>>8&255,n.pending_buf[n.d_buf+n.last_lit*2+1]=t&255,n.pending_buf[n.l_buf+n.last_lit]=e&255,n.last_lit++,t===0?n.dyn_ltree[e*2]++:(n.matches++,t--,n.dyn_ltree[(hn[e]+on+1)*2]++,n.dyn_dtree[Ii(t)*2]++),n.last_lit===n.lit_bufsize-1);var Ca=Aa,Na=Li,Ba=xa,Ta=Ra,La=Ma,Pa={_tr_init:Ca,_tr_stored_block:Na,_tr_flush_block:Ba,_tr_tally:Ta,_tr_align:La},dn=(n,t,e,r)=>{let i=n&65535|0,s=n>>>16&65535|0,a=0;for(;e!==0;){a=e>2e3?2e3:e,e-=a;do i=i+t[r++]|0,s=s+i|0;while(--a);i%=65521,s%=65521}return i|s<<16|0};const Oa=()=>{let n,t=[];for(var e=0;e<256;e++){n=e;for(var r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;t[e]=n}return t},Ja=new Uint32Array(Oa());var dt=(n,t,e,r)=>{const i=Ja,s=r+e;n^=-1;for(let a=r;a<s;a++)n=n>>>8^i[(n^t[a])&255];return n^-1},ke={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ae={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:za,_tr_stored_block:Da,_tr_flush_block:Fa,_tr_tally:oe,_tr_align:Ha}=Pa,{Z_NO_FLUSH:Me,Z_PARTIAL_FLUSH:Ua,Z_FULL_FLUSH:Za,Z_FINISH:ce,Z_BLOCK:Pi,Z_OK:Gt,Z_STREAM_END:Oi,Z_STREAM_ERROR:Bt,Z_DATA_ERROR:Ga,Z_BUF_ERROR:Cr,Z_DEFAULT_COMPRESSION:Va,Z_FILTERED:$a,Z_HUFFMAN_ONLY:Hn,Z_RLE:Ya,Z_FIXED:qa,Z_DEFAULT_STRATEGY:Wa,Z_UNKNOWN:Xa,Z_DEFLATED:Un}=Ae,ja=9,Ka=15,Qa=8,to=29,Nr=256+1+to,eo=30,no=19,ro=2*Nr+1,io=15,K=3,le=258,zt=le+K+1,so=32,Zn=42,Br=69,Gn=73,Vn=91,$n=103,xe=113,mn=666,ht=1,gn=2,Re=3,$e=4,ao=3,ue=(n,t)=>(n.msg=ke[t],t),Ji=n=>(n<<1)-(n>4?9:0),he=n=>{let t=n.length;for(;--t>=0;)n[t]=0};let fe=(n,t,e)=>(t<<n.hash_shift^e)&n.hash_mask;const de=n=>{const t=n.state;let e=t.pending;e>n.avail_out&&(e=n.avail_out),e!==0&&(n.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),n.next_out),n.next_out+=e,t.pending_out+=e,n.total_out+=e,n.avail_out-=e,t.pending-=e,t.pending===0&&(t.pending_out=0))},gt=(n,t)=>{Fa(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,t),n.block_start=n.strstart,de(n.strm)},tt=(n,t)=>{n.pending_buf[n.pending++]=t},pn=(n,t)=>{n.pending_buf[n.pending++]=t>>>8&255,n.pending_buf[n.pending++]=t&255},oo=(n,t,e,r)=>{let i=n.avail_in;return i>r&&(i=r),i===0?0:(n.avail_in-=i,t.set(n.input.subarray(n.next_in,n.next_in+i),e),n.state.wrap===1?n.adler=dn(n.adler,t,i,e):n.state.wrap===2&&(n.adler=dt(n.adler,t,i,e)),n.next_in+=i,n.total_in+=i,i)},zi=(n,t)=>{let e=n.max_chain_length,r=n.strstart,i,s,a=n.prev_length,o=n.nice_match;const m=n.strstart>n.w_size-zt?n.strstart-(n.w_size-zt):0,c=n.window,l=n.w_mask,h=n.prev,d=n.strstart+le;let f=c[r+a-1],p=c[r+a];n.prev_length>=n.good_match&&(e>>=2),o>n.lookahead&&(o=n.lookahead);do if(i=t,!(c[i+a]!==p||c[i+a-1]!==f||c[i]!==c[r]||c[++i]!==c[r+1])){r+=2,i++;do;while(c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&r<d);if(s=le-(d-r),r=d-le,s>a){if(n.match_start=t,a=s,s>=o)break;f=c[r+a-1],p=c[r+a]}}while((t=h[t&l])>m&&--e!==0);return a<=n.lookahead?a:n.lookahead},Ce=n=>{const t=n.w_size;let e,r,i,s,a;do{if(s=n.window_size-n.lookahead-n.strstart,n.strstart>=t+(t-zt)){n.window.set(n.window.subarray(t,t+t),0),n.match_start-=t,n.strstart-=t,n.block_start-=t,r=n.hash_size,e=r;do i=n.head[--e],n.head[e]=i>=t?i-t:0;while(--r);r=t,e=r;do i=n.prev[--e],n.prev[e]=i>=t?i-t:0;while(--r);s+=t}if(n.strm.avail_in===0)break;if(r=oo(n.strm,n.window,n.strstart+n.lookahead,s),n.lookahead+=r,n.lookahead+n.insert>=K)for(a=n.strstart-n.insert,n.ins_h=n.window[a],n.ins_h=fe(n,n.ins_h,n.window[a+1]);n.insert&&(n.ins_h=fe(n,n.ins_h,n.window[a+K-1]),n.prev[a&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=a,a++,n.insert--,!(n.lookahead+n.insert<K)););}while(n.lookahead<zt&&n.strm.avail_in!==0)},co=(n,t)=>{let e=65535;for(e>n.pending_buf_size-5&&(e=n.pending_buf_size-5);;){if(n.lookahead<=1){if(Ce(n),n.lookahead===0&&t===Me)return ht;if(n.lookahead===0)break}n.strstart+=n.lookahead,n.lookahead=0;const r=n.block_start+e;if((n.strstart===0||n.strstart>=r)&&(n.lookahead=n.strstart-r,n.strstart=r,gt(n,!1),n.strm.avail_out===0)||n.strstart-n.block_start>=n.w_size-zt&&(gt(n,!1),n.strm.avail_out===0))return ht}return n.insert=0,t===ce?(gt(n,!0),n.strm.avail_out===0?Re:$e):(n.strstart>n.block_start&&(gt(n,!1),n.strm.avail_out===0),ht)},Tr=(n,t)=>{let e,r;for(;;){if(n.lookahead<zt){if(Ce(n),n.lookahead<zt&&t===Me)return ht;if(n.lookahead===0)break}if(e=0,n.lookahead>=K&&(n.ins_h=fe(n,n.ins_h,n.window[n.strstart+K-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),e!==0&&n.strstart-e<=n.w_size-zt&&(n.match_length=zi(n,e)),n.match_length>=K)if(r=oe(n,n.strstart-n.match_start,n.match_length-K),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=K){n.match_length--;do n.strstart++,n.ins_h=fe(n,n.ins_h,n.window[n.strstart+K-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!==0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=fe(n,n.ins_h,n.window[n.strstart+1]);else r=oe(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(r&&(gt(n,!1),n.strm.avail_out===0))return ht}return n.insert=n.strstart<K-1?n.strstart:K-1,t===ce?(gt(n,!0),n.strm.avail_out===0?Re:$e):n.last_lit&&(gt(n,!1),n.strm.avail_out===0)?ht:gn},Ye=(n,t)=>{let e,r,i;for(;;){if(n.lookahead<zt){if(Ce(n),n.lookahead<zt&&t===Me)return ht;if(n.lookahead===0)break}if(e=0,n.lookahead>=K&&(n.ins_h=fe(n,n.ins_h,n.window[n.strstart+K-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=K-1,e!==0&&n.prev_length<n.max_lazy_match&&n.strstart-e<=n.w_size-zt&&(n.match_length=zi(n,e),n.match_length<=5&&(n.strategy===$a||n.match_length===K&&n.strstart-n.match_start>4096)&&(n.match_length=K-1)),n.prev_length>=K&&n.match_length<=n.prev_length){i=n.strstart+n.lookahead-K,r=oe(n,n.strstart-1-n.prev_match,n.prev_length-K),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=i&&(n.ins_h=fe(n,n.ins_h,n.window[n.strstart+K-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!==0);if(n.match_available=0,n.match_length=K-1,n.strstart++,r&&(gt(n,!1),n.strm.avail_out===0))return ht}else if(n.match_available){if(r=oe(n,0,n.window[n.strstart-1]),r&&gt(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return ht}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(r=oe(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<K-1?n.strstart:K-1,t===ce?(gt(n,!0),n.strm.avail_out===0?Re:$e):n.last_lit&&(gt(n,!1),n.strm.avail_out===0)?ht:gn},lo=(n,t)=>{let e,r,i,s;const a=n.window;for(;;){if(n.lookahead<=le){if(Ce(n),n.lookahead<=le&&t===Me)return ht;if(n.lookahead===0)break}if(n.match_length=0,n.lookahead>=K&&n.strstart>0&&(i=n.strstart-1,r=a[i],r===a[++i]&&r===a[++i]&&r===a[++i])){s=n.strstart+le;do;while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<s);n.match_length=le-(s-i),n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=K?(e=oe(n,1,n.match_length-K),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(e=oe(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),e&&(gt(n,!1),n.strm.avail_out===0))return ht}return n.insert=0,t===ce?(gt(n,!0),n.strm.avail_out===0?Re:$e):n.last_lit&&(gt(n,!1),n.strm.avail_out===0)?ht:gn},uo=(n,t)=>{let e;for(;;){if(n.lookahead===0&&(Ce(n),n.lookahead===0)){if(t===Me)return ht;break}if(n.match_length=0,e=oe(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,e&&(gt(n,!1),n.strm.avail_out===0))return ht}return n.insert=0,t===ce?(gt(n,!0),n.strm.avail_out===0?Re:$e):n.last_lit&&(gt(n,!1),n.strm.avail_out===0)?ht:gn};function Vt(n,t,e,r,i){this.good_length=n,this.max_lazy=t,this.nice_length=e,this.max_chain=r,this.func=i}const wn=[new Vt(0,0,0,0,co),new Vt(4,4,8,4,Tr),new Vt(4,5,16,8,Tr),new Vt(4,6,32,32,Tr),new Vt(4,4,16,16,Ye),new Vt(8,16,32,32,Ye),new Vt(8,16,128,128,Ye),new Vt(8,32,128,256,Ye),new Vt(32,128,258,1024,Ye),new Vt(32,258,258,4096,Ye)],ho=n=>{n.window_size=2*n.w_size,he(n.head),n.max_lazy_match=wn[n.level].max_lazy,n.good_match=wn[n.level].good_length,n.nice_match=wn[n.level].nice_length,n.max_chain_length=wn[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=K-1,n.match_available=0,n.ins_h=0};function fo(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Un,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(ro*2),this.dyn_dtree=new Uint16Array((2*eo+1)*2),this.bl_tree=new Uint16Array((2*no+1)*2),he(this.dyn_ltree),he(this.dyn_dtree),he(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(io+1),this.heap=new Uint16Array(2*Nr+1),he(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Nr+1),he(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Di=n=>{if(!n||!n.state)return ue(n,Bt);n.total_in=n.total_out=0,n.data_type=Xa;const t=n.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?Zn:xe,n.adler=t.wrap===2?0:1,t.last_flush=Me,za(t),Gt},Fi=n=>{const t=Di(n);return t===Gt&&ho(n.state),t},mo=(n,t)=>!n||!n.state||n.state.wrap!==2?Bt:(n.state.gzhead=t,Gt),Hi=(n,t,e,r,i,s)=>{if(!n)return Bt;let a=1;if(t===Va&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),i<1||i>ja||e!==Un||r<8||r>15||t<0||t>9||s<0||s>qa)return ue(n,Bt);r===8&&(r=9);const o=new fo;return n.state=o,o.strm=n,o.wrap=a,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+K-1)/K),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=(1+2)*o.lit_bufsize,o.level=t,o.strategy=s,o.method=e,Fi(n)},go=(n,t)=>Hi(n,t,Un,Ka,Qa,Wa),po=(n,t)=>{let e,r;if(!n||!n.state||t>Pi||t<0)return n?ue(n,Bt):Bt;const i=n.state;if(!n.output||!n.input&&n.avail_in!==0||i.status===mn&&t!==ce)return ue(n,n.avail_out===0?Cr:Bt);i.strm=n;const s=i.last_flush;if(i.last_flush=t,i.status===Zn)if(i.wrap===2)n.adler=0,tt(i,31),tt(i,139),tt(i,8),i.gzhead?(tt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),tt(i,i.gzhead.time&255),tt(i,i.gzhead.time>>8&255),tt(i,i.gzhead.time>>16&255),tt(i,i.gzhead.time>>24&255),tt(i,i.level===9?2:i.strategy>=Hn||i.level<2?4:0),tt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(tt(i,i.gzhead.extra.length&255),tt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(n.adler=dt(n.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=Br):(tt(i,0),tt(i,0),tt(i,0),tt(i,0),tt(i,0),tt(i,i.level===9?2:i.strategy>=Hn||i.level<2?4:0),tt(i,ao),i.status=xe);else{let a=Un+(i.w_bits-8<<4)<<8,o=-1;i.strategy>=Hn||i.level<2?o=0:i.level<6?o=1:i.level===6?o=2:o=3,a|=o<<6,i.strstart!==0&&(a|=so),a+=31-a%31,i.status=xe,pn(i,a),i.strstart!==0&&(pn(i,n.adler>>>16),pn(i,n.adler&65535)),n.adler=1}if(i.status===Br)if(i.gzhead.extra){for(e=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>e&&(n.adler=dt(n.adler,i.pending_buf,i.pending-e,e)),de(n),e=i.pending,i.pending===i.pending_buf_size));)tt(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>e&&(n.adler=dt(n.adler,i.pending_buf,i.pending-e,e)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=Gn)}else i.status=Gn;if(i.status===Gn)if(i.gzhead.name){e=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>e&&(n.adler=dt(n.adler,i.pending_buf,i.pending-e,e)),de(n),e=i.pending,i.pending===i.pending_buf_size)){r=1;break}i.gzindex<i.gzhead.name.length?r=i.gzhead.name.charCodeAt(i.gzindex++)&255:r=0,tt(i,r)}while(r!==0);i.gzhead.hcrc&&i.pending>e&&(n.adler=dt(n.adler,i.pending_buf,i.pending-e,e)),r===0&&(i.gzindex=0,i.status=Vn)}else i.status=Vn;if(i.status===Vn)if(i.gzhead.comment){e=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>e&&(n.adler=dt(n.adler,i.pending_buf,i.pending-e,e)),de(n),e=i.pending,i.pending===i.pending_buf_size)){r=1;break}i.gzindex<i.gzhead.comment.length?r=i.gzhead.comment.charCodeAt(i.gzindex++)&255:r=0,tt(i,r)}while(r!==0);i.gzhead.hcrc&&i.pending>e&&(n.adler=dt(n.adler,i.pending_buf,i.pending-e,e)),r===0&&(i.status=$n)}else i.status=$n;if(i.status===$n&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&de(n),i.pending+2<=i.pending_buf_size&&(tt(i,n.adler&255),tt(i,n.adler>>8&255),n.adler=0,i.status=xe)):i.status=xe),i.pending!==0){if(de(n),n.avail_out===0)return i.last_flush=-1,Gt}else if(n.avail_in===0&&Ji(t)<=Ji(s)&&t!==ce)return ue(n,Cr);if(i.status===mn&&n.avail_in!==0)return ue(n,Cr);if(n.avail_in!==0||i.lookahead!==0||t!==Me&&i.status!==mn){let a=i.strategy===Hn?uo(i,t):i.strategy===Ya?lo(i,t):wn[i.level].func(i,t);if((a===Re||a===$e)&&(i.status=mn),a===ht||a===Re)return n.avail_out===0&&(i.last_flush=-1),Gt;if(a===gn&&(t===Ua?Ha(i):t!==Pi&&(Da(i,0,0,!1),t===Za&&(he(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),de(n),n.avail_out===0))return i.last_flush=-1,Gt}return t!==ce?Gt:i.wrap<=0?Oi:(i.wrap===2?(tt(i,n.adler&255),tt(i,n.adler>>8&255),tt(i,n.adler>>16&255),tt(i,n.adler>>24&255),tt(i,n.total_in&255),tt(i,n.total_in>>8&255),tt(i,n.total_in>>16&255),tt(i,n.total_in>>24&255)):(pn(i,n.adler>>>16),pn(i,n.adler&65535)),de(n),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Gt:Oi)},wo=n=>{if(!n||!n.state)return Bt;const t=n.state.status;return t!==Zn&&t!==Br&&t!==Gn&&t!==Vn&&t!==$n&&t!==xe&&t!==mn?ue(n,Bt):(n.state=null,t===xe?ue(n,Ga):Gt)},vo=(n,t)=>{let e=t.length;if(!n||!n.state)return Bt;const r=n.state,i=r.wrap;if(i===2||i===1&&r.status!==Zn||r.lookahead)return Bt;if(i===1&&(n.adler=dn(n.adler,t,e,0)),r.wrap=0,e>=r.w_size){i===0&&(he(r.head),r.strstart=0,r.block_start=0,r.insert=0);let m=new Uint8Array(r.w_size);m.set(t.subarray(e-r.w_size,e),0),t=m,e=r.w_size}const s=n.avail_in,a=n.next_in,o=n.input;for(n.avail_in=e,n.next_in=0,n.input=t,Ce(r);r.lookahead>=K;){let m=r.strstart,c=r.lookahead-(K-1);do r.ins_h=fe(r,r.ins_h,r.window[m+K-1]),r.prev[m&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=m,m++;while(--c);r.strstart=m,r.lookahead=K-1,Ce(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=K-1,r.match_available=0,n.next_in=a,n.input=o,n.avail_in=s,r.wrap=i,Gt};var _o=go,bo=Hi,yo=Fi,So=Di,Eo=mo,Io=po,ko=wo,Ao=vo,Mo="pako deflate (from Nodeca project)",vn={deflateInit:_o,deflateInit2:bo,deflateReset:yo,deflateResetKeep:So,deflateSetHeader:Eo,deflate:Io,deflateEnd:ko,deflateSetDictionary:Ao,deflateInfo:Mo};const xo=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var Ro=function(n){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(!!e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const r in e)xo(e,r)&&(n[r]=e[r])}}return n},Co=n=>{let t=0;for(let r=0,i=n.length;r<i;r++)t+=n[r].length;const e=new Uint8Array(t);for(let r=0,i=0,s=n.length;r<s;r++){let a=n[r];e.set(a,i),i+=a.length}return e},Yn={assign:Ro,flattenChunks:Co};let Ui=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Ui=!1}const _n=new Uint8Array(256);for(let n=0;n<256;n++)_n[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;_n[254]=_n[254]=1;var No=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let t,e,r,i,s,a=n.length,o=0;for(i=0;i<a;i++)e=n.charCodeAt(i),(e&64512)===55296&&i+1<a&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(e=65536+(e-55296<<10)+(r-56320),i++)),o+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(o),s=0,i=0;s<o;i++)e=n.charCodeAt(i),(e&64512)===55296&&i+1<a&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(e=65536+(e-55296<<10)+(r-56320),i++)),e<128?t[s++]=e:e<2048?(t[s++]=192|e>>>6,t[s++]=128|e&63):e<65536?(t[s++]=224|e>>>12,t[s++]=128|e>>>6&63,t[s++]=128|e&63):(t[s++]=240|e>>>18,t[s++]=128|e>>>12&63,t[s++]=128|e>>>6&63,t[s++]=128|e&63);return t};const Bo=(n,t)=>{if(t<65534&&n.subarray&&Ui)return String.fromCharCode.apply(null,n.length===t?n:n.subarray(0,t));let e="";for(let r=0;r<t;r++)e+=String.fromCharCode(n[r]);return e};var To=(n,t)=>{const e=t||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,t));let r,i;const s=new Array(e*2);for(i=0,r=0;r<e;){let a=n[r++];if(a<128){s[i++]=a;continue}let o=_n[a];if(o>4){s[i++]=65533,r+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&r<e;)a=a<<6|n[r++]&63,o--;if(o>1){s[i++]=65533;continue}a<65536?s[i++]=a:(a-=65536,s[i++]=55296|a>>10&1023,s[i++]=56320|a&1023)}return Bo(s,i)},Lo=(n,t)=>{t=t||n.length,t>n.length&&(t=n.length);let e=t-1;for(;e>=0&&(n[e]&192)===128;)e--;return e<0||e===0?t:e+_n[n[e]]>t?e:t},bn={string2buf:No,buf2string:To,utf8border:Lo};function Po(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Zi=Po;const Gi=Object.prototype.toString,{Z_NO_FLUSH:Oo,Z_SYNC_FLUSH:Jo,Z_FULL_FLUSH:zo,Z_FINISH:Do,Z_OK:qn,Z_STREAM_END:Fo,Z_DEFAULT_COMPRESSION:Ho,Z_DEFAULT_STRATEGY:Uo,Z_DEFLATED:Zo}=Ae;function yn(n){this.options=Yn.assign({level:Ho,method:Zo,chunkSize:16384,windowBits:15,memLevel:8,strategy:Uo},n||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Zi,this.strm.avail_out=0;let e=vn.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==qn)throw new Error(ke[e]);if(t.header&&vn.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=bn.string2buf(t.dictionary):Gi.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,e=vn.deflateSetDictionary(this.strm,r),e!==qn)throw new Error(ke[e]);this._dict_set=!0}}yn.prototype.push=function(n,t){const e=this.strm,r=this.options.chunkSize;let i,s;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?Do:Oo,typeof n=="string"?e.input=bn.string2buf(n):Gi.call(n)==="[object ArrayBuffer]"?e.input=new Uint8Array(n):e.input=n,e.next_in=0,e.avail_in=e.input.length;;){if(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),(s===Jo||s===zo)&&e.avail_out<=6){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(i=vn.deflate(e,s),i===Fo)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),i=vn.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===qn;if(e.avail_out===0){this.onData(e.output);continue}if(s>0&&e.next_out>0){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(e.avail_in===0)break}return!0},yn.prototype.onData=function(n){this.chunks.push(n)},yn.prototype.onEnd=function(n){n===qn&&(this.result=Yn.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function Lr(n,t){const e=new yn(t);if(e.push(n,!0),e.err)throw e.msg||ke[e.err];return e.result}function Go(n,t){return t=t||{},t.raw=!0,Lr(n,t)}function Vo(n,t){return t=t||{},t.gzip=!0,Lr(n,t)}var $o=yn,Yo=Lr,qo=Go,Wo=Vo,Xo=Ae,jo={Deflate:$o,deflate:Yo,deflateRaw:qo,gzip:Wo,constants:Xo};const Wn=30,Ko=12;var Qo=function(t,e){let r,i,s,a,o,m,c,l,h,d,f,p,v,g,w,S,E,y,R,A,I,x,C,M;const N=t.state;r=t.next_in,C=t.input,i=r+(t.avail_in-5),s=t.next_out,M=t.output,a=s-(e-t.avail_out),o=s+(t.avail_out-257),m=N.dmax,c=N.wsize,l=N.whave,h=N.wnext,d=N.window,f=N.hold,p=N.bits,v=N.lencode,g=N.distcode,w=(1<<N.lenbits)-1,S=(1<<N.distbits)-1;t:do{p<15&&(f+=C[r++]<<p,p+=8,f+=C[r++]<<p,p+=8),E=v[f&w];e:for(;;){if(y=E>>>24,f>>>=y,p-=y,y=E>>>16&255,y===0)M[s++]=E&65535;else if(y&16){R=E&65535,y&=15,y&&(p<y&&(f+=C[r++]<<p,p+=8),R+=f&(1<<y)-1,f>>>=y,p-=y),p<15&&(f+=C[r++]<<p,p+=8,f+=C[r++]<<p,p+=8),E=g[f&S];n:for(;;){if(y=E>>>24,f>>>=y,p-=y,y=E>>>16&255,y&16){if(A=E&65535,y&=15,p<y&&(f+=C[r++]<<p,p+=8,p<y&&(f+=C[r++]<<p,p+=8)),A+=f&(1<<y)-1,A>m){t.msg="invalid distance too far back",N.mode=Wn;break t}if(f>>>=y,p-=y,y=s-a,A>y){if(y=A-y,y>l&&N.sane){t.msg="invalid distance too far back",N.mode=Wn;break t}if(I=0,x=d,h===0){if(I+=c-y,y<R){R-=y;do M[s++]=d[I++];while(--y);I=s-A,x=M}}else if(h<y){if(I+=c+h-y,y-=h,y<R){R-=y;do M[s++]=d[I++];while(--y);if(I=0,h<R){y=h,R-=y;do M[s++]=d[I++];while(--y);I=s-A,x=M}}}else if(I+=h-y,y<R){R-=y;do M[s++]=d[I++];while(--y);I=s-A,x=M}for(;R>2;)M[s++]=x[I++],M[s++]=x[I++],M[s++]=x[I++],R-=3;R&&(M[s++]=x[I++],R>1&&(M[s++]=x[I++]))}else{I=s-A;do M[s++]=M[I++],M[s++]=M[I++],M[s++]=M[I++],R-=3;while(R>2);R&&(M[s++]=M[I++],R>1&&(M[s++]=M[I++]))}}else if((y&64)===0){E=g[(E&65535)+(f&(1<<y)-1)];continue n}else{t.msg="invalid distance code",N.mode=Wn;break t}break}}else if((y&64)===0){E=v[(E&65535)+(f&(1<<y)-1)];continue e}else if(y&32){N.mode=Ko;break t}else{t.msg="invalid literal/length code",N.mode=Wn;break t}break}}while(r<i&&s<o);R=p>>3,r-=R,p-=R<<3,f&=(1<<p)-1,t.next_in=r,t.next_out=s,t.avail_in=r<i?5+(i-r):5-(r-i),t.avail_out=s<o?257+(o-s):257-(s-o),N.hold=f,N.bits=p};const qe=15,Vi=852,$i=592,Yi=0,Pr=1,qi=2,tc=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ec=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),nc=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),rc=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Sn=(n,t,e,r,i,s,a,o)=>{const m=o.bits;let c=0,l=0,h=0,d=0,f=0,p=0,v=0,g=0,w=0,S=0,E,y,R,A,I,x=null,C=0,M;const N=new Uint16Array(qe+1),P=new Uint16Array(qe+1);let H=null,F=0,T,J,U;for(c=0;c<=qe;c++)N[c]=0;for(l=0;l<r;l++)N[t[e+l]]++;for(f=m,d=qe;d>=1&&N[d]===0;d--);if(f>d&&(f=d),d===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<d&&N[h]===0;h++);for(f<h&&(f=h),g=1,c=1;c<=qe;c++)if(g<<=1,g-=N[c],g<0)return-1;if(g>0&&(n===Yi||d!==1))return-1;for(P[1]=0,c=1;c<qe;c++)P[c+1]=P[c]+N[c];for(l=0;l<r;l++)t[e+l]!==0&&(a[P[t[e+l]]++]=l);if(n===Yi?(x=H=a,M=19):n===Pr?(x=tc,C-=257,H=ec,F-=257,M=256):(x=nc,H=rc,M=-1),S=0,l=0,c=h,I=s,p=f,v=0,R=-1,w=1<<f,A=w-1,n===Pr&&w>Vi||n===qi&&w>$i)return 1;for(;;){T=c-v,a[l]<M?(J=0,U=a[l]):a[l]>M?(J=H[F+a[l]],U=x[C+a[l]]):(J=32+64,U=0),E=1<<c-v,y=1<<p,h=y;do y-=E,i[I+(S>>v)+y]=T<<24|J<<16|U|0;while(y!==0);for(E=1<<c-1;S&E;)E>>=1;if(E!==0?(S&=E-1,S+=E):S=0,l++,--N[c]===0){if(c===d)break;c=t[e+a[l]]}if(c>f&&(S&A)!==R){for(v===0&&(v=f),I+=h,p=c-v,g=1<<p;p+v<d&&(g-=N[p+v],!(g<=0));)p++,g<<=1;if(w+=1<<p,n===Pr&&w>Vi||n===qi&&w>$i)return 1;R=S&A,i[R]=f<<24|p<<16|I-s|0}}return S!==0&&(i[I+S]=c-v<<24|64<<16|0),o.bits=f,0};const ic=0,Wi=1,Xi=2,{Z_FINISH:ji,Z_BLOCK:sc,Z_TREES:Xn,Z_OK:Ne,Z_STREAM_END:ac,Z_NEED_DICT:oc,Z_STREAM_ERROR:Tt,Z_DATA_ERROR:Ki,Z_MEM_ERROR:Qi,Z_BUF_ERROR:cc,Z_DEFLATED:ts}=Ae,es=1,ns=2,rs=3,is=4,ss=5,as=6,os=7,cs=8,ls=9,us=10,jn=11,Kt=12,Or=13,hs=14,Jr=15,fs=16,ds=17,ms=18,gs=19,Kn=20,Qn=21,ps=22,ws=23,vs=24,_s=25,bs=26,zr=27,ys=28,Ss=29,at=30,Es=31,lc=32,uc=852,hc=592,fc=15,Is=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function dc(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ks=n=>{if(!n||!n.state)return Tt;const t=n.state;return n.total_in=n.total_out=t.total=0,n.msg="",t.wrap&&(n.adler=t.wrap&1),t.mode=es,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(uc),t.distcode=t.distdyn=new Int32Array(hc),t.sane=1,t.back=-1,Ne},As=n=>{if(!n||!n.state)return Tt;const t=n.state;return t.wsize=0,t.whave=0,t.wnext=0,ks(n)},Ms=(n,t)=>{let e;if(!n||!n.state)return Tt;const r=n.state;return t<0?(e=0,t=-t):(e=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?Tt:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=e,r.wbits=t,As(n))},xs=(n,t)=>{if(!n)return Tt;const e=new dc;n.state=e,e.window=null;const r=Ms(n,t);return r!==Ne&&(n.state=null),r},mc=n=>xs(n,fc);let Rs=!0,Dr,Fr;const gc=n=>{if(Rs){Dr=new Int32Array(512),Fr=new Int32Array(32);let t=0;for(;t<144;)n.lens[t++]=8;for(;t<256;)n.lens[t++]=9;for(;t<280;)n.lens[t++]=7;for(;t<288;)n.lens[t++]=8;for(Sn(Wi,n.lens,0,288,Dr,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;Sn(Xi,n.lens,0,32,Fr,0,n.work,{bits:5}),Rs=!1}n.lencode=Dr,n.lenbits=9,n.distcode=Fr,n.distbits=5},Cs=(n,t,e,r)=>{let i;const s=n.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(t.subarray(e-s.wsize,e),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(t.subarray(e-r,e-r+i),s.wnext),r-=i,r?(s.window.set(t.subarray(e-r,e),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},pc=(n,t)=>{let e,r,i,s,a,o,m,c,l,h,d,f,p,v,g=0,w,S,E,y,R,A,I,x;const C=new Uint8Array(4);let M,N;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!n||!n.state||!n.output||!n.input&&n.avail_in!==0)return Tt;e=n.state,e.mode===Kt&&(e.mode=Or),a=n.next_out,i=n.output,m=n.avail_out,s=n.next_in,r=n.input,o=n.avail_in,c=e.hold,l=e.bits,h=o,d=m,x=Ne;t:for(;;)switch(e.mode){case es:if(e.wrap===0){e.mode=Or;break}for(;l<16;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(e.wrap&2&&c===35615){e.check=0,C[0]=c&255,C[1]=c>>>8&255,e.check=dt(e.check,C,2,0),c=0,l=0,e.mode=ns;break}if(e.flags=0,e.head&&(e.head.done=!1),!(e.wrap&1)||(((c&255)<<8)+(c>>8))%31){n.msg="incorrect header check",e.mode=at;break}if((c&15)!==ts){n.msg="unknown compression method",e.mode=at;break}if(c>>>=4,l-=4,I=(c&15)+8,e.wbits===0)e.wbits=I;else if(I>e.wbits){n.msg="invalid window size",e.mode=at;break}e.dmax=1<<e.wbits,n.adler=e.check=1,e.mode=c&512?us:Kt,c=0,l=0;break;case ns:for(;l<16;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(e.flags=c,(e.flags&255)!==ts){n.msg="unknown compression method",e.mode=at;break}if(e.flags&57344){n.msg="unknown header flags set",e.mode=at;break}e.head&&(e.head.text=c>>8&1),e.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,e.check=dt(e.check,C,2,0)),c=0,l=0,e.mode=rs;case rs:for(;l<32;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.head&&(e.head.time=c),e.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,e.check=dt(e.check,C,4,0)),c=0,l=0,e.mode=is;case is:for(;l<16;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.head&&(e.head.xflags=c&255,e.head.os=c>>8),e.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,e.check=dt(e.check,C,2,0)),c=0,l=0,e.mode=ss;case ss:if(e.flags&1024){for(;l<16;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.length=c,e.head&&(e.head.extra_len=c),e.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,e.check=dt(e.check,C,2,0)),c=0,l=0}else e.head&&(e.head.extra=null);e.mode=as;case as:if(e.flags&1024&&(f=e.length,f>o&&(f=o),f&&(e.head&&(I=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(r.subarray(s,s+f),I)),e.flags&512&&(e.check=dt(e.check,r,f,s)),o-=f,s+=f,e.length-=f),e.length))break t;e.length=0,e.mode=os;case os:if(e.flags&2048){if(o===0)break t;f=0;do I=r[s+f++],e.head&&I&&e.length<65536&&(e.head.name+=String.fromCharCode(I));while(I&&f<o);if(e.flags&512&&(e.check=dt(e.check,r,f,s)),o-=f,s+=f,I)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=cs;case cs:if(e.flags&4096){if(o===0)break t;f=0;do I=r[s+f++],e.head&&I&&e.length<65536&&(e.head.comment+=String.fromCharCode(I));while(I&&f<o);if(e.flags&512&&(e.check=dt(e.check,r,f,s)),o-=f,s+=f,I)break t}else e.head&&(e.head.comment=null);e.mode=ls;case ls:if(e.flags&512){for(;l<16;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(c!==(e.check&65535)){n.msg="header crc mismatch",e.mode=at;break}c=0,l=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),n.adler=e.check=0,e.mode=Kt;break;case us:for(;l<32;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}n.adler=e.check=Is(c),c=0,l=0,e.mode=jn;case jn:if(e.havedict===0)return n.next_out=a,n.avail_out=m,n.next_in=s,n.avail_in=o,e.hold=c,e.bits=l,oc;n.adler=e.check=1,e.mode=Kt;case Kt:if(t===sc||t===Xn)break t;case Or:if(e.last){c>>>=l&7,l-=l&7,e.mode=zr;break}for(;l<3;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}switch(e.last=c&1,c>>>=1,l-=1,c&3){case 0:e.mode=hs;break;case 1:if(gc(e),e.mode=Kn,t===Xn){c>>>=2,l-=2;break t}break;case 2:e.mode=ds;break;case 3:n.msg="invalid block type",e.mode=at}c>>>=2,l-=2;break;case hs:for(c>>>=l&7,l-=l&7;l<32;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if((c&65535)!==(c>>>16^65535)){n.msg="invalid stored block lengths",e.mode=at;break}if(e.length=c&65535,c=0,l=0,e.mode=Jr,t===Xn)break t;case Jr:e.mode=fs;case fs:if(f=e.length,f){if(f>o&&(f=o),f>m&&(f=m),f===0)break t;i.set(r.subarray(s,s+f),a),o-=f,s+=f,m-=f,a+=f,e.length-=f;break}e.mode=Kt;break;case ds:for(;l<14;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(e.nlen=(c&31)+257,c>>>=5,l-=5,e.ndist=(c&31)+1,c>>>=5,l-=5,e.ncode=(c&15)+4,c>>>=4,l-=4,e.nlen>286||e.ndist>30){n.msg="too many length or distance symbols",e.mode=at;break}e.have=0,e.mode=ms;case ms:for(;e.have<e.ncode;){for(;l<3;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.lens[P[e.have++]]=c&7,c>>>=3,l-=3}for(;e.have<19;)e.lens[P[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,M={bits:e.lenbits},x=Sn(ic,e.lens,0,19,e.lencode,0,e.work,M),e.lenbits=M.bits,x){n.msg="invalid code lengths set",e.mode=at;break}e.have=0,e.mode=gs;case gs:for(;e.have<e.nlen+e.ndist;){for(;g=e.lencode[c&(1<<e.lenbits)-1],w=g>>>24,S=g>>>16&255,E=g&65535,!(w<=l);){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(E<16)c>>>=w,l-=w,e.lens[e.have++]=E;else{if(E===16){for(N=w+2;l<N;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(c>>>=w,l-=w,e.have===0){n.msg="invalid bit length repeat",e.mode=at;break}I=e.lens[e.have-1],f=3+(c&3),c>>>=2,l-=2}else if(E===17){for(N=w+3;l<N;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}c>>>=w,l-=w,I=0,f=3+(c&7),c>>>=3,l-=3}else{for(N=w+7;l<N;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}c>>>=w,l-=w,I=0,f=11+(c&127),c>>>=7,l-=7}if(e.have+f>e.nlen+e.ndist){n.msg="invalid bit length repeat",e.mode=at;break}for(;f--;)e.lens[e.have++]=I}}if(e.mode===at)break;if(e.lens[256]===0){n.msg="invalid code -- missing end-of-block",e.mode=at;break}if(e.lenbits=9,M={bits:e.lenbits},x=Sn(Wi,e.lens,0,e.nlen,e.lencode,0,e.work,M),e.lenbits=M.bits,x){n.msg="invalid literal/lengths set",e.mode=at;break}if(e.distbits=6,e.distcode=e.distdyn,M={bits:e.distbits},x=Sn(Xi,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,M),e.distbits=M.bits,x){n.msg="invalid distances set",e.mode=at;break}if(e.mode=Kn,t===Xn)break t;case Kn:e.mode=Qn;case Qn:if(o>=6&&m>=258){n.next_out=a,n.avail_out=m,n.next_in=s,n.avail_in=o,e.hold=c,e.bits=l,Qo(n,d),a=n.next_out,i=n.output,m=n.avail_out,s=n.next_in,r=n.input,o=n.avail_in,c=e.hold,l=e.bits,e.mode===Kt&&(e.back=-1);break}for(e.back=0;g=e.lencode[c&(1<<e.lenbits)-1],w=g>>>24,S=g>>>16&255,E=g&65535,!(w<=l);){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(S&&(S&240)===0){for(y=w,R=S,A=E;g=e.lencode[A+((c&(1<<y+R)-1)>>y)],w=g>>>24,S=g>>>16&255,E=g&65535,!(y+w<=l);){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}c>>>=y,l-=y,e.back+=y}if(c>>>=w,l-=w,e.back+=w,e.length=E,S===0){e.mode=bs;break}if(S&32){e.back=-1,e.mode=Kt;break}if(S&64){n.msg="invalid literal/length code",e.mode=at;break}e.extra=S&15,e.mode=ps;case ps:if(e.extra){for(N=e.extra;l<N;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.length+=c&(1<<e.extra)-1,c>>>=e.extra,l-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=ws;case ws:for(;g=e.distcode[c&(1<<e.distbits)-1],w=g>>>24,S=g>>>16&255,E=g&65535,!(w<=l);){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if((S&240)===0){for(y=w,R=S,A=E;g=e.distcode[A+((c&(1<<y+R)-1)>>y)],w=g>>>24,S=g>>>16&255,E=g&65535,!(y+w<=l);){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}c>>>=y,l-=y,e.back+=y}if(c>>>=w,l-=w,e.back+=w,S&64){n.msg="invalid distance code",e.mode=at;break}e.offset=E,e.extra=S&15,e.mode=vs;case vs:if(e.extra){for(N=e.extra;l<N;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}e.offset+=c&(1<<e.extra)-1,c>>>=e.extra,l-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){n.msg="invalid distance too far back",e.mode=at;break}e.mode=_s;case _s:if(m===0)break t;if(f=d-m,e.offset>f){if(f=e.offset-f,f>e.whave&&e.sane){n.msg="invalid distance too far back",e.mode=at;break}f>e.wnext?(f-=e.wnext,p=e.wsize-f):p=e.wnext-f,f>e.length&&(f=e.length),v=e.window}else v=i,p=a-e.offset,f=e.length;f>m&&(f=m),m-=f,e.length-=f;do i[a++]=v[p++];while(--f);e.length===0&&(e.mode=Qn);break;case bs:if(m===0)break t;i[a++]=e.length,m--,e.mode=Qn;break;case zr:if(e.wrap){for(;l<32;){if(o===0)break t;o--,c|=r[s++]<<l,l+=8}if(d-=m,n.total_out+=d,e.total+=d,d&&(n.adler=e.check=e.flags?dt(e.check,i,d,a-d):dn(e.check,i,d,a-d)),d=m,(e.flags?c:Is(c))!==e.check){n.msg="incorrect data check",e.mode=at;break}c=0,l=0}e.mode=ys;case ys:if(e.wrap&&e.flags){for(;l<32;){if(o===0)break t;o--,c+=r[s++]<<l,l+=8}if(c!==(e.total&4294967295)){n.msg="incorrect length check",e.mode=at;break}c=0,l=0}e.mode=Ss;case Ss:x=ac;break t;case at:x=Ki;break t;case Es:return Qi;case lc:default:return Tt}return n.next_out=a,n.avail_out=m,n.next_in=s,n.avail_in=o,e.hold=c,e.bits=l,(e.wsize||d!==n.avail_out&&e.mode<at&&(e.mode<zr||t!==ji))&&Cs(n,n.output,n.next_out,d-n.avail_out),h-=n.avail_in,d-=n.avail_out,n.total_in+=h,n.total_out+=d,e.total+=d,e.wrap&&d&&(n.adler=e.check=e.flags?dt(e.check,i,d,n.next_out-d):dn(e.check,i,d,n.next_out-d)),n.data_type=e.bits+(e.last?64:0)+(e.mode===Kt?128:0)+(e.mode===Kn||e.mode===Jr?256:0),(h===0&&d===0||t===ji)&&x===Ne&&(x=cc),x},wc=n=>{if(!n||!n.state)return Tt;let t=n.state;return t.window&&(t.window=null),n.state=null,Ne},vc=(n,t)=>{if(!n||!n.state)return Tt;const e=n.state;return(e.wrap&2)===0?Tt:(e.head=t,t.done=!1,Ne)},_c=(n,t)=>{const e=t.length;let r,i,s;return!n||!n.state||(r=n.state,r.wrap!==0&&r.mode!==jn)?Tt:r.mode===jn&&(i=1,i=dn(i,t,e,0),i!==r.check)?Ki:(s=Cs(n,t,e,e),s?(r.mode=Es,Qi):(r.havedict=1,Ne))};var bc=As,yc=Ms,Sc=ks,Ec=mc,Ic=xs,kc=pc,Ac=wc,Mc=vc,xc=_c,Rc="pako inflate (from Nodeca project)",Qt={inflateReset:bc,inflateReset2:yc,inflateResetKeep:Sc,inflateInit:Ec,inflateInit2:Ic,inflate:kc,inflateEnd:Ac,inflateGetHeader:Mc,inflateSetDictionary:xc,inflateInfo:Rc};function Cc(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Nc=Cc;const Ns=Object.prototype.toString,{Z_NO_FLUSH:Bc,Z_FINISH:Tc,Z_OK:En,Z_STREAM_END:Hr,Z_NEED_DICT:Ur,Z_STREAM_ERROR:Lc,Z_DATA_ERROR:Bs,Z_MEM_ERROR:Pc}=Ae;function In(n){this.options=Yn.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(n&&n.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Zi,this.strm.avail_out=0;let e=Qt.inflateInit2(this.strm,t.windowBits);if(e!==En)throw new Error(ke[e]);if(this.header=new Nc,Qt.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=bn.string2buf(t.dictionary):Ns.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=Qt.inflateSetDictionary(this.strm,t.dictionary),e!==En)))throw new Error(ke[e])}In.prototype.push=function(n,t){const e=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?Tc:Bc,Ns.call(n)==="[object ArrayBuffer]"?e.input=new Uint8Array(n):e.input=n,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),s=Qt.inflate(e,a),s===Ur&&i&&(s=Qt.inflateSetDictionary(e,i),s===En?s=Qt.inflate(e,a):s===Bs&&(s=Ur));e.avail_in>0&&s===Hr&&e.state.wrap>0&&n[e.next_in]!==0;)Qt.inflateReset(e),s=Qt.inflate(e,a);switch(s){case Lc:case Bs:case Ur:case Pc:return this.onEnd(s),this.ended=!0,!1}if(o=e.avail_out,e.next_out&&(e.avail_out===0||s===Hr))if(this.options.to==="string"){let m=bn.utf8border(e.output,e.next_out),c=e.next_out-m,l=bn.buf2string(e.output,m);e.next_out=c,e.avail_out=r-c,c&&e.output.set(e.output.subarray(m,m+c),0),this.onData(l)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(s===En&&o===0)){if(s===Hr)return s=Qt.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(e.avail_in===0)break}}return!0},In.prototype.onData=function(n){this.chunks.push(n)},In.prototype.onEnd=function(n){n===En&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Yn.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function Zr(n,t){const e=new In(t);if(e.push(n),e.err)throw e.msg||ke[e.err];return e.result}function Oc(n,t){return t=t||{},t.raw=!0,Zr(n,t)}var Jc=In,zc=Zr,Dc=Oc,Fc=Zr,Hc=Ae,Uc={Inflate:Jc,inflate:zc,inflateRaw:Dc,ungzip:Fc,constants:Hc};const{Deflate:Zc,deflate:Gc,deflateRaw:Vc,gzip:$c}=jo,{Inflate:Yc,inflate:qc,inflateRaw:Wc,ungzip:Xc}=Uc;var jc=Zc,Kc=Gc,Qc=Vc,tl=$c,el=Yc,nl=qc,rl=Wc,il=Xc,sl=Ae,Gr={Deflate:jc,deflate:Kc,deflateRaw:Qc,gzip:tl,Inflate:el,inflate:nl,inflateRaw:rl,ungzip:il,constants:sl},z=(n=>(n[n.End=0]="End",n[n.Byte=1]="Byte",n[n.Short=2]="Short",n[n.Int=3]="Int",n[n.Long=4]="Long",n[n.Float=5]="Float",n[n.Double=6]="Double",n[n.ByteArray=7]="ByteArray",n[n.String=8]="String",n[n.List=9]="List",n[n.Compound=10]="Compound",n[n.IntArray=11]="IntArray",n[n.LongArray=12]="LongArray",n))(z||{});const wr=class{static register(t,e){const r=e.create().getId();if(r!==t)throw new Error(`Registered factory ${z[r]} does not match type ${z[t]}`);wr.FACTORIES.set(t,e)}isEnd(){return this.getId()===z.End}isByte(){return this.getId()===z.Byte}isShort(){return this.getId()===z.Short}isInt(){return this.getId()===z.Int}isLong(){return this.getId()===z.Long}isFloat(){return this.getId()===z.Float}isDouble(){return this.getId()===z.Double}isByteArray(){return this.getId()===z.ByteArray}isString(){return this.getId()===z.String}isList(){return this.getId()===z.List}isCompound(){return this.getId()===z.Compound}isIntArray(){return this.getId()===z.IntArray}isLongArray(){return this.getId()===z.LongArray}isNumber(){return this.isByte()||this.isShort()||this.isInt()||this.isLong()||this.isFloat()||this.isDouble()}isArray(){return this.isByteArray()||this.isIntArray()||this.isLongArray()}isListOrArray(){return this.isList()||this.isArray()}getAsNumber(){return 0}getAsString(){return""}toJsonWithId(){return{type:this.getId(),value:this.toJson()}}static getFactory(t){const e=this.FACTORIES.get(t);if(!e)throw new Error(`Invalid tag id ${t}`);return e}static create(t){return this.getFactory(t).create()}static fromString(t){const e=typeof t=="string"?new Et(t):t;return this.getFactory(z.Compound).fromString(e)}static fromJson(t,e=z.Compound){return this.getFactory(e).fromJson(t)}static fromJsonWithId(t){var i,s,a;const e=(i=u.Json.readObject(t))!=null?i:{},r=(s=u.Json.readInt(e.type))!=null?s:0;return wr.fromJson((a=e.value)!=null?a:{},r)}static fromBytes(t,e=z.Compound){return this.getFactory(e).fromBytes(t)}};let nt=wr;_(nt,"FACTORIES",new Map);const He=class extends nt{constructor(e){super();_(this,"value");this.value=typeof e=="number"?e:e?1:0}getId(){return z.Byte}equals(e){return e.isByte()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toFixed()+"b"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeByte(this.value)}static create(){return He.ZERO}static fromJson(e){var r;return new He((r=u.Json.readInt(e))!=null?r:0)}static fromBytes(e){const r=e.readByte();return new He(r)}};let Lt=He;_(Lt,"ZERO",new He(0)),_(Lt,"ONE",new He(1)),nt.register(z.Byte,Lt);class kn extends nt{constructor(e){super();_(this,"items");this.items=e}getItems(){return this.items.slice(0)}getAsTuple(e,r){return[...Array(e)].map((i,s)=>r(this.items[s]))}get(e){if(e=Math.floor(e),!(e<0||e>=this.items.length))return this.items[e]}get length(){return this.items.length}map(e){return this.items.map(e)}filter(e){return this.items.filter(e)}forEach(e){this.items.forEach(e)}set(e,r){this.items[e]=r}add(e){this.items.push(e)}insert(e,r){this.items.splice(e,0,r)}delete(e){this.items.splice(e,1)}clear(){this.items=[]}}class me extends kn{constructor(t){super(Array.from(t!=null?t:[],e=>typeof e=="number"?new Lt(e):e))}getId(){return z.ByteArray}equals(t){return t.isByteArray()&&this.length===t.length&&this.items.every((e,r)=>e.equals(t.items[r]))}getType(){return z.Byte}toString(){return"[B;"+this.items.map(e=>e.getAsNumber().toFixed()+"B").join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsNumber())}toJson(){return this.items.map(t=>t.getAsNumber())}toBytes(t){t.writeInt(this.items.length),t.writeBytes(this.items.map(e=>e.getAsNumber()))}static create(){return new me([])}static fromJson(t){var r;const e=(r=u.Json.readArray(t,i=>{var s;return(s=u.Json.readNumber(i))!=null?s:0}))!=null?r:[];return new me(e)}static fromBytes(t){const e=t.readInt(),r=t.readBytes(e);return new me(r)}}nt.register(z.ByteArray,me);class Be extends nt{constructor(e){super();_(this,"value");this.value=e}getId(){return z.Float}equals(e){return e.isFloat()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toString()+"f"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeFloat(this.value)}static create(){return new Be(0)}static fromJson(e){var r;return new Be((r=u.Json.readNumber(e))!=null?r:0)}static fromBytes(e){const r=e.readFloat();return new Be(r)}}nt.register(z.Float,Be);class Dt extends nt{constructor(e){super();_(this,"value");this.value=e}getId(){return z.Int}equals(e){return e.isInt()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toFixed()}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeInt(this.value)}static create(){return new Dt(0)}static fromJson(e){var r;return new Dt((r=u.Json.readInt(e))!=null?r:0)}static fromBytes(e){const r=e.readInt();return new Dt(r)}}nt.register(z.Int,Dt);class ge extends kn{constructor(t){super(Array.from(t!=null?t:[],e=>typeof e=="number"?new Dt(e):e))}getId(){return z.IntArray}equals(t){return t.isIntArray()&&this.length===t.length&&this.items.every((e,r)=>e.equals(t.items[r]))}getType(){return z.Int}get length(){return this.items.length}toString(){return"[I;"+this.items.map(e=>e.getAsNumber().toFixed()).join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsNumber())}toJson(){return this.items.map(t=>t.getAsNumber())}toBytes(t){t.writeInt(this.items.length);for(const e of this.items)t.writeInt(e.getAsNumber())}static create(){return new ge}static fromJson(t){var r;const e=(r=u.Json.readArray(t,i=>{var s;return(s=u.Json.readNumber(i))!=null?s:0}))!=null?r:[];return new ge(e)}static fromBytes(t){const e=t.readInt(),r=[];for(let i=0;i<e;i+=1)r.push(t.readInt());return new ge(r)}}nt.register(z.IntArray,ge);class xt extends kn{constructor(e,r){super(e!=null?e:[]);_(this,"type");this.type=this.items.length===0?z.End:r!=null?r:this.items[0].getId()}static make(e,r){return new xt(r.map(i=>new e(i)))}getId(){return z.List}equals(e){return e.isList()&&this.type===e.type&&this.length===e.length&&this.items.every((r,i)=>r.equals(e.items[i]))}getType(){return this.type}getNumber(e){const r=this.get(e);return r!=null&&r.isNumber()?r.getAsNumber():0}getString(e){const r=this.get(e);return r!=null&&r.isString()?r.getAsString():""}getList(e,r){const i=this.get(e);return(i==null?void 0:i.isList())&&i.getType()===r?i:xt.create()}getCompound(e){const r=this.get(e);return r!=null&&r.isCompound()?r:mt.create()}set(e,r){this.updateType(r),super.set(e,r)}add(e){this.updateType(e),super.add(e)}insert(e,r){this.updateType(r),super.insert(e,r)}updateType(e){if(e.getId()!==z.End){if(this.type===z.End)this.type=e.getId();else if(this.type!==e.getId())throw new Error(`Trying to add tag of type ${z[e.getId()]} to list of ${z[this.type]}`)}}clear(){super.clear(),this.type=z.End}toString(){return"["+this.items.map(e=>e.toString()).join(",")+"]"}toPrettyString(e="  ",r=0){if(this.length===0)return"[]";const i=e.repeat(r),s=e.repeat(r+1);return`[
`+this.map(a=>s+a.toPrettyString(e,r+1)).join(`,
`)+`
`+i+"]"}toSimplifiedJson(){return this.map(e=>e.toSimplifiedJson())}toJson(){return{type:this.type,items:this.items.map(e=>e.toJson())}}toBytes(e){this.items.length===0?this.type=z.End:this.type=this.items[0].getId(),e.writeByte(this.type),e.writeInt(this.items.length);for(const r of this.items)r.toBytes(e)}static create(){return new xt}static fromJson(e){var a,o,m;const r=(a=u.Json.readObject(e))!=null?a:{},i=(o=u.Json.readNumber(r.type))!=null?o:z.Compound,s=((m=u.Json.readArray(r.items))!=null?m:[]).flatMap(c=>c!==void 0?[nt.fromJson(c,i)]:[]);return new xt(s,i)}static fromBytes(e){const r=e.readByte(),i=e.readInt();if(r===z.End&&i>0)throw new Error(`Missing type on ListTag but length is ${i}`);const s=[];for(let a=0;a<i;a+=1)s.push(nt.fromBytes(e,r));return new xt(s,r)}}nt.register(z.List,xt);const ft=class extends nt{constructor(e){super();_(this,"value");this.value=ft.toPair(e)}static toPair(e){return Array.isArray(e)?e:ft.bigintToPair(e)}static bigintToPair(e){return ft.dataview.setBigInt64(0,e),[ft.dataview.getInt32(0),ft.dataview.getInt32(4)]}static pairToBigint(e){return ft.dataview.setInt32(0,Number(e[0])),ft.dataview.setInt32(4,Number(e[1])),ft.dataview.getBigInt64(0)}static pairToString(e){return ft.pairToBigint(e).toString()}static pairToNumber(e){return Number(ft.pairToBigint(e))}getId(){return z.Long}equals(e){return e.isLong()&&this.value[0]===e.value[0]&&this.value[1]===e.value[1]}getAsNumber(){return ft.pairToNumber(this.value)}getAsPair(){return this.value}toBigInt(){return ft.pairToBigint(this.value)}toString(){return ft.pairToString(this.value)+"L"}toPrettyString(){return this.toString()}toSimplifiedJson(){return ft.pairToNumber(this.value)}toJson(){return this.value}toBytes(e){e.writeInt(this.value[0]),e.writeInt(this.value[1])}static create(){return new ft([0,0])}static fromJson(e){return new ft(Array.isArray(e)&&e.length===2?e.map(r=>typeof r=="number"?r:0):[0,0])}static fromBytes(e){const r=e.readInt(),i=e.readInt();return new ft([r,i])}};let Te=ft;_(Te,"dataview",new DataView(new Uint8Array(8).buffer)),nt.register(z.Long,Te);class pe extends kn{constructor(t){super(Array.from(t!=null?t:[],e=>typeof e=="bigint"||Array.isArray(e)?new Te(e):e))}getId(){return z.LongArray}equals(t){return t.isLongArray()&&this.length===t.length&&this.items.every((e,r)=>e.equals(t.items[r]))}getType(){return z.Long}get length(){return this.items.length}toString(){return"[I;"+this.items.map(e=>e.toString()).join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsPair())}toJson(){return this.items.map(t=>t.getAsPair())}toBytes(t){t.writeInt(this.items.length);for(const e of this.items){const[r,i]=e.getAsPair();t.writeInt(r),t.writeInt(i)}}static create(){return new pe}static fromJson(t){var r;const e=(r=u.Json.readArray(t,i=>{var s;return(s=u.Json.readPair(i,a=>{var o;return(o=u.Json.readNumber(a))!=null?o:0}))!=null?s:[0,0]}))!=null?r:[];return new pe(e)}static fromBytes(t){const e=t.readInt(),r=[];for(let i=0;i<e;i+=1)r.push([t.readInt(),t.readInt()]);return new pe(r)}}nt.register(z.LongArray,pe);class Le extends nt{constructor(e){super();_(this,"value");this.value=e}getId(){return z.Short}equals(e){return e.isShort()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toFixed()+"s"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeShort(this.value)}static create(){return new Le(0)}static fromJson(e){return new Le(typeof e=="number"?Math.floor(e):0)}static fromBytes(e){const r=e.readShort();return new Le(r)}}nt.register(z.Short,Le);const Qe=class extends nt{constructor(e){super();_(this,"value");this.value=e}getId(){return z.String}equals(e){return e.isString()&&this.value===e.value}getAsString(){return this.value}toString(){return'"'+this.value.replace(/(\\|")/g,"\\$1")+'"'}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeString(this.value)}static create(){return Qe.EMPTY}static fromJson(e){return new Qe(typeof e=="string"?e:"")}static fromBytes(e){const r=e.readString();return new Qe(r)}};let _t=Qe;_(_t,"EMPTY",new Qe("")),nt.register(z.String,_t);var tr;(n=>{const t=new RegExp("^[-+]?(?:[0-9]+[.]|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?$","i"),e=new RegExp("^[-+]?(?:[0-9]+[.]?|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?d$","i"),r=new RegExp("^[-+]?(?:[0-9]+[.]?|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?f$","i"),i=new RegExp("^[-+]?(?:0|[1-9][0-9]*)b$","i"),s=new RegExp("^[-+]?(?:0|[1-9][0-9]*)l$","i"),a=new RegExp("^[-+]?(?:0|[1-9][0-9]*)s$","i"),o=new RegExp("^[-+]?(?:0|[1-9][0-9]*)$","i");function m(f){if(f.skipWhitespace(),!f.canRead())throw f.createError("Expected value");const p=f.peek();if(p==="{")return c(f);if(p==="[")if(f.canRead(3)&&!Et.isQuotedStringStart(f.peek(1))&&f.peek(2)===";"){f.expect("[",!0);const v=f.cursor,g=f.read();if(f.skip(),f.skipWhitespace(),f.canRead()){if(g==="B")return h(f,me,z.ByteArray,z.Byte);if(g==="L")return h(f,pe,z.LongArray,z.Long);if(g==="I")return h(f,ge,z.IntArray,z.Int);throw f.cursor=v,f.createError(`Invalid array type '${g}'`)}else throw f.createError("Expected value")}else return l(f);else{f.skipWhitespace();const v=f.cursor;if(Et.isQuotedStringStart(f.peek()))return new _t(f.readQuotedString());{const g=f.readUnquotedString();if(g.length===0)throw f.cursor=v,f.createError("Expected value");try{if(r.test(g)){const w=Number(g.substring(0,g.length-1));return new Be(w)}else if(i.test(g)){const w=Number(g.substring(0,g.length-1));return new Lt(Math.floor(w))}else if(s.test(g)){const w=BigInt(g.substring(0,g.length-1));return new Te(w)}else if(a.test(g)){const w=Number(g.substring(0,g.length-1));return new Le(Math.floor(w))}else if(o.test(g)){const w=Number(g);return new Dt(Math.floor(w))}else if(e.test(g)){const w=Number(g.substring(0,g.length-1));return new ee(w)}else if(t.test(g)){const w=Number(g);return new ee(w)}else{if(g.toLowerCase()==="true")return Lt.ONE;if(g.toLowerCase()==="false")return Lt.ZERO}}catch{}return g.length===0?_t.EMPTY:new _t(g)}}}n.readTag=m;function c(f){f.expect("{",!0);const p=new Map;for(f.skipWhitespace();f.canRead()&&f.peek()!=="}";){const v=f.cursor;if(f.skipWhitespace(),!f.canRead())throw f.createError("Expected key");const g=f.readString();if(g.length===0)throw f.cursor=v,f.createError("Expected key");f.expect(":",!0);const w=m(f);if(p.set(g,w),!d(f))break;if(!f.canRead())throw f.createError("Expected key")}return f.expect("}",!0),new mt(p)}function l(f){if(f.expect("[",!0),f.skipWhitespace(),!f.canRead())throw f.createError("Expected value");const p=[];let v=z.End;for(;f.peek()!=="]";){const g=f.cursor,w=m(f),S=w.getId();if(v===z.End)v=S;else if(S!==v)throw f.cursor=g,f.createError(`Can't insert ${z[S]} into list of ${z[v]}`);if(p.push(w),!d(f))break;if(!f.canRead())throw f.createError("Expected value")}return f.expect("]",!0),new xt(p,v)}function h(f,p,v,g){const w=[];for(;f.peek()!=="]";){const S=m(f);if(S.getId()!==g)throw f.createError(`Can't insert ${z[S.getId()]} into ${z[v]}`);if(w.push(S.isLong()?S.getAsPair():S.getAsNumber()),!d(f))break;if(!f.canRead())throw f.createError("Expected value")}return f.expect("]"),new p(w)}function d(f){return f.skipWhitespace(),f.canRead()&&f.peek()===","?(f.skip(),f.skipWhitespace(),!0):!1}})(tr||(tr={}));class mt extends nt{constructor(e){super();_(this,"properties");this.properties=e!=null?e:new Map}getId(){return z.Compound}equals(e){return e.isCompound()&&this.size===e.size&&[...this.properties.entries()].every(([r,i])=>{const s=e.properties.get(r);return s!==void 0&&i.equals(s)})}has(e){return this.properties.has(e)}hasNumber(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.isNumber())!=null?i:!1}hasString(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.isString())!=null?i:!1}hasList(e,r,i){var a;const s=this.get(e);return(a=(s==null?void 0:s.isList())&&(r===void 0||s.getType()===r)&&(i===void 0||s.length===i))!=null?a:!1}hasCompound(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.isCompound())!=null?i:!1}get(e){return this.properties.get(e)}getString(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.getAsString())!=null?i:""}getNumber(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.getAsNumber())!=null?i:0}getBoolean(e){return this.getNumber(e)!==0}getList(e,r){const i=this.get(e);return(i==null?void 0:i.isList())&&(r===void 0||i.getType()===r)?i:xt.create()}getCompound(e){const r=this.get(e);return r!=null&&r.isCompound()?r:mt.create()}getByteArray(e){const r=this.get(e);return r!=null&&r.isByteArray()?r:me.create()}getIntArray(e){const r=this.get(e);return r!=null&&r.isIntArray()?r:ge.create()}getLongArray(e){const r=this.get(e);return r!=null&&r.isLongArray()?r:pe.create()}keys(){return this.properties.keys()}get size(){return this.properties.size}map(e){return Object.fromEntries([...this.properties.entries()].map(([r,i])=>e(r,i,this)))}forEach(e){[...this.properties.entries()].forEach(([r,i])=>e(r,i,this))}set(e,r){return this.properties.set(e,r),this}delete(e){return this.properties.delete(e)}clear(){return this.properties.clear(),this}toString(){const e=[];for(const[r,i]of this.properties.entries()){const s=r.split("").some(a=>!Et.isAllowedInUnquotedString(a));e.push((s?JSON.stringify(r):r)+":"+i.toString())}return"{"+e.join(",")+"}"}toPrettyString(e="  ",r=0){if(this.size===0)return"{}";const i=e.repeat(r),s=e.repeat(r+1),a=[];for(const[o,m]of this.properties.entries()){const c=o.split("").some(l=>!Et.isAllowedInUnquotedString(l));a.push((c?JSON.stringify(o):o)+": "+m.toPrettyString(e,r+1))}return`{
`+a.map(o=>s+o).join(`,
`)+`
`+i+"}"}toSimplifiedJson(){return this.map((e,r)=>[e,r.toSimplifiedJson()])}toJson(){return this.map((e,r)=>[e,{type:r.getId(),value:r.toJson()}])}toBytes(e){for(const[r,i]of this.properties.entries()){const s=i.getId();e.writeByte(s),e.writeString(r),i.toBytes(e)}e.writeByte(z.End)}static create(){return new mt}static fromString(e){return tr.readTag(e)}static fromJson(e){const r=u.Json.readMap(e,i=>{var c;const{type:s,value:a}=(c=u.Json.readObject(i))!=null?c:{},o=u.Json.readNumber(s);return nt.fromJson(a!=null?a:{},o)});return new mt(new Map(Object.entries(r)))}static fromBytes(e){const r=new Map;for(;;){const i=e.readByte();if(i===z.End)break;const s=e.readString(),a=nt.fromBytes(e,i);r.set(s,a)}return new mt(r)}}nt.register(z.Compound,mt);const be=class{constructor(t,e,r,i,s){this.name=t,this.root=e,this.compression=r,this.littleEndian=i,this.bedrockHeader=s}writeNamedTag(t){t.writeByte(z.Compound),t.writeString(this.name),this.root.toBytes(t)}write(){const t=this.littleEndian===!0||this.bedrockHeader!==void 0,e=new fi({littleEndian:t,offset:this.bedrockHeader&&8});if(this.writeNamedTag(e),this.bedrockHeader!==void 0){const i=e.offset;e.offset=0,e.writeInt(this.bedrockHeader),e.writeInt(i-8),e.offset=i}const r=e.getData();return this.compression==="gzip"?Gr.gzip(r):this.compression==="zlib"?Gr.deflate(r):r}static readNamedTag(t){if(t.readByte()!==z.Compound)throw new Error("Top tag should be a compound");return{name:t.readString(),root:mt.fromBytes(t)}}static create(t={}){var o,m,c;const e=(o=t.name)!=null?o:be.DEFAULT_NAME,r=mt.create(),i=(m=t.compression)!=null?m:"none",s=typeof t.bedrockHeader=="boolean"?be.DEFAULT_BEDROCK_HEADER:t.bedrockHeader,a=(c=t.littleEndian)!=null?c:t.bedrockHeader!==void 0;return new be(e,r,i,a,s)}static read(t,e={}){var d;const r=typeof e.bedrockHeader=="number"?e.bedrockHeader:e.bedrockHeader?oa(t):void 0,i=e.compression==="gzip"||!r&&e.compression===void 0&&Mt(t),s=e.compression==="zlib"||!r&&e.compression===void 0&&Se(t),a=s||i?Gr.inflate(t):t,o=e.littleEndian||r!==void 0,m=i?"gzip":s?"zlib":"none",c=new hi(a,{littleEndian:o,offset:r&&8}),{name:l,root:h}=be.readNamedTag(c);return new be((d=e.name)!=null?d:l,h,m,o,r)}toJson(){var t;return{name:this.name,root:this.root.toJson(),compression:this.compression,littleEndian:this.littleEndian,bedrockHeader:(t=this.bedrockHeader)!=null?t:null}}static fromJson(t){var m,c,l,h,d;const e=(m=u.Json.readObject(t))!=null?m:{},r=(c=u.Json.readString(e.name))!=null?c:"",i=mt.fromJson((l=e.root)!=null?l:{}),s=(h=u.Json.readString(e.compression))!=null?h:"none",a=(d=u.Json.readBoolean(e.littleEndian))!=null?d:!1,o=u.Json.readNumber(e.bedrockHeader);return new be(r,i,s,a,o)}};let $t=be;_($t,"DEFAULT_NAME",""),_($t,"DEFAULT_BEDROCK_HEADER",4);class te{constructor(t,e,r,i,s){_(this,"file");_(this,"dirty");this.x=t,this.z=e,this.compression=r,this.timestamp=i,this.raw=s,this.dirty=!1}getCompression(){switch(this.compression){case 1:return"gzip";case 2:return"zlib";case 3:return"none";default:throw new Error(`Invalid compression mode ${this.compression}`)}}setCompression(t){switch(t){case"gzip":this.compression=1;break;case"zlib":this.compression=2;break;case"none":this.compression=3;break;default:throw new Error(`Invalid compression mode ${t}`)}}getFile(){return this.file===void 0&&(this.file=$t.read(this.raw,{compression:this.getCompression()})),this.file}getRoot(){return this.getFile().root}setRoot(t){this.file===void 0&&(this.file=$t.create({compression:this.getCompression()})),this.file.root=t,this.markDirty()}markDirty(){this.dirty=!0}getRaw(){if(this.file===void 0||this.dirty===!1)return this.raw;this.file.compression=this.getCompression();const t=this.file.write();return this.raw=t,this.dirty=!1,t}toJson(){return{x:this.x,z:this.z,compression:this.compression,timestamp:this.timestamp,size:this.raw.byteLength}}toRef(t){return new te.Ref(this.x,this.z,this.compression,this.timestamp,this.raw.byteLength,t)}static create(t,e,r,i){const s=new te(t,e,0,i!=null?i:0,r.write());return s.setCompression(r.compression),s}static fromJson(t,e){var c,l,h,d,f,p;const r=(c=u.Json.readObject(t))!=null?c:{},i=(l=u.Json.readInt(r.x))!=null?l:0,s=(h=u.Json.readInt(r.z))!=null?h:0,a=(d=u.Json.readNumber(r.compression))!=null?d:2,o=(f=u.Json.readInt(r.timestamp))!=null?f:0,m=(p=u.Json.readInt(r.size))!=null?p:0;return new te.Ref(i,s,a,o,m,e)}}(n=>{class t{constructor(r,i,s,a,o,m){_(this,"file");this.x=r,this.z=i,this.compression=s,this.timestamp=a,this.size=o,this.resolver=m}getFile(){if(this.file instanceof $t)return this.file}getRoot(){if(this.file instanceof $t)return this.file.root}async getFileAsync(){return this.file?this.file:(this.file=(async()=>{const r=await this.resolver(this.x,this.z);return this.file=r,r})(),this.file)}async getRootAsync(){return(await this.getFileAsync()).root}isResolved(){return this.file instanceof $t}}n.Ref=t})(te||(te={}));class Ts{constructor(t){_(this,"chunks");this.chunks=Array(32*32).fill(void 0);for(const e of t){const r=we.getIndex(e.x,e.z);this.chunks[r]=e}}getChunkPositions(){return this.chunks.flatMap(t=>t?[[t.x,t.z]]:[])}getChunk(t){if(!(t<0||t>=32*32))return this.chunks[t]}findChunk(t,e){return this.getChunk(we.getIndex(t,e))}getFirstChunk(){return this.chunks.filter(t=>t!==void 0)[0]}filter(t){return this.chunks.filter(e=>e!==void 0&&t(e))}map(t){return this.chunks.flatMap(e=>e!==void 0?[t(e)]:[])}}class we extends Ts{constructor(t){super(t)}write(){let t=0;for(const s of this.chunks)s!==void 0&&(t+=Math.ceil(s.getRaw().length/4096));const e=new Uint8Array(8192+t*4096),r=new DataView(e.buffer);let i=2;for(const s of this.chunks){if(s===void 0)continue;const a=s.getRaw(),o=4*((s.x&31)+(s.z&31)*32),m=Math.ceil(a.length/4096);r.setInt8(o,i>>16),r.setInt16(o+1,i&65535),r.setInt8(o+3,m),r.setInt32(o+4096,s.timestamp);const c=i*4096;r.setInt32(c,a.length+1),r.setInt8(c+4,s.compression),e.set(a,c+5),i+=m}return e}static read(t){const e=[];for(let r=0;r<32;r+=1)for(let i=0;i<32;i+=1){const s=4*((r&31)+(i&31)*32);if(t[s+3]===0)continue;const o=(t[s]<<16)+(t[s+1]<<8)+t[s+2],m=(t[s+4096]<<24)+(t[s+4097]<<16)+(t[s+4098]<<8)+t[s+4099],c=o*4096,l=(t[c]<<24)+(t[c+1]<<16)+(t[c+2]<<8)+t[c+3],h=t[c+4],d=t.slice(c+5,c+4+l);e.push(new te(r,i,h,m,d))}return new we(e)}static getIndex(t,e){return(t&31)+(e&31)*32}toJson(){return{chunks:this.map(t=>t.toJson())}}static fromJson(t,e){var a,o;const r=(a=u.Json.readObject(t))!=null?a:{},s=((o=u.Json.readArray(r.chunks))!=null?o:[]).flatMap(m=>m!==void 0?[te.fromJson(m,e)]:[]);return new we.Ref(s)}}(n=>{class t extends Ts{}n.Ref=t})(we||(we={}));class ee extends nt{constructor(e){super();_(this,"value");this.value=e}getId(){return z.Double}equals(e){return e.isDouble()&&this.value===e.value}getAsNumber(){return this.value}toString(){return Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeDouble(this.value)}static create(){return new ee(0)}static fromJson(e){var r;return new ee((r=u.Json.readNumber(e))!=null?r:0)}static fromBytes(e){const r=e.readDouble();return new ee(r)}}nt.register(z.Double,ee);const tn=class extends nt{constructor(){super()}getId(){return z.End}equals(t){return t.isEnd()}toString(){return"END"}toPrettyString(){return this.toString()}toSimplifiedJson(){return null}toJson(){return null}toBytes(){}static create(){return tn.INSTANCE}static fromJson(){return tn.INSTANCE}static fromBytes(){return tn.INSTANCE}};let An=tn;_(An,"INSTANCE",new tn),nt.register(z.End,An);function Vr(n){return typeof n=="string"?new _t(n):typeof n=="number"?Number.isInteger(n)?new Dt(n):new ee(n):typeof n=="boolean"?new Lt(n):Array.isArray(n)?new xt(n.map(Vr)):typeof n=="object"&&n!==null?new mt(new Map(Object.entries(n!=null?n:{}).map(([t,e])=>[t,Vr(e)]))):new Lt(0)}u.Direction=(n=>(n.UP="up",n.DOWN="down",n.NORTH="north",n.EAST="east",n.SOUTH="south",n.WEST="west",n))(u.Direction||{});const al={up:[0,1,0],down:[0,-1,0],north:[0,0,-1],east:[1,0,0],south:[0,0,1],west:[-1,0,0]};(n=>{n.ALL=["up","down","north","east","south","west"];function t(e){return al[e]}n.normal=t})(u.Direction||(u.Direction={})),u.BlockPos=void 0,(n=>{function t(h,d,f){return[h,d,f]}n.create=t,n.ZERO=n.create(0,0,0);function e(h,d,f,p){return[h[0]+d,h[1]+f,h[2]+p]}n.offset=e;function r(h,d){return[h[0]-d[0],h[1]-d[1],h[2]-d[2]]}n.subtract=r;function i(h,d){return[h[0]+d[0],h[1]+d[1],h[2]+d[2]]}n.add=i;function s(h,d){return n.offset(h,...u.Direction.normal(d))}n.towards=s;function a(h,d){return h===d?!0:h[0]===d[0]&&h[1]===d[1]&&h[2]===d[2]}n.equals=a;function o(h){return h[0]*h[0]+h[1]*h[1]+h[2]*h[2]}n.magnitude=o;function m(h){return new xt(h.map(d=>new Dt(d)))}n.toNbt=m;function c(h){return h.getAsTuple(3,d=>d!=null&&d.isInt()?d.getAsNumber():0)}n.fromNbt=c;function l(h){var f;const d=(f=u.Json.readArray(h,p=>{var v;return(v=u.Json.readInt(p))!=null?v:0}))!=null?f:[0,0,0];return t(d[0],d[1],d[2])}n.fromJson=l})(u.BlockPos||(u.BlockPos={}));const ae=class{constructor(t,e){this.namespace=t,this.path=e}is(t){return this.equals(ae.parse(t))}equals(t){return this===t?!0:t instanceof ae?this.namespace===t.namespace&&this.path===t.path:!1}toString(){return this.namespace+ae.SEPARATOR+this.path}withPrefix(t){return new ae(this.namespace,t+this.path)}static create(t){return new ae(this.DEFAULT_NAMESPACE,t)}static parse(t){const e=t.indexOf(this.SEPARATOR);if(e>=0){const r=e>=1?t.substring(0,e):this.DEFAULT_NAMESPACE,i=t.substring(e+1);return new ae(r,i)}return new ae(this.DEFAULT_NAMESPACE,t)}};let B=ae;_(B,"DEFAULT_NAMESPACE","minecraft"),_(B,"SEPARATOR",":");const yt=class{constructor(t,e={}){_(this,"name");this.properties=e,this.name=typeof t=="string"?B.parse(t):t}getName(){return this.name}getProperties(){return this.properties}getProperty(t){return this.properties[t]}isFluid(){return this.is(yt.WATER)||this.is(yt.LAVA)}isWaterlogged(){return this.is(yt.WATER)||this.is(yt.LAVA)||this.is("bubble_column")||this.is("kelp")||this.is("kelp_plant")||this.is("seagrass")||this.is("tall_seagrass")||this.properties.waterlogged==="true"}equals(t){return!this.name.equals(t.name)||Object.keys(this.properties).length!==Object.keys(t.properties).length?!1:Object.keys(this.properties).every(e=>t.properties[e]===this.properties[e])}is(t){return typeof t=="string"?this.name.equals(B.parse(t)):t instanceof B?this.name.equals(t):this.name.equals(t.name)}toString(){return Object.keys(this.properties).length===0?this.name.toString():`${this.name.toString()}[${Object.entries(this.properties).map(([t,e])=>t+"="+e).join(",")}]`}static parse(t){const e=t.indexOf("[");if(e===-1)return new yt(t);{const r=t.substring(0,e),i=t.substring(e+1,t.length-1).split(","),s=Object.fromEntries(i.map(a=>a.split("=")));return new yt(r,s)}}static fromNbt(t){const e=B.parse(t.getString("Name")),r=t.getCompound("Properties").map((i,s)=>[i,s.getAsString()]);return new yt(e,r)}static fromJson(t){var s,a;const e=(s=u.Json.readObject(t))!=null?s:{},r=B.parse((a=u.Json.readString(e.Name))!=null?a:yt.STONE.name.toString()),i=u.Json.readMap(e.Properties,o=>{var m;return(m=u.Json.readString(o))!=null?m:""});return new yt(r,i)}};let X=yt;_(X,"AIR",new yt(B.create("air"))),_(X,"STONE",new yt(B.create("stone"))),_(X,"WATER",new yt(B.create("water"),{level:"0"})),_(X,"LAVA",new yt(B.create("lava"),{level:"0"}));class Ls{constructor(t,e){_(this,"storage");_(this,"palette");this.size=t,this.defaultValue=e,this.storage=Array(t).fill(0),this.palette=[e]}index(t,e,r){return(t<<8)+(e<<4)+r}get(t,e,r){const i=this.storage[this.index(t,e,r)];return this.palette[i]}set(t,e,r,i){let s=this.palette.findIndex(a=>a.equals(i));s===-1&&(s=this.palette.length,this.palette.push(i)),this.storage[this.index(t,e,r)]=s}}const en=class{constructor(t){_(this,"states");this.minY=t,this.states=new Ls(en.SIZE,X.AIR)}get minBlockY(){return this.minY<<4}getBlockState(t,e,r){return this.states.get(t,e,r)}setBlockState(t,e,r,i){this.states.set(t,e,r,i)}};let We=en;_(We,"WIDTH",16),_(We,"SIZE",en.WIDTH*en.WIDTH*en.WIDTH);class ol{constructor(t,e,r){_(this,"sections");this.minY=t,this.height=e,this.pos=r,this.sections=Array(this.sectionsCount).fill(null)}get maxY(){return this.minY+this.height}get minSection(){return this.minY>>4}get maxSection(){return(this.maxY-1>>4)+1}get sectionsCount(){return this.maxSection-this.minSection}getSectionIndex(t){return(t>>4)-this.minSection}getBlockState(t){var a;const[e,r,i]=t,s=this.sections[this.getSectionIndex(r)];return(a=s==null?void 0:s.getBlockState(e&15,r&15,i&15))!=null?a:X.AIR}setBlockState(t,e){const[r,i,s]=t,a=this.getSectionIndex(i);let o=this.sections[a];if(o===null){if(e.equals(X.AIR))return;o=this.getOrCreateSection(a)}o.setBlockState(r&15,i&15,s&15,e)}getOrCreateSection(t){return this.sections[t]==null&&(this.sections[t]=new We(this.minSection+t)),this.sections[t]}}u.ChunkPos=void 0,(n=>{function t(l,h){return[l,h]}n.create=t;function e(l){return[l[0]>>4,l[2]>>4]}n.fromBlockPos=e;function r(l){return[Number(l)&4294967295,Number(l>>BigInt(32))]}n.fromLong=r;function i(l){return s(l[0],l[1])}n.toLong=i;function s(l,h){return BigInt(l&4294967295)|BigInt(h&4294967295)<<BigInt(32)}n.asLong=s;function a(l){return l[0]<<4}n.minBlockX=a;function o(l){return l[1]<<4}n.minBlockZ=o;function m(l){return(l[0]<<4)+15}n.maxBlockX=m;function c(l){return(l[1]<<4)+15}n.maxBlockZ=c})(u.ChunkPos||(u.ChunkPos={}));const Ps=new Map([["minecraft:speed",3402751],["minecraft:slowness",9154528],["minecraft:haste",14270531],["minecraft:mining_fatigue",4866583],["minecraft:strength",16762624],["minecraft:instant_health",16262179],["minecraft:instant_damage",11101546],["minecraft:jump_boost",16646020],["minecraft:nausea",5578058],["minecraft:regeneration",13458603],["minecraft:resistance",9520880],["minecraft:fire_resistance",16750848],["minecraft:water_breathing",10017472],["minecraft:invisibility",16185078],["minecraft:blindness",2039587],["minecraft:night_vision",12779366],["minecraft:hunger",5797459],["minecraft:weakness",4738376],["minecraft:poison",8889187],["minecraft:wither",7561558],["minecraft:health_boost",16284963],["minecraft:absorption",2445989],["minecraft:saturation",16262179],["minecraft:glowing",9740385],["minecraft:levitation",13565951],["minecraft:luck",5882118],["minecraft:unluck",12624973],["minecraft:slow_falling",15978425],["minecraft:conduit_power",1950417],["minecraft:dolphins_grace",8954814],["minecraft:bad_omen",745784],["minecraft:hero_of_the_village",4521796],["minecraft:darkness",2696993],["minecraft:trial_omen",1484454],["minecraft:raid_omen",14565464],["minecraft:wind_charged",12438015],["minecraft:weaving",7891290],["minecraft:oozing",10092451],["minecraft:infested",9214860]]);u.MobEffectInstance=void 0,(n=>{function t(e){return{effect:B.parse(e.getString("id")),duration:e.getNumber("duration"),amplifier:e.getNumber("amplifier")}}n.fromNbt=t})(u.MobEffectInstance||(u.MobEffectInstance={}));const Os=new Map([["minecraft:empty",[]],["minecraft:water",[]],["minecraft:mundane",[]],["minecraft:thick",[]],["minecraft:awkward",[]],["minecraft:night_vision",[{effect:B.create("night_vision"),duration:3600,amplifier:0}]],["minecraft:long_night_vision",[{effect:B.create("night_vision"),duration:9600,amplifier:0}]],["minecraft:invisibility",[{effect:B.create("invisibility"),duration:3600,amplifier:0}]],["minecraft:long_invisibility",[{effect:B.create("invisibility"),duration:9600,amplifier:0}]],["minecraft:leaping",[{effect:B.create("jump_boost"),duration:3600,amplifier:0}]],["minecraft:long_leaping",[{effect:B.create("jump_boost"),duration:9600,amplifier:0}]],["minecraft:strong_leaping",[{effect:B.create("jump_boost"),duration:1800,amplifier:1}]],["minecraft:fire_resistance",[{effect:B.create("fire_resistance"),duration:3600,amplifier:0}]],["minecraft:long_fire_resistance",[{effect:B.create("fire_resistance"),duration:9600,amplifier:0}]],["minecraft:swiftness",[{effect:B.create("speed"),duration:3600,amplifier:0}]],["minecraft:long_swiftness",[{effect:B.create("speed"),duration:9600,amplifier:0}]],["minecraft:strong_swiftness",[{effect:B.create("speed"),duration:1800,amplifier:1}]],["minecraft:slowness",[{effect:B.create("slowness"),duration:1800,amplifier:0}]],["minecraft:long_slowness",[{effect:B.create("slowness"),duration:4800,amplifier:0}]],["minecraft:strong_slowness",[{effect:B.create("slowness"),duration:400,amplifier:3}]],["minecraft:turtle_master",[{effect:B.create("slowness"),duration:400,amplifier:3},{effect:B.create("resistance"),duration:400,amplifier:2}]],["minecraft:long_turtle_master",[{effect:B.create("slowness"),duration:800,amplifier:3},{effect:B.create("resistance"),duration:800,amplifier:2}]],["minecraft:strong_turtle_master",[{effect:B.create("slowness"),duration:400,amplifier:5},{effect:B.create("resistance"),duration:400,amplifier:3}]],["minecraft:water_breathing",[{effect:B.create("water_breathing"),duration:3600,amplifier:0}]],["minecraft:long_water_breathing",[{effect:B.create("water_breathing"),duration:9600,amplifier:0}]],["minecraft:healing",[{effect:B.create("instant_health"),duration:1,amplifier:0}]],["minecraft:strong_healing",[{effect:B.create("instant_health"),duration:1,amplifier:1}]],["minecraft:harming",[{effect:B.create("instant_damage"),duration:1,amplifier:0}]],["minecraft:strong_harming",[{effect:B.create("instant_damage"),duration:1,amplifier:1}]],["minecraft:poison",[{effect:B.create("poison"),duration:900,amplifier:0}]],["minecraft:long_poison",[{effect:B.create("poison"),duration:1800,amplifier:0}]],["minecraft:strong_poison",[{effect:B.create("poison"),duration:432,amplifier:1}]],["minecraft:regeneration",[{effect:B.create("regeneration"),duration:900,amplifier:0}]],["minecraft:long_regeneration",[{effect:B.create("regeneration"),duration:1800,amplifier:0}]],["minecraft:strong_regeneration",[{effect:B.create("regeneration"),duration:450,amplifier:1}]],["minecraft:strength",[{effect:B.create("strength"),duration:3600,amplifier:0}]],["minecraft:long_strength",[{effect:B.create("strength"),duration:9600,amplifier:0}]],["minecraft:strong_strength",[{effect:B.create("strength"),duration:1800,amplifier:1}]],["minecraft:weakness",[{effect:B.create("weakness"),duration:1800,amplifier:0}]],["minecraft:long_weakness",[{effect:B.create("weakness"),duration:4800,amplifier:0}]],["minecraft:luck",[{effect:B.create("luck"),duration:6e3,amplifier:0}]],["minecraft:slow_falling",[{effect:B.create("slow_falling"),duration:1800,amplifier:0}]],["minecraft:long_slow_falling",[{effect:B.create("slow_falling"),duration:4800,amplifier:0}]],["minecraft:wind_charged",[{effect:B.create("wind_charged"),duration:3600,amplifier:0}]],["minecraft:weaving",[{effect:B.create("weaving"),duration:3600,amplifier:0}]],["minecraft:oozing",[{effect:B.create("oozing"),duration:3600,amplifier:0}]],["minecraft:infested",[{effect:B.create("infested"),duration:3600,amplifier:0}]]]);u.PotionContents=void 0,(n=>{function t(s){const a={};return s.isString()?a.potion=B.parse(s.getAsString()):s.isCompound()&&(s.hasString("potion")&&(a.potion=B.parse(s.getString("potion"))),s.hasNumber("custom_color")&&(a.customColor=s.getNumber("custom_color")),s.hasList("custom_effects")&&(a.customEffects=s.getList("custom_effects",z.Compound).map(u.MobEffectInstance.fromNbt))),a}n.fromNbt=t;function e(s){if(s.customColor)return u.Color.intToRgb(s.customColor);const a=r(s);return i(a)}n.getColor=e;function r(s){var o;const a=[];return s.potion&&a.push(...(o=Os.get(s.potion.toString()))!=null?o:[]),s.customEffects&&a.push(...s.customEffects),a}n.getAllEffects=r;function i(s){let[a,o,m]=[0,0,0],c=0;for(const l of s){const h=Ps.get(l.effect.toString());if(h===void 0)continue;const d=u.Color.intToRgb(h),f=l.amplifier+1;a+=f*d[0],o+=f*d[1],m+=f*d[2],c+=f}return c===0?u.Color.intToRgb(-13083194):(a=a/c,o=o/c,m=m/c,[a,o,m])}})(u.PotionContents||(u.PotionContents={})),u.Holder=void 0,(n=>{function t(i,s){return a=>typeof a=="string"?r(i,B.parse(a)):e(s(a))}n.parser=t;function e(i,s){return{value:()=>i,key:()=>s}}n.direct=e;function r(i,s,a=!0){return a?{value:()=>i.getOrThrow(s),key:()=>s}:{value:()=>i.get(s),key:()=>s}}n.reference=r})(u.Holder||(u.Holder={}));class ve{constructor(t){this.entries=t}static parser(t,e){const r=e!=null?e:i=>{var s;return u.Holder.reference(t,B.parse((s=u.Json.readString(i))!=null?s:""))};return i=>{var s,a;return typeof i=="string"?i.startsWith("#")?u.Holder.reference(t.getTagRegistry(),B.parse(i.substring(1))):u.Holder.direct(new ve([])):u.Holder.direct((a=new ve((s=u.Json.readArray(i,r))!=null?s:[]))!=null?a:[])}}static fromJson(t,e,r){var o,m,c;const i=(o=u.Json.readObject(e))!=null?o:{},s=(m=u.Json.readBoolean(i.replace))!=null?m:!1,a=(c=u.Json.readArray(i.values,l=>{var f,p,v;var h=!0,d="";if(typeof l=="string")d=l;else{const g=(f=u.Json.readObject(l))!=null?f:{};h=(p=u.Json.readBoolean(g.required))!=null?p:!1,d=(v=u.Json.readString(g.id))!=null?v:""}return d.startsWith("#")?u.Holder.reference(t.getTagRegistry(),B.parse(d.substring(1)),h):u.Holder.reference(t,B.parse(d),h)}))!=null?c:[];return r&&!s&&t.getTagRegistry().has(r)&&(a==null||a.push(u.Holder.direct(t.getTagRegistry().get(r)))),new ve(a)}*getEntries(){for(const t of this.entries){const e=t.value();e!==void 0&&(e instanceof ve?yield*e.getEntries():yield t)}}}class Yt{constructor(t,e,r=new Map){this.id=t,this.count=e,this.components=r}getComponent(t,e){var i;if(typeof t=="string"&&(t=B.parse(t)),this.components.has("!"+t.toString()))return;const r=this.components.get(t.toString());if(r)return r;if(e)return(i=e.getItemComponents(this.id))==null?void 0:i.get(t.toString())}hasComponent(t,e){var r;return typeof t=="string"&&(t=B.parse(t)),this.components.has("!"+t.toString())?!1:this.components.has(t.toString())?!0:e?(r=e.getItemComponents(this.id))==null?void 0:r.has(t.toString()):!1}clone(){const t=new Map(this.components);return new Yt(this.id,this.count,t)}is(t){return typeof t=="string"?this.id.equals(B.parse(t)):t instanceof B?this.id.equals(t):this.id.equals(t.id)}equals(t){return this===t?!0:t instanceof Yt?this.count===t.count&&this.isSameItemSameComponents(t):!1}isSameItemSameComponents(t){if(!this.id.equals(t.id)||this.components.size!==t.components.size)return!1;for(const[e,r]of this.components){const i=t.components.get(e);if(r.toString()!==(i==null?void 0:i.toString()))return!1}return!0}toString(){let t=this.id.toString();return this.components.size>0&&(t+=`[${[...this.components.entries()].map(([e,r])=>e.startsWith("!")?e:`${e}=${r.toString()}`).join(",")}]`),this.count>1&&(t+=` ${this.count}`),t}static fromString(t){const e=new Et(t);for(;e.canRead()&&e.peek()!=="[";)e.skip();const r=B.parse(e.getRead());if(!e.canRead())return new Yt(r,1);const i=new Map;if(e.skip(),e.peek()==="]")return new Yt(r,1,i);do{if(e.peek()==="!"){e.skip(),e.skipWhitespace();const s=e.cursor;for(;e.canRead()&&e.peek()!=="]"&&e.peek()!==",";)e.skip();i.set("!"+B.parse(e.getRead(s).trim()).toString(),new mt)}else{e.skipWhitespace();const s=e.cursor;for(;e.canRead()&&e.peek()!=="=";)e.skip();const a=B.parse(e.getRead(s).trim()).toString();if(!e.canRead())break;e.skip(),e.skipWhitespace();const o=tr.readTag(e);i.set(a,o)}if(e.skipWhitespace(),!e.canRead())break;if(e.peek()==="]")return new Yt(r,1,i);if(e.peek()!==",")throw new Error("Expected , or ]");e.skip()}while(e.canRead());throw new Error("Missing closing ]")}toNbt(){const t=new mt().set("id",new _t(this.id.toString()));return this.count>1&&t.set("count",new Dt(this.count)),this.components.size>0&&t.set("components",new mt(this.components)),t}static fromNbt(t){const e=B.parse(t.getString("id")),r=t.hasNumber("count")?t.getNumber("count"):1,i=new Map(Object.entries(t.getCompound("components").map((s,a)=>s.startsWith("!")?["!"+B.parse(s).toString(),new mt]:[B.parse(s).toString(),a])));return new Yt(e,r,i)}}const Ue=class{constructor(t,e){_(this,"storage",new Map);_(this,"builtin",new Map);_(this,"tags");this.key=t,this.parser=e}static createAndRegister(t,e){const r=new Ue(B.create(t),e);return Ue.REGISTRY.register(r.key,r),r}register(t,e,r){return this.storage.set(t.toString(),e),r&&this.builtin.set(t.toString(),e),u.Holder.reference(this,t)}delete(t){const e=this.storage.delete(t.toString());return this.builtin.delete(t.toString()),e}keys(){return[...this.storage.keys()].map(t=>B.parse(t))}has(t){return this.storage.has(t.toString())}get(t){var e=this.storage.get(t.toString());return e instanceof Function&&(e=e(),this.storage.set(t.toString(),e)),e}getOrThrow(t){const e=this.get(t);if(e===void 0)throw new Error(`Missing key in ${this.key.toString()}: ${t.toString()}`);return e}parse(t){if(!this.parser)throw new Error(`No parser exists for ${this.key.toString()}`);return this.parser(t)}clear(){this.storage.clear();for(const[t,e]of this.builtin.entries())this.storage.set(t,e);return this.tags&&this.tags.clear(),this}assign(t){if(!this.key.equals(t.key))throw new Error(`Cannot assign registry of type ${t.key.toString()} to registry of type ${this.key.toString()}`);for(const e of t.keys())this.storage.set(e.toString(),t.getOrThrow(e));return this}cloneEmpty(){return new Ue(this.key,this.parser)}forEach(t){for(const[e,r]of this.storage.entries())t(B.parse(e),r instanceof Function?r():r,this)}map(t){return[...this.storage.entries()].map(([e,r])=>t(B.parse(e),r instanceof Function?r():r,this))}getTagRegistry(){return this.tags===void 0&&(this.tags=new Ue(new B(this.key.namespace,`tags/${this.key.path}`))),this.tags}};let Rt=Ue;_(Rt,"REGISTRY",new Ue(B.create("root"))),u.Rotation=(n=>(n.NONE="none",n.CLOCKWISE_90="clockwise_90",n.CLOCKWISE_180="180",n.COUNTERCLOCKWISE_90="counterclockwise_90",n))(u.Rotation||{}),(n=>{function t(e){return["none","clockwise_90","180","counterclockwise_90"][e.nextInt(4)]}n.getRandom=t})(u.Rotation||(u.Rotation={}));const vr=class{constructor(t,e=[],r=[]){_(this,"blocksMap",[]);this.size=t,this.palette=e,this.blocks=r,r.forEach(i=>{if(!this.isInside(i.pos))throw new Error(`Found block at ${i.pos} which is outside the structure bounds ${this.size}`);this.blocksMap[i.pos[0]*t[1]*t[2]+i.pos[1]*t[2]+i.pos[2]]=i})}getSize(){return this.size}addBlock(t,e,r,i){if(!this.isInside(t))throw new Error(`Cannot add block at ${t} outside the structure bounds ${this.size}`);const s=new X(e,r);let a=this.palette.findIndex(o=>o.equals(s));return a===-1&&(a=this.palette.length,this.palette.push(s)),this.blocks.push({pos:t,state:a,nbt:i}),this.blocksMap[t[0]*this.size[1]*this.size[2]+t[1]*this.size[2]+t[2]]={pos:t,state:a,nbt:i},this}getBlocks(){return this.blocks.map(t=>this.toPlacedBlock(t))}getBlock(t){if(!this.isInside(t))return null;const e=this.blocksMap[t[0]*this.size[1]*this.size[2]+t[1]*this.size[2]+t[2]];return e?this.toPlacedBlock(e):null}toPlacedBlock(t){const e=this.palette[t.state];if(!e)throw new Error(`Block at ${t.pos.join(" ")} in structure references invalid palette index ${t.state}`);return{pos:t.pos,state:e,nbt:t.nbt}}isInside(t){return t[0]>=0&&t[0]<this.size[0]&&t[1]>=0&&t[1]<this.size[1]&&t[2]>=0&&t[2]<this.size[2]}static fromNbt(t){const e=u.BlockPos.fromNbt(t.getList("size")),r=t.getList("palette",z.Compound).map(s=>X.fromNbt(s)),i=t.getList("blocks",z.Compound).map(s=>{const a=u.BlockPos.fromNbt(s.getList("pos")),o=s.getNumber("state"),m=s.getCompound("nbt");return{pos:a,state:o,nbt:m.size>0?m:void 0}});return new vr(e,r,i)}static transform(t,e,r){switch(e){case u.Rotation.COUNTERCLOCKWISE_90:return u.BlockPos.create(r[0]-r[2]+t[2],t[1],r[0]+r[2]-t[0]);case u.Rotation.CLOCKWISE_90:return u.BlockPos.create(r[0]+r[2]-t[2],t[1],r[2]-r[0]+t[0]);case u.Rotation.CLOCKWISE_180:return u.BlockPos.create(r[0]+r[0]-t[0],t[1],r[2]+r[2]-t[2]);default:return t}}};let ne=vr;_(ne,"REGISTRY",Rt.createAndRegister("structures")),_(ne,"EMPTY",new vr(u.BlockPos.ZERO));const cl=-2147483648,ll=2147483647,ul=-9223372036854776e3,hl=9223372036854776e3;function re(n){return n*n}function bt(n,t,e){return Math.max(t,Math.min(e,n))}function Pe(n,t,e){return t+n*(e-t)}function $r(n,t,e){return Math.fround(t+Math.fround(n*Math.fround(e-t)))}function er(n,t,e,r,i,s){return Pe(t,Pe(n,e,r),Pe(n,i,s))}function Js(n,t,e,r,i,s,a,o,m,c,l){return Pe(e,er(n,t,r,i,s,a),er(n,t,o,m,c,l))}function Mn(n,t,e){return n===0?t():n===1?e():t()+n*(e()-t())}function Yr(n,t,e,r,i,s){return Mn(t,()=>Mn(n,e,r),()=>Mn(n,i,s))}function zs(n,t,e,r,i,s,a,o,m,c,l){return Mn(e,()=>Yr(n,t,r,i,s,a),()=>Yr(n,t,o,m,c,l))}function nr(n,t,e){return e<0?n:e>1?t:Pe(e,n,t)}function qr(n,t,e){return(n-t)/(e-t)}function rr(n){return n*n*n*(n*(n*6-15)+10)}function xn(n,t,e,r,i){return Pe(qr(n,t,e),r,i)}function Wr(n,t,e,r,i){return nr(r,i,qr(n,t,e))}function qt(n){return bt(Math.floor(n),cl,ll)}function Ds(n){return bt(Math.floor(n),ul,hl)}function Fs(n,t,e){let r=t-n;for(;r>0;){const i=Math.floor(r/2),s=n+i;if(e(s)){r=i;continue}n=s+1,r-=i+1}return n}function Xr(n,t,e){let r=BigInt(n*3129871)^BigInt(e)*BigInt(116129781)^BigInt(t);return r=r*r*BigInt(42317861)+r*BigInt(11),r>>BigInt(16)}function ir(n,t,e,r,i,s,a,o){return BigInt(n)<<BigInt(56)|BigInt(t)<<BigInt(48)|BigInt(e)<<BigInt(40)|BigInt(r)<<BigInt(32)|BigInt(i)<<BigInt(24)|BigInt(s)<<BigInt(16)|BigInt(a)<<BigInt(8)|BigInt(o)}function jr(n){return(n&n-1)===0}function Hs(n){return n-=1,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>18,n|=n>>32,n+1}function sr(n,t,e){return n.nextInt(e-t+1)+t}function ar(n,t,e){return t>=e?t:n.nextInt(e-t+1)+t}function Us(n,t){for(var e=n.length;e>1;e--){const r=t.nextInt(e),i=n[r];n[r]=n[e-1],n[e-1]=i}}u.MinMaxNumberFunction=void 0,(n=>{function t(e){return typeof e=="object"&&e!==null&&"minValue"in e&&"maxValue"in e}n.is=t})(u.MinMaxNumberFunction||(u.MinMaxNumberFunction={})),u.CubicSpline=void 0,(n=>{function t(i,s){var c,l,h,d;if(typeof i=="number")return new e(i);const a=(c=u.Json.readObject(i))!=null?c:{},o=new r(s(a.coordinate)),m=(l=u.Json.readArray(a.points,f=>{var p;return(p=u.Json.readObject(f))!=null?p:{}}))!=null?l:[];if(m.length===0)return new e(0);for(const f of m){const p=(h=u.Json.readNumber(f.location))!=null?h:0,v=t(f.value,s),g=(d=u.Json.readNumber(f.derivative))!=null?d:0;o.addPoint(p,v,g)}return o}n.fromJson=t;class e{constructor(s){this.value=s}compute(){return this.value}min(){return this.value}max(){return this.value}mapAll(){return this}calculateMinMax(){}}n.Constant=e;class r{constructor(s,a=[],o=[],m=[]){_(this,"calculatedMin",Number.NEGATIVE_INFINITY);_(this,"calculatedMax",Number.POSITIVE_INFINITY);this.coordinate=s,this.locations=a,this.values=o,this.derivatives=m}compute(s){const a=this.coordinate.compute(s),o=Fs(0,this.locations.length,E=>a<this.locations[E])-1,m=this.locations.length-1;if(o<0)return Math.fround(this.values[0].compute(s)+Math.fround(this.derivatives[0]*Math.fround(a-this.locations[0])));if(o===m)return Math.fround(this.values[m].compute(s)+Math.fround(this.derivatives[m]*Math.fround(a-this.locations[m])));const c=this.locations[o],l=this.locations[o+1],h=this.derivatives[o],d=this.derivatives[o+1],f=Math.fround(Math.fround(a-c)/Math.fround(l-c)),p=this.values[o].compute(s),v=this.values[o+1].compute(s),g=Math.fround(Math.fround(h*Math.fround(l-c))-Math.fround(v-p)),w=Math.fround(Math.fround(-d*Math.fround(l-c))+Math.fround(v-p));return Math.fround($r(f,p,v)+Math.fround(Math.fround(f*Math.fround(1-f))*$r(f,g,w)))}min(){return this.calculatedMin}max(){return this.calculatedMax}mapAll(s){return new r(s(this.coordinate),this.locations,this.values.map(a=>a.mapAll(s)),this.derivatives)}addPoint(s,a,o=0){return this.locations.push(Math.fround(s)),this.values.push(typeof a=="number"?new n.Constant(Math.fround(a)):a),this.derivatives.push(Math.fround(o)),this}calculateMinMax(){if(!u.MinMaxNumberFunction.is(this.coordinate))return;const s=this.locations.length-1;var a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;const m=this.coordinate.minValue(),c=this.coordinate.maxValue();for(const h of this.values)h.calculateMinMax();if(m<this.locations[0]){const h=r.linearExtend(m,this.locations,this.values[0].min(),this.derivatives,0),d=r.linearExtend(m,this.locations,this.values[0].max(),this.derivatives,0);a=Math.min(a,Math.min(h,d)),o=Math.max(o,Math.max(h,d))}if(c>this.locations[s]){const h=r.linearExtend(c,this.locations,this.values[s].min(),this.derivatives,s),d=r.linearExtend(c,this.locations,this.values[s].max(),this.derivatives,s);a=Math.min(a,Math.min(h,d)),o=Math.max(o,Math.max(h,d))}for(const h of this.values)a=Math.min(a,h.min()),o=Math.max(o,h.max());for(var l=0;l<s;++l){const h=this.locations[l],d=this.locations[l+1],f=Math.fround(d-h),p=this.values[l],v=this.values[l+1],g=p.min(),w=p.max(),S=v.min(),E=v.max(),y=this.derivatives[l],R=this.derivatives[l+1];if(y!==0||R!==0){const A=Math.fround(y*f),I=Math.fround(R*f),x=Math.min(g,S),C=Math.max(w,E),M=Math.fround(Math.fround(A-E)+g),N=Math.fround(Math.fround(A-S)+w),P=Math.fround(Math.fround(-I+S)-w),H=Math.fround(Math.fround(-I+E)-g),F=Math.min(M,P),T=Math.max(N,H);a=Math.min(a,Math.fround(x+Math.fround(.25*F))),o=Math.max(o,Math.fround(C+Math.fround(.25*T)))}}this.calculatedMin=a,this.calculatedMax=o}static linearExtend(s,a,o,m,c){const l=m[c];return l==0?o:Math.fround(o+Math.fround(l*Math.fround(s-a[c])))}}n.MultiPoint=r})(u.CubicSpline||(u.CubicSpline={}));var or=1e-6,ie=typeof Float32Array<"u"?Float32Array:Array,fl=Math.PI/180;function Kr(n){return n*fl}Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});function Qr(){var n=new ie(9);return ie!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function dl(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[4],n[4]=t[5],n[5]=t[6],n[6]=t[8],n[7]=t[9],n[8]=t[10],n}function ml(n){var t=new ie(9);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function gl(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function pl(n,t){if(n===t){var e=t[1],r=t[2],i=t[5];n[1]=t[3],n[2]=t[6],n[3]=e,n[5]=t[7],n[6]=r,n[7]=i}else n[0]=t[0],n[1]=t[3],n[2]=t[6],n[3]=t[1],n[4]=t[4],n[5]=t[7],n[6]=t[2],n[7]=t[5],n[8]=t[8];return n}function wl(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],m=t[6],c=t[7],l=t[8],h=l*a-o*c,d=-l*s+o*m,f=c*s-a*m,p=e*h+r*d+i*f;return p?(p=1/p,n[0]=h*p,n[1]=(-l*r+i*c)*p,n[2]=(o*r-i*a)*p,n[3]=d*p,n[4]=(l*e-i*m)*p,n[5]=(-o*e+i*s)*p,n[6]=f*p,n[7]=(-c*e+r*m)*p,n[8]=(a*e-r*s)*p,n):null}function vl(n,t,e){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],m=t[5],c=t[6],l=t[7],h=t[8],d=e[0],f=e[1],p=e[2],v=e[3],g=e[4],w=e[5],S=e[6],E=e[7],y=e[8];return n[0]=d*r+f*a+p*c,n[1]=d*i+f*o+p*l,n[2]=d*s+f*m+p*h,n[3]=v*r+g*a+w*c,n[4]=v*i+g*o+w*l,n[5]=v*s+g*m+w*h,n[6]=S*r+E*a+y*c,n[7]=S*i+E*o+y*l,n[8]=S*s+E*m+y*h,n}function _l(n,t,e){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],m=t[5],c=t[6],l=t[7],h=t[8],d=e[0],f=e[1];return n[0]=r,n[1]=i,n[2]=s,n[3]=a,n[4]=o,n[5]=m,n[6]=d*r+f*a+c,n[7]=d*i+f*o+l,n[8]=d*s+f*m+h,n}function bl(n,t,e){var r=e[0],i=e[1];return n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n[3]=i*t[3],n[4]=i*t[4],n[5]=i*t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function yl(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],a=e+e,o=r+r,m=i+i,c=e*a,l=r*a,h=r*o,d=i*a,f=i*o,p=i*m,v=s*a,g=s*o,w=s*m;return n[0]=1-h-p,n[3]=l-w,n[6]=d+g,n[1]=l+w,n[4]=1-c-p,n[7]=f-v,n[2]=d-g,n[5]=f+v,n[8]=1-c-h,n}function Sl(n){return"mat3("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+")"}function El(n,t,e){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n[4]=t[4]+e[4],n[5]=t[5]+e[5],n[6]=t[6]+e[6],n[7]=t[7]+e[7],n[8]=t[8]+e[8],n}function Il(n,t,e){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n[4]=t[4]-e[4],n[5]=t[5]-e[5],n[6]=t[6]-e[6],n[7]=t[7]-e[7],n[8]=t[8]-e[8],n}function kl(n,t,e){return n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n}var Al=vl,Ml=Il;function it(){var n=new ie(16);return ie!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function xl(n){var t=new ie(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function Rl(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Cl(n,t){if(n===t){var e=t[1],r=t[2],i=t[3],s=t[6],a=t[7],o=t[11];n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=e,n[6]=t[9],n[7]=t[13],n[8]=r,n[9]=s,n[11]=t[14],n[12]=i,n[13]=a,n[14]=o}else n[0]=t[0],n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=t[1],n[5]=t[5],n[6]=t[9],n[7]=t[13],n[8]=t[2],n[9]=t[6],n[10]=t[10],n[11]=t[14],n[12]=t[3],n[13]=t[7],n[14]=t[11],n[15]=t[15];return n}function Nl(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],a=t[4],o=t[5],m=t[6],c=t[7],l=t[8],h=t[9],d=t[10],f=t[11],p=t[12],v=t[13],g=t[14],w=t[15],S=e*o-r*a,E=e*m-i*a,y=e*c-s*a,R=r*m-i*o,A=r*c-s*o,I=i*c-s*m,x=l*v-h*p,C=l*g-d*p,M=l*w-f*p,N=h*g-d*v,P=h*w-f*v,H=d*w-f*g,F=S*H-E*P+y*N+R*M-A*C+I*x;return F?(F=1/F,n[0]=(o*H-m*P+c*N)*F,n[1]=(i*P-r*H-s*N)*F,n[2]=(v*I-g*A+w*R)*F,n[3]=(d*A-h*I-f*R)*F,n[4]=(m*M-a*H-c*C)*F,n[5]=(e*H-i*M+s*C)*F,n[6]=(g*y-p*I-w*E)*F,n[7]=(l*I-d*y+f*E)*F,n[8]=(a*P-o*M+c*x)*F,n[9]=(r*M-e*P-s*x)*F,n[10]=(p*A-v*y+w*S)*F,n[11]=(h*y-l*A-f*S)*F,n[12]=(o*C-a*N-m*x)*F,n[13]=(e*N-r*C+i*x)*F,n[14]=(v*E-p*R-g*S)*F,n[15]=(l*R-h*E+d*S)*F,n):null}function Bl(n,t,e){var r=t[0],i=t[1],s=t[2],a=t[3],o=t[4],m=t[5],c=t[6],l=t[7],h=t[8],d=t[9],f=t[10],p=t[11],v=t[12],g=t[13],w=t[14],S=t[15],E=e[0],y=e[1],R=e[2],A=e[3];return n[0]=E*r+y*o+R*h+A*v,n[1]=E*i+y*m+R*d+A*g,n[2]=E*s+y*c+R*f+A*w,n[3]=E*a+y*l+R*p+A*S,E=e[4],y=e[5],R=e[6],A=e[7],n[4]=E*r+y*o+R*h+A*v,n[5]=E*i+y*m+R*d+A*g,n[6]=E*s+y*c+R*f+A*w,n[7]=E*a+y*l+R*p+A*S,E=e[8],y=e[9],R=e[10],A=e[11],n[8]=E*r+y*o+R*h+A*v,n[9]=E*i+y*m+R*d+A*g,n[10]=E*s+y*c+R*f+A*w,n[11]=E*a+y*l+R*p+A*S,E=e[12],y=e[13],R=e[14],A=e[15],n[12]=E*r+y*o+R*h+A*v,n[13]=E*i+y*m+R*d+A*g,n[14]=E*s+y*c+R*f+A*w,n[15]=E*a+y*l+R*p+A*S,n}function q(n,t,e){var r=e[0],i=e[1],s=e[2],a,o,m,c,l,h,d,f,p,v,g,w;return t===n?(n[12]=t[0]*r+t[4]*i+t[8]*s+t[12],n[13]=t[1]*r+t[5]*i+t[9]*s+t[13],n[14]=t[2]*r+t[6]*i+t[10]*s+t[14],n[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(a=t[0],o=t[1],m=t[2],c=t[3],l=t[4],h=t[5],d=t[6],f=t[7],p=t[8],v=t[9],g=t[10],w=t[11],n[0]=a,n[1]=o,n[2]=m,n[3]=c,n[4]=l,n[5]=h,n[6]=d,n[7]=f,n[8]=p,n[9]=v,n[10]=g,n[11]=w,n[12]=a*r+l*i+p*s+t[12],n[13]=o*r+h*i+v*s+t[13],n[14]=m*r+d*i+g*s+t[14],n[15]=c*r+f*i+w*s+t[15]),n}function Ct(n,t,e){var r=e[0],i=e[1],s=e[2];return n[0]=t[0]*r,n[1]=t[1]*r,n[2]=t[2]*r,n[3]=t[3]*r,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[7]=t[7]*i,n[8]=t[8]*s,n[9]=t[9]*s,n[10]=t[10]*s,n[11]=t[11]*s,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Tl(n,t,e,r){var i=r[0],s=r[1],a=r[2],o=Math.hypot(i,s,a),m,c,l,h,d,f,p,v,g,w,S,E,y,R,A,I,x,C,M,N,P,H,F,T;return o<or?null:(o=1/o,i*=o,s*=o,a*=o,m=Math.sin(e),c=Math.cos(e),l=1-c,h=t[0],d=t[1],f=t[2],p=t[3],v=t[4],g=t[5],w=t[6],S=t[7],E=t[8],y=t[9],R=t[10],A=t[11],I=i*i*l+c,x=s*i*l+a*m,C=a*i*l-s*m,M=i*s*l-a*m,N=s*s*l+c,P=a*s*l+i*m,H=i*a*l+s*m,F=s*a*l-i*m,T=a*a*l+c,n[0]=h*I+v*x+E*C,n[1]=d*I+g*x+y*C,n[2]=f*I+w*x+R*C,n[3]=p*I+S*x+A*C,n[4]=h*M+v*N+E*P,n[5]=d*M+g*N+y*P,n[6]=f*M+w*N+R*P,n[7]=p*M+S*N+A*P,n[8]=h*H+v*F+E*T,n[9]=d*H+g*F+y*T,n[10]=f*H+w*F+R*T,n[11]=p*H+S*F+A*T,t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n)}function Rn(n,t,e){var r=Math.sin(e),i=Math.cos(e),s=t[4],a=t[5],o=t[6],m=t[7],c=t[8],l=t[9],h=t[10],d=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=s*i+c*r,n[5]=a*i+l*r,n[6]=o*i+h*r,n[7]=m*i+d*r,n[8]=c*i-s*r,n[9]=l*i-a*r,n[10]=h*i-o*r,n[11]=d*i-m*r,n}function wt(n,t,e){var r=Math.sin(e),i=Math.cos(e),s=t[0],a=t[1],o=t[2],m=t[3],c=t[8],l=t[9],h=t[10],d=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=s*i-c*r,n[1]=a*i-l*r,n[2]=o*i-h*r,n[3]=m*i-d*r,n[8]=s*r+c*i,n[9]=a*r+l*i,n[10]=o*r+h*i,n[11]=m*r+d*i,n}function Zs(n,t,e){var r=Math.sin(e),i=Math.cos(e),s=t[0],a=t[1],o=t[2],m=t[3],c=t[4],l=t[5],h=t[6],d=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=s*i+c*r,n[1]=a*i+l*r,n[2]=o*i+h*r,n[3]=m*i+d*r,n[4]=c*i-s*r,n[5]=l*i-a*r,n[6]=h*i-o*r,n[7]=d*i-m*r,n}function Ll(n,t){return n[0]=t[12],n[1]=t[13],n[2]=t[14],n}function Pl(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],a=e+e,o=r+r,m=i+i,c=e*a,l=r*a,h=r*o,d=i*a,f=i*o,p=i*m,v=s*a,g=s*o,w=s*m;return n[0]=1-h-p,n[1]=l+w,n[2]=d-g,n[3]=0,n[4]=l-w,n[5]=1-c-p,n[6]=f+v,n[7]=0,n[8]=d+g,n[9]=f-v,n[10]=1-c-h,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Ol(n,t,e,r,i){var s=1/Math.tan(t/2),a;return n[0]=s/e,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0?(a=1/(r-i),n[10]=(i+r)*a,n[14]=2*i*r*a):(n[10]=-1,n[14]=-2*r),n}function Jl(n,t,e,r,i,s,a){var o=1/(t-e),m=1/(r-i),c=1/(s-a);return n[0]=-2*o,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*m,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(t+e)*o,n[13]=(i+r)*m,n[14]=(a+s)*c,n[15]=1,n}function zl(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}function Dl(n,t,e){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n[4]=t[4]+e[4],n[5]=t[5]+e[5],n[6]=t[6]+e[6],n[7]=t[7]+e[7],n[8]=t[8]+e[8],n[9]=t[9]+e[9],n[10]=t[10]+e[10],n[11]=t[11]+e[11],n[12]=t[12]+e[12],n[13]=t[13]+e[13],n[14]=t[14]+e[14],n[15]=t[15]+e[15],n}function Fl(n,t,e){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n[4]=t[4]-e[4],n[5]=t[5]-e[5],n[6]=t[6]-e[6],n[7]=t[7]-e[7],n[8]=t[8]-e[8],n[9]=t[9]-e[9],n[10]=t[10]-e[10],n[11]=t[11]-e[11],n[12]=t[12]-e[12],n[13]=t[13]-e[13],n[14]=t[14]-e[14],n[15]=t[15]-e[15],n}function Hl(n,t,e){return n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n[9]=t[9]*e,n[10]=t[10]*e,n[11]=t[11]*e,n[12]=t[12]*e,n[13]=t[13]*e,n[14]=t[14]*e,n[15]=t[15]*e,n}var Ul=Bl,Zl=Fl;function ti(){var n=new ie(3);return ie!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Gl(n,t,e){var r=new ie(3);return r[0]=n,r[1]=t,r[2]=e,r}function Vl(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n}function $l(n,t,e){var r=t[0],i=t[1],s=t[2],a=e[3]*r+e[7]*i+e[11]*s+e[15];return a=a||1,n[0]=(e[0]*r+e[4]*i+e[8]*s+e[12])/a,n[1]=(e[1]*r+e[5]*i+e[9]*s+e[13])/a,n[2]=(e[2]*r+e[6]*i+e[10]*s+e[14])/a,n}function Yl(n,t){var e=n[0],r=n[1],i=n[2],s=t[0],a=t[1],o=t[2];return Math.abs(e-s)<=or*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(r-a)<=or*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-o)<=or*Math.max(1,Math.abs(i),Math.abs(o))}(function(){var n=ti();return function(t,e,r,i,s,a){var o,m;for(e||(e=3),r||(r=0),i?m=Math.min(i*e+r,t.length):m=t.length,o=r;o<m;o+=e)n[0]=t[o],n[1]=t[o+1],n[2]=t[o+2],s(n,n,a),t[o]=n[0],t[o+1]=n[1],t[o+2]=n[2];return t}})();class Cn{constructor(t){_(this,"data");this.data=t!=null?t:Qr()}static fromMatrix4(t){return new Cn(dl(Qr(),t.data))}static fromQuat(t){return new Cn(yl(Qr(),t))}clone(){return new Cn(ml(this.data))}copy(t){return gl(this.data,t.data),this}translate(t){return _l(this.data,this.data,Array.isArray(t)?t:[t.x,t.y]),this}scale(t){return typeof t=="number"?kl(this.data,this.data,t):bl(this.data,this.data,Array.isArray(t)?t:[t.x,t.y]),this}add(t){return El(this.data,this.data,t.data),this}sub(t){return Ml(this.data,this.data,t.data),this}mul(t){return Al(this.data,this.data,t.data),this}transpose(){return pl(this.data,this.data),this}invert(){return wl(this.data,this.data),this}get m00(){return this.data[0]}get m01(){return this.data[1]}get m02(){return this.data[2]}get m10(){return this.data[3]}get m11(){return this.data[4]}get m12(){return this.data[5]}get m20(){return this.data[6]}get m21(){return this.data[7]}get m22(){return this.data[8]}set m00(t){this.data[0]=t}set m01(t){this.data[1]=t}set m02(t){this.data[2]=t}set m10(t){this.data[3]=t}set m11(t){this.data[4]=t}set m12(t){this.data[5]=t}set m20(t){this.data[6]=t}set m21(t){this.data[7]=t}set m22(t){this.data[8]=t}toString(){return Sl(this.data)}}class ${constructor(t,e,r){this.x=t,this.y=e,this.z=r}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}distance(t){return this.sub(t).length()}distanceSquared(t){return this.sub(t).lengthSquared()}abs(){return new $(Math.abs(this.x),Math.abs(this.y),Math.abs(this.z))}add(t){return new $(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new $(this.x-t.x,this.y-t.y,this.z-t.z)}mul(t){return new $(this.x*t.x,this.y*t.y,this.z*t.z)}div(t){return new $(this.x/t.x,this.y/t.y,this.z/t.z)}scale(t){return new $(this.x*t,this.y*t,this.z*t)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){const e=this.y*t.z-this.z*t.y,r=this.z*t.x-this.x*t.z,i=this.x*t.y-this.y*t.x;return new $(e,r,i)}normalize(){if(this.x==0&&this.y==0&&this.z==0)return this;const t=1/this.length();return new $(this.x*t,this.y*t,this.z*t)}components(){return[this.x,this.y,this.z]}toString(){return`[${this.x} ${this.y} ${this.z}]`}}class cr{constructor(t){_(this,"data");this.data=t!=null?t:it()}static fromQuat(t){return new cr(Pl(it(),t))}clone(){return new cr(xl(this.data))}translate(t){return q(this.data,this.data,Array.isArray(t)?t:t.components()),this}scale(t){return typeof t=="number"?Hl(this.data,this.data,t):Ct(this.data,this.data,Array.isArray(t)?t:t.components()),this}add(t){return Dl(this.data,this.data,t.data),this}sub(t){return Zl(this.data,this.data,t.data),this}mul(t){return Ul(this.data,this.data,t.data),this}transpose(){return Cl(this.data,this.data),this}invert(){return Nl(this.data,this.data),this}affine(){return this.scale(1/this.m33)}get m00(){return this.data[0]}get m01(){return this.data[1]}get m02(){return this.data[2]}get m03(){return this.data[3]}get m10(){return this.data[4]}get m11(){return this.data[5]}get m12(){return this.data[6]}get m13(){return this.data[7]}get m20(){return this.data[8]}get m21(){return this.data[9]}get m22(){return this.data[10]}get m23(){return this.data[11]}get m30(){return this.data[12]}get m31(){return this.data[13]}get m32(){return this.data[14]}get m33(){return this.data[15]}set m00(t){this.data[0]=t}set m01(t){this.data[1]=t}set m02(t){this.data[2]=t}set m03(t){this.data[3]=t}set m10(t){this.data[4]=t}set m11(t){this.data[5]=t}set m12(t){this.data[6]=t}set m13(t){this.data[7]=t}set m20(t){this.data[8]=t}set m21(t){this.data[9]=t}set m22(t){this.data[10]=t}set m23(t){this.data[11]=t}set m30(t){this.data[12]=t}set m31(t){this.data[13]=t}set m32(t){this.data[14]=t}set m33(t){this.data[15]=t}getTranslation(){const[t,e,r]=Ll(ti(),this.data);return new $(t,e,r)}toString(){return zl(this.data)}}var ei={exports:{}},Gs={exports:{}};(function(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(e,r){return e<<r|e>>>32-r},rotr:function(e,r){return e<<32-r|e>>>r},endian:function(e){if(e.constructor==Number)return t.rotl(e,8)&16711935|t.rotl(e,24)&4278255360;for(var r=0;r<e.length;r++)e[r]=t.endian(e[r]);return e},randomBytes:function(e){for(var r=[];e>0;e--)r.push(Math.floor(Math.random()*256));return r},bytesToWords:function(e){for(var r=[],i=0,s=0;i<e.length;i++,s+=8)r[s>>>5]|=e[i]<<24-s%32;return r},wordsToBytes:function(e){for(var r=[],i=0;i<e.length*32;i+=8)r.push(e[i>>>5]>>>24-i%32&255);return r},bytesToHex:function(e){for(var r=[],i=0;i<e.length;i++)r.push((e[i]>>>4).toString(16)),r.push((e[i]&15).toString(16));return r.join("")},hexToBytes:function(e){for(var r=[],i=0;i<e.length;i+=2)r.push(parseInt(e.substr(i,2),16));return r},bytesToBase64:function(e){for(var r=[],i=0;i<e.length;i+=3)for(var s=e[i]<<16|e[i+1]<<8|e[i+2],a=0;a<4;a++)i*8+a*6<=e.length*8?r.push(n.charAt(s>>>6*(3-a)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/ig,"");for(var r=[],i=0,s=0;i<e.length;s=++i%4)s!=0&&r.push((n.indexOf(e.charAt(i-1))&Math.pow(2,-2*s+8)-1)<<s*2|n.indexOf(e.charAt(i))>>>6-s*2);return r}};Gs.exports=t})();var ni={utf8:{stringToBytes:function(n){return ni.bin.stringToBytes(unescape(encodeURIComponent(n)))},bytesToString:function(n){return decodeURIComponent(escape(ni.bin.bytesToString(n)))}},bin:{stringToBytes:function(n){for(var t=[],e=0;e<n.length;e++)t.push(n.charCodeAt(e)&255);return t},bytesToString:function(n){for(var t=[],e=0;e<n.length;e++)t.push(String.fromCharCode(n[e]));return t.join("")}}},Vs=ni;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var ql=function(n){return n!=null&&($s(n)||Wl(n)||!!n._isBuffer)};function $s(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function Wl(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&$s(n.slice(0,0))}(function(){var n=Gs.exports,t=Vs.utf8,e=ql,r=Vs.bin,i=function(s,a){s.constructor==String?a&&a.encoding==="binary"?s=r.stringToBytes(s):s=t.stringToBytes(s):e(s)?s=Array.prototype.slice.call(s,0):!Array.isArray(s)&&s.constructor!==Uint8Array&&(s=s.toString());for(var o=n.bytesToWords(s),m=s.length*8,c=1732584193,l=-271733879,h=-1732584194,d=271733878,f=0;f<o.length;f++)o[f]=(o[f]<<8|o[f]>>>24)&16711935|(o[f]<<24|o[f]>>>8)&4278255360;o[m>>>5]|=128<<m%32,o[(m+64>>>9<<4)+14]=m;for(var p=i._ff,v=i._gg,g=i._hh,w=i._ii,f=0;f<o.length;f+=16){var S=c,E=l,y=h,R=d;c=p(c,l,h,d,o[f+0],7,-680876936),d=p(d,c,l,h,o[f+1],12,-389564586),h=p(h,d,c,l,o[f+2],17,606105819),l=p(l,h,d,c,o[f+3],22,-1044525330),c=p(c,l,h,d,o[f+4],7,-176418897),d=p(d,c,l,h,o[f+5],12,1200080426),h=p(h,d,c,l,o[f+6],17,-1473231341),l=p(l,h,d,c,o[f+7],22,-45705983),c=p(c,l,h,d,o[f+8],7,1770035416),d=p(d,c,l,h,o[f+9],12,-1958414417),h=p(h,d,c,l,o[f+10],17,-42063),l=p(l,h,d,c,o[f+11],22,-1990404162),c=p(c,l,h,d,o[f+12],7,1804603682),d=p(d,c,l,h,o[f+13],12,-40341101),h=p(h,d,c,l,o[f+14],17,-1502002290),l=p(l,h,d,c,o[f+15],22,1236535329),c=v(c,l,h,d,o[f+1],5,-165796510),d=v(d,c,l,h,o[f+6],9,-1069501632),h=v(h,d,c,l,o[f+11],14,643717713),l=v(l,h,d,c,o[f+0],20,-373897302),c=v(c,l,h,d,o[f+5],5,-701558691),d=v(d,c,l,h,o[f+10],9,38016083),h=v(h,d,c,l,o[f+15],14,-660478335),l=v(l,h,d,c,o[f+4],20,-405537848),c=v(c,l,h,d,o[f+9],5,568446438),d=v(d,c,l,h,o[f+14],9,-1019803690),h=v(h,d,c,l,o[f+3],14,-187363961),l=v(l,h,d,c,o[f+8],20,1163531501),c=v(c,l,h,d,o[f+13],5,-1444681467),d=v(d,c,l,h,o[f+2],9,-51403784),h=v(h,d,c,l,o[f+7],14,1735328473),l=v(l,h,d,c,o[f+12],20,-1926607734),c=g(c,l,h,d,o[f+5],4,-378558),d=g(d,c,l,h,o[f+8],11,-2022574463),h=g(h,d,c,l,o[f+11],16,1839030562),l=g(l,h,d,c,o[f+14],23,-35309556),c=g(c,l,h,d,o[f+1],4,-1530992060),d=g(d,c,l,h,o[f+4],11,1272893353),h=g(h,d,c,l,o[f+7],16,-155497632),l=g(l,h,d,c,o[f+10],23,-1094730640),c=g(c,l,h,d,o[f+13],4,681279174),d=g(d,c,l,h,o[f+0],11,-358537222),h=g(h,d,c,l,o[f+3],16,-722521979),l=g(l,h,d,c,o[f+6],23,76029189),c=g(c,l,h,d,o[f+9],4,-640364487),d=g(d,c,l,h,o[f+12],11,-421815835),h=g(h,d,c,l,o[f+15],16,530742520),l=g(l,h,d,c,o[f+2],23,-995338651),c=w(c,l,h,d,o[f+0],6,-198630844),d=w(d,c,l,h,o[f+7],10,1126891415),h=w(h,d,c,l,o[f+14],15,-1416354905),l=w(l,h,d,c,o[f+5],21,-57434055),c=w(c,l,h,d,o[f+12],6,1700485571),d=w(d,c,l,h,o[f+3],10,-1894986606),h=w(h,d,c,l,o[f+10],15,-1051523),l=w(l,h,d,c,o[f+1],21,-2054922799),c=w(c,l,h,d,o[f+8],6,1873313359),d=w(d,c,l,h,o[f+15],10,-30611744),h=w(h,d,c,l,o[f+6],15,-1560198380),l=w(l,h,d,c,o[f+13],21,1309151649),c=w(c,l,h,d,o[f+4],6,-145523070),d=w(d,c,l,h,o[f+11],10,-1120210379),h=w(h,d,c,l,o[f+2],15,718787259),l=w(l,h,d,c,o[f+9],21,-343485551),c=c+S>>>0,l=l+E>>>0,h=h+y>>>0,d=d+R>>>0}return n.endian([c,l,h,d])};i._ff=function(s,a,o,m,c,l,h){var d=s+(a&o|~a&m)+(c>>>0)+h;return(d<<l|d>>>32-l)+a},i._gg=function(s,a,o,m,c,l,h){var d=s+(a&m|o&~m)+(c>>>0)+h;return(d<<l|d>>>32-l)+a},i._hh=function(s,a,o,m,c,l,h){var d=s+(a^o^m)+(c>>>0)+h;return(d<<l|d>>>32-l)+a},i._ii=function(s,a,o,m,c,l,h){var d=s+(o^(a|~m))+(c>>>0)+h;return(d<<l|d>>>32-l)+a},i._blocksize=16,i._digestsize=16,ei.exports=function(s,a){if(s==null)throw new Error("Illegal argument "+s);var o=n.wordsToBytes(i(s,a));return a&&a.asBytes?o:a&&a.asString?r.bytesToString(o):n.bytesToHex(o)}})();const Nt=class{constructor(t){_(this,"seed",BigInt(0));this.setSeed(t)}static fromLargeFeatureSeed(t,e,r){const i=new Nt(t),s=i.nextLong(),a=i.nextLong(),o=BigInt(e)*s^BigInt(r)*a^t;return i.setSeed(o),i}static fromLargeFeatureWithSalt(t,e,r,i){const s=BigInt(e)*BigInt("341873128712")+BigInt(r)*BigInt("132897987541")+t+BigInt(i);return new Nt(s)}fork(){return new Nt(this.nextLong())}forkPositional(){return new Ys(this.nextLong())}setSeed(t){this.seed=(t^Nt.MULTIPLIER)&Nt.MODULUS_MASK}advance(){this.seed=this.seed*Nt.MULTIPLIER+Nt.INCREMENT&Nt.MODULUS_MASK}consume(t){for(let e=0;e<t;e+=1)this.advance()}next(t){this.advance();const e=Number(this.seed>>BigInt(Nt.MODULUS_BITS-t));return e>2147483647?e-4294967296:e}nextInt(t){if(t===void 0)return this.next(32);if((t&t-1)==0)return Number(BigInt(t)*BigInt(this.next(31))>>BigInt(31));let e,r;for(;(e=this.next(31))-(r=e%t)+(t-1)<0;);return r}nextLong(){return(BigInt(this.next(32))<<BigInt(32))+BigInt(this.next(32))}nextFloat(){return this.next(24)*Nt.FLOAT_MULTIPLIER}nextDouble(){const t=this.next(30);return this.advance(),t*Nt.DOUBLE_MULTIPLIER}};let ot=Nt;_(ot,"MODULUS_BITS",48),_(ot,"MODULUS_MASK",BigInt("281474976710655")),_(ot,"MULTIPLIER",BigInt("25214903917")),_(ot,"INCREMENT",BigInt("11")),_(ot,"FLOAT_MULTIPLIER",1/Math.pow(2,24)),_(ot,"DOUBLE_MULTIPLIER",1/Math.pow(2,30));class Ys{constructor(t){this.seed=t}at(t,e,r){const i=Xr(t,e,r);return new ot(i^this.seed)}fromHashOf(t){const e=ei.exports(t,{asBytes:!0}),r=ir(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);return new ot(r^this.seed)}seedKey(){return[this.seed,BigInt(0)]}}const V=class{constructor(t){_(this,"seed",[BigInt(0),BigInt(0)]);this.seed=t}static create(t){return new V(V.upgradeSeedTo128bit(t))}static mixStafford13(t){return t=(t^t>>V.BIGINT_30)*V.STAFFORD_1&V.MAX_ULONG,t=(t^t>>V.BIGINT_27)*V.STAFFORD_2&V.MAX_ULONG,(t^t>>V.BIGINT_31)&V.MAX_ULONG}static upgradeSeedTo128bit(t){t<0&&(t+=V.POW2_60);const e=t^V.SILVER_RATIO_64,r=e+V.GOLDEN_RATIO_64&V.MAX_ULONG;return[V.mixStafford13(e),V.mixStafford13(r)]}static rotateLeft(t,e){return t<<e&V.MAX_ULONG|t>>V.BIGINT_64-e}setSeed(t){this.seed=V.upgradeSeedTo128bit(t)}fork(){return new V([this.next(),this.next()])}forkPositional(){return new qs(this.next(),this.next())}next(){const t=this.seed[0];let e=this.seed[1];const r=V.rotateLeft(t+e&V.MAX_ULONG,V.BIGINT_17)+t&V.MAX_ULONG;return e^=t,this.seed=[V.rotateLeft(t,V.BIGINT_49)^e^e<<V.BIGINT_21&V.MAX_ULONG,V.rotateLeft(e,V.BIGINT_28)],r}nextLong(){let t=this.next();return t>V.POW2_63&&(t-=V.POW2_60),t}consume(t){let e=this.seed[0],r=this.seed[1];for(let i=0;i<t;i+=1)r^=e,e=V.rotateLeft(e,V.BIGINT_49)^r^r<<V.BIGINT_21,r=V.rotateLeft(r,V.BIGINT_28);this.seed=[e,r]}nextBits(t){return this.next()>>BigInt(64-t)}nextInt(t){let e=this.next()&V.MAX_UINT;if(t){const r=BigInt(t);let i=e*r,s=i&V.MAX_UINT;if(s<r){const o=((~r&V.MAX_UINT)+V.BIGINT_1)%r;for(;s<o;)e=this.next()&V.MAX_UINT,i=e*r,s=i&V.MAX_UINT}const a=i>>V.BIGINT_32;return Number(a)}else{let r=Number(e);return r>=2147483648&&(r-=4294967296),r}}nextFloat(){return Number(this.nextBits(24))*V.FLOAT_MULTIPLIER}nextDouble(){return Number(this.nextBits(53))*V.DOUBLE_MULTIPLIER}parityConfigString(){return"seedLo: "+this.seed[0]+", seedHi: "+this.seed[1]}};let st=V;_(st,"SILVER_RATIO_64",BigInt("7640891576956012809")),_(st,"GOLDEN_RATIO_64",BigInt("-7046029254386353131")),_(st,"FLOAT_MULTIPLIER",1/Math.pow(2,24)),_(st,"DOUBLE_MULTIPLIER",11102230246251565e-32),_(st,"BIGINT_1",BigInt(1)),_(st,"BIGINT_17",BigInt(17)),_(st,"BIGINT_21",BigInt(21)),_(st,"BIGINT_27",BigInt(27)),_(st,"BIGINT_28",BigInt(28)),_(st,"BIGINT_30",BigInt(30)),_(st,"BIGINT_31",BigInt(31)),_(st,"BIGINT_32",BigInt(32)),_(st,"BIGINT_49",BigInt(49)),_(st,"BIGINT_64",BigInt(64)),_(st,"STAFFORD_1",BigInt("-4658895280553007687")),_(st,"STAFFORD_2",BigInt("-7723592293110705685")),_(st,"MAX_ULONG",BigInt("0xFFFFFFFFFFFFFFFF")),_(st,"POW2_60",BigInt("0x10000000000000000")),_(st,"POW2_63",BigInt("0x8000000000000000")),_(st,"MAX_UINT",BigInt(4294967295));class qs{constructor(t,e){this.seedLo=t,this.seedHi=e}at(t,e,r){const s=Xr(t,e,r)^this.seedLo;return new st([s,this.seedHi])}fromHashOf(t){const e=ei.exports(t,{asBytes:!0}),r=ir(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]),i=ir(e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]);return new st([r^this.seedLo,i^this.seedHi])}seedKey(){return[this.seedLo,this.seedHi]}}const Xt=class{constructor(t){_(this,"p");_(this,"xo");_(this,"yo");_(this,"zo");this.xo=t.nextDouble()*256,this.yo=t.nextDouble()*256,this.zo=t.nextDouble()*256,this.p=Array(256);for(let e=0;e<256;e+=1)this.p[e]=e;for(let e=0;e<256;e+=1){const r=t.nextInt(256-e),i=this.p[e];this.p[e]=this.p[e+r],this.p[e+r]=i}}sample2D(t,e){const r=(t+e)*Xt.F2,i=qt(t+r),s=qt(e+r),a=(i+s)*Xt.G2,o=i-a,m=t-o;let c,l;const h=e-(s-a);m>h?(c=1,l=0):(c=0,l=1);const d=m-c+Xt.G2,f=h-l+Xt.G2,p=m-1+2*Xt.G2,v=h-1+2*Xt.G2,g=i&255,w=s&255,S=this.P(g+this.P(w))%12,E=this.P(g+c+this.P(w+l))%12,y=this.P(g+1+this.P(w+1))%12,R=this.getCornerNoise3D(S,m,h,0,.5),A=this.getCornerNoise3D(E,d,f,0,.5),I=this.getCornerNoise3D(y,p,v,0,.5);return 70*(R+A+I)}sample(t,e,r){const i=(t+e+r)*.3333333333333333,s=qt(t+i),a=qt(e+i),o=qt(r+i),m=(s+a+o)*.16666666666666666,c=t-(s-m),l=e-(a-m),h=r-(o-m);let d,f,p,v,g,w;c>=l?l>=h?(d=1,f=0,p=0,v=1,g=1,w=0):c>=h?(d=1,f=0,p=0,v=1,g=0,w=1):(d=0,f=0,p=1,v=1,g=0,w=1):l<h?(d=0,f=0,p=1,v=0,g=1,w=1):c<h?(d=0,f=1,p=0,v=0,g=1,w=1):(d=0,f=1,p=0,v=1,g=1,w=0);const S=c-d+.16666666666666666,E=l-f+.16666666666666666,y=h-p+.16666666666666666,R=c-v+.3333333333333333,A=l-g+.3333333333333333,I=h-w+.3333333333333333,x=c-.5,C=l-.5,M=h-.5,N=s&255,P=a&255,H=o&255,F=this.P(N+this.P(P+this.P(H)))%12,T=this.P(N+d+this.P(P+f+this.P(H+p)))%12,J=this.P(N+v+this.P(P+g+this.P(H+w)))%12,U=this.P(N+1+this.P(P+1+this.P(H+1)))%12,W=this.getCornerNoise3D(F,c,l,h,.6),j=this.getCornerNoise3D(T,S,E,y,.6),et=this.getCornerNoise3D(J,R,A,I,.6),k=this.getCornerNoise3D(U,x,C,M,.6);return 32*(W+j+et+k)}P(t){return this.p[t&255]}getCornerNoise3D(t,e,r,i,s){let a,o=s-e*e-r*r-i*i;return o<0?a=0:(o*=o,a=o*o*Xt.gradDot(t,e,r,i)),a}static gradDot(t,e,r,i){const s=Xt.GRADIENT[t&15];return s[0]*e+s[1]*r+s[2]*i}};let pt=Xt;_(pt,"GRADIENT",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1],[1,1,0],[0,-1,1],[-1,1,0],[0,-1,-1]]),_(pt,"F2",.5*(Math.sqrt(3)-1)),_(pt,"G2",(3-Math.sqrt(3))/6);class ri{constructor(t){_(this,"p");_(this,"xo");_(this,"yo");_(this,"zo");this.xo=t.nextDouble()*256,this.yo=t.nextDouble()*256,this.zo=t.nextDouble()*256,this.p=Array(256);for(let e=0;e<256;e+=1)this.p[e]=e>127?e-256:e;for(let e=0;e<256;e+=1){const r=t.nextInt(256-e),i=this.p[e];this.p[e]=this.p[e+r],this.p[e+r]=i}}sample(t,e,r,i=0,s=0){const a=t+this.xo,o=e+this.yo,m=r+this.zo,c=qt(a),l=qt(o),h=qt(m),d=a-c,f=o-l,p=m-h;let v=0;if(i!==0){const g=s>=0&&s<f?s:f;v=qt(g/i+1e-7)*i}return this.sampleAndLerp(c,l,h,d,f-v,p,f)}sampleAndLerp(t,e,r,i,s,a,o){const m=this.P(t),c=this.P(t+1),l=this.P(m+e),h=this.P(m+e+1),d=this.P(c+e),f=this.P(c+e+1),p=pt.gradDot(this.P(l+r),i,s,a),v=pt.gradDot(this.P(d+r),i-1,s,a),g=pt.gradDot(this.P(h+r),i,s-1,a),w=pt.gradDot(this.P(f+r),i-1,s-1,a),S=pt.gradDot(this.P(l+r+1),i,s,a-1),E=pt.gradDot(this.P(d+r+1),i-1,s,a-1),y=pt.gradDot(this.P(h+r+1),i,s-1,a-1),R=pt.gradDot(this.P(f+r+1),i-1,s-1,a-1),A=rr(i),I=rr(o),x=rr(a);return Js(A,I,x,p,v,g,w,S,E,y,R)}P(t){return this.p[t&255]&255}}class vt{constructor(t,e,r,i=!1){_(this,"noiseLevels");_(this,"amplitudes");_(this,"lowestFreqInputFactor");_(this,"lowestFreqValueFactor");_(this,"maxValue");if(t instanceof st&&!i){const s=t.forkPositional();this.noiseLevels=Array(r.length);for(let a=0;a<r.length;a++)if(r[a]!==0){const o=e+a;this.noiseLevels[a]=new ri(s.fromHashOf("octave_"+o))}}else{if(1-e<r.length)throw new Error("Positive octaves are not allowed when using LegacyRandom");this.noiseLevels=Array(r.length);for(let s=-e;s>=0;s-=1)s<r.length&&r[s]!==0?this.noiseLevels[s]=new ri(t):t.consume(262)}this.amplitudes=r,this.lowestFreqInputFactor=Math.pow(2,e),this.lowestFreqValueFactor=Math.pow(2,r.length-1)/(Math.pow(2,r.length)-1),this.maxValue=this.edgeValue(2)}sample(t,e,r,i=0,s=0,a=!1){let o=0,m=this.lowestFreqInputFactor,c=this.lowestFreqValueFactor;for(let l=0;l<this.noiseLevels.length;l+=1){const h=this.noiseLevels[l];h&&(o+=this.amplitudes[l]*c*h.sample(vt.wrap(t*m),a?-h.yo:vt.wrap(e*m),vt.wrap(r*m),i*m,s*m)),m*=2,c/=2}return o}getOctaveNoise(t){return this.noiseLevels[this.noiseLevels.length-1-t]}edgeValue(t){let e=0,r=this.lowestFreqValueFactor;for(let i=0;i<this.noiseLevels.length;i+=1)this.noiseLevels[i]&&(e+=this.amplitudes[i]*t*r),r/=2;return e}static wrap(t){return t-Ds(t/33554432+.5)*33554432}}class Ws{constructor(t,e,r,i,s,a){_(this,"minLimitNoise");_(this,"maxLimitNoise");_(this,"mainNoise");_(this,"xzMultiplier");_(this,"yMultiplier");_(this,"maxValue");this.xzScale=e,this.yScale=r,this.xzFactor=i,this.yFactor=s,this.smearScaleMultiplier=a,this.minLimitNoise=new vt(t,-15,[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],!0),this.maxLimitNoise=new vt(t,-15,[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],!0),this.mainNoise=new vt(t,-7,[1,1,1,1,1,1,1,1],!0),this.xzMultiplier=684.412*e,this.yMultiplier=684.412*r,this.maxValue=this.minLimitNoise.edgeValue(this.yMultiplier+2)}sample(t,e,r){const i=t*this.xzMultiplier,s=e*this.yMultiplier,a=r*this.xzMultiplier,o=i/this.xzFactor,m=s/this.yFactor,c=a/this.xzFactor,l=this.yMultiplier*this.smearScaleMultiplier,h=l/this.yFactor;let d,f=0,p=1;for(let w=0;w<8;w+=1){if(d=this.mainNoise.getOctaveNoise(w),d){const S=vt.wrap(o*p),E=vt.wrap(m*p),y=vt.wrap(c*p);f+=d.sample(S,E,y,h*p,m*p)/p}p/=2}f=(f/10+1)/2,p=1;let v=0,g=0;for(let w=0;w<16;w+=1){const S=vt.wrap(i*p),E=vt.wrap(s*p),y=vt.wrap(a*p),R=l*p;f<1&&(d=this.minLimitNoise.getOctaveNoise(w))&&(v+=d.sample(S,E,y,R,s*p)/p),f>0&&(d=this.maxLimitNoise.getOctaveNoise(w))&&(g+=d.sample(S,E,y,R,s*p)/p),p/=2}return nr(v/512,g/512,f)/128}}const Pn=class{constructor(t,{firstOctave:e,amplitudes:r}){_(this,"valueFactor");_(this,"first");_(this,"second");_(this,"maxValue");this.first=new vt(t,e,r),this.second=new vt(t,e,r);let i=1/0,s=-1/0;for(let o=0;o<r.length;o+=1)r[o]!==0&&(i=Math.min(i,o),s=Math.max(s,o));const a=.1*(1+1/(s-i+1));this.valueFactor=1/6/a,this.maxValue=(this.first.maxValue+this.second.maxValue)*this.valueFactor}sample(t,e,r){const i=t*Pn.INPUT_FACTOR,s=e*Pn.INPUT_FACTOR,a=r*Pn.INPUT_FACTOR;return(this.first.sample(t,e,r)+this.second.sample(i,s,a))*this.valueFactor}};let se=Pn;_(se,"INPUT_FACTOR",1.0181268882175227),u.NoiseParameters=void 0,(n=>{function t(r,i){return{firstOctave:r,amplitudes:i}}n.create=t;function e(r){var s,a,o;const i=(s=u.Json.readObject(r))!=null?s:{};return{firstOctave:(a=u.Json.readInt(i.firstOctave))!=null?a:0,amplitudes:(o=u.Json.readArray(i.amplitudes,m=>{var c;return(c=u.Json.readNumber(m))!=null?c:0}))!=null?o:[]}}n.fromJson=e})(u.NoiseParameters||(u.NoiseParameters={}));class Xl{constructor(t,e){_(this,"noiseLevels");_(this,"highestFreqInputFactor");_(this,"highestFreqValueFactor");const r=e[e.length-1],s=-e[0]+r+1,a=new Set(e),o=new pt(t);this.noiseLevels=Array(s),r>=0&&r<s&&a.has(0)&&(this.noiseLevels[r]=o);for(let m=r+1;m<s;m+=1)m>=0&&a.has(r-m)?this.noiseLevels[m]=new pt(t):t.consume(262);if(r>0)throw new Error("Positive octaves are not allowed");this.highestFreqInputFactor=Math.pow(2,r),this.highestFreqValueFactor=1/(Math.pow(2,s)-1)}sample(t,e,r){let i=0,s=this.highestFreqInputFactor,a=this.highestFreqValueFactor;for(let o=0;o<this.noiseLevels.length;o+=1){const m=this.noiseLevels[o];m&&(i+=a*m.sample2D(t*s+(r?m.xo:0),e*s+(r?m.yo:0))),s/=2,a*=2}return i}}const Ft=[124/255,189/255,107/255],jl=u.Color.intToRgb(6396257),Kl=u.Color.intToRgb(8431445),Xe=u.Color.intToRgb(4764952),lr=u.Color.intToRgb(4159204),Ql=u.Color.intToRgb(2129968),tu=n=>{const t=n/15,e=t*.6+(t>0?.4:.3),r=bt(t*t*.7-.5,0,1),i=bt(t*t*.6-.7,0,1);return[e,r,i]},ur=n=>[n/8,1-n/32,n/64],Oe={large_fern:()=>Ft,tall_grass:()=>Ft,grass_block:()=>Ft,fern:()=>Ft,grass:()=>Ft,short_grass:()=>Ft,potted_fern:()=>Ft,pink_petals:()=>Ft,wildflowers:()=>Ft,bush:()=>Ft,spruce_leaves:()=>jl,birch_leaves:()=>Kl,oak_leaves:()=>Xe,jungle_leaves:()=>Xe,acacia_leaves:()=>Xe,dark_oak_leaves:()=>Xe,vine:()=>Xe,mangrove_leaves:()=>Xe,water:()=>lr,bubble_column:()=>lr,cauldron:()=>lr,water_cauldron:()=>lr,redstone_wire:n=>{var t;return tu(parseInt((t=n.power)!=null?t:"0"))},sugar_cane:()=>Ft,attached_melon_stem:()=>ur(7),attached_pumpkin_stem:()=>ur(7),melon_stem:n=>{var t;return ur(parseInt((t=n.age)!=null?t:"0"))},pumpkin_stem:n=>{var t;return ur(parseInt((t=n.age)!=null?t:"0"))},lily_pad:()=>Ql};u.Cull=void 0,(n=>{function t(r,i,s){let{up:a,down:o,north:m,east:c,south:l,west:h}=r;switch(s){case 90:[m,c,l,h]=[c,l,h,m];break;case 180:[m,c,l,h]=[l,h,m,c];break;case 270:[m,c,l,h]=[h,m,c,l]}switch(i){case 90:[a,m,o,l]=[m,o,l,a];break;case 180:[a,m,o,l]=[o,l,a,m];break;case 270:[a,m,o,l]=[l,a,m,o]}return{up:a,down:o,north:m,east:c,south:l,west:h}}n.rotate=t;function e(){return Object.create(null)}n.none=e})(u.Cull||(u.Cull={}));const Ut=class{constructor(t,e,r,i,s,a){this.pos=t,this.color=e,this.texture=r,this.textureLimit=i,this.normal=s,this.blockPos=a}transform(t){return Ut.VEC[0]=this.pos.x,Ut.VEC[1]=this.pos.y,Ut.VEC[2]=this.pos.z,$l(Ut.VEC,Ut.VEC,t),this.pos=new $(Ut.VEC[0],Ut.VEC[1],Ut.VEC[2]),this}static fromPos(t){return new Ut(t,[0,0,0],[0,0],[0,0,0,0],void 0,void 0)}};let Pt=Ut;_(Pt,"VEC",ti());class hr{constructor(t,e){this.v1=t,this.v2=e}vertices(){return[this.v1,this.v2]}forEach(t){return t(this.v1),t(this.v2),this}transform(t){return this.forEach(e=>e.transform(t)),this}setColor(t){return this.forEach(e=>e.color=t),this}toString(){return`Line(${this.v1.pos.toString()}, ${this.v2.pos.toString()})`}static fromPoints(t,e){return new hr(Pt.fromPos(t),Pt.fromPos(e))}}class rt{constructor(t=[],e=[]){_(this,"posBuffer");_(this,"colorBuffer");_(this,"textureBuffer");_(this,"textureLimitBuffer");_(this,"normalBuffer");_(this,"blockPosBuffer");_(this,"indexBuffer");_(this,"linePosBuffer");_(this,"lineColorBuffer");this.quads=t,this.lines=e}clear(){return this.quads=[],this.lines=[],this}isEmpty(){return this.quads.length===0&&this.lines.length===0}quadVertices(){return this.quads.length*4}quadIndices(){return this.quads.length*6}lineVertices(){return this.lines.length*2}merge(t){return this.quads=this.quads.concat(t.quads),this.lines=this.lines.concat(t.lines),this}addLine(t,e,r,i,s,a,o){const m=new hr(Pt.fromPos(new $(t,e,r)),Pt.fromPos(new $(i,s,a))).setColor(o);return this.lines.push(m),this}addLineCube(t,e,r,i,s,a,o){return this.addLine(t,e,r,t,e,a,o),this.addLine(i,e,r,i,e,a,o),this.addLine(t,e,r,i,e,r,o),this.addLine(t,e,a,i,e,a,o),this.addLine(t,e,r,t,s,r,o),this.addLine(i,e,r,i,s,r,o),this.addLine(t,e,a,t,s,a,o),this.addLine(i,e,a,i,s,a,o),this.addLine(t,s,r,t,s,a,o),this.addLine(i,s,r,i,s,a,o),this.addLine(t,s,r,i,s,r,o),this.addLine(t,s,a,i,s,a,o),this}transform(t){for(const e of this.quads)e.transform(t);return this}computeNormals(){for(const t of this.quads){const e=t.normal();t.forEach(r=>r.normal=e)}}rebuild(t,e){const r=(s,a,o)=>{var m;if(s||(s=(m=t.createBuffer())!=null?m:void 0),!s)throw new Error("Cannot create new buffer");return t.bindBuffer(a,s),t.bufferData(a,o,t.DYNAMIC_DRAW),s},i=(s,a,o)=>{if(s.length===0){a&&t.deleteBuffer(a);return}const m=s.flatMap(c=>c.vertices().flatMap(l=>{const h=o(l);if(!h)throw new Error("Missing vertex component");return h}));return r(a,t.ARRAY_BUFFER,new Float32Array(m))};return e.pos&&(this.posBuffer=i(this.quads,this.posBuffer,s=>s.pos.components()),this.linePosBuffer=i(this.lines,this.linePosBuffer,s=>s.pos.components())),e.color&&(this.colorBuffer=i(this.quads,this.colorBuffer,s=>s.color),this.lineColorBuffer=i(this.lines,this.lineColorBuffer,s=>s.color)),e.texture&&(this.textureBuffer=i(this.quads,this.textureBuffer,s=>s.texture),this.textureLimitBuffer=i(this.quads,this.textureLimitBuffer,s=>s.textureLimit)),e.normal&&(this.normalBuffer=i(this.quads,this.normalBuffer,s=>{var a;return(a=s.normal)==null?void 0:a.components()})),e.blockPos&&(this.blockPosBuffer=i(this.quads,this.blockPosBuffer,s=>{var a;return(a=s.blockPos)==null?void 0:a.components()})),this.quads.length===0?(this.indexBuffer&&t.deleteBuffer(this.indexBuffer),this.indexBuffer=void 0):this.indexBuffer=r(this.indexBuffer,t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.quads.flatMap((s,a)=>[4*a,4*a+1,4*a+2,a*4,4*a+2,4*a+3],!0))),this}}class ii{constructor(t,e){this.variants=t,this.multipart=e}getModelVariants(t){if(this.variants){const e=Object.keys(this.variants).filter(i=>this.matchesVariant(i,t));if(e.length===0)return[];const r=this.variants[e[0]];return[Array.isArray(r)?r[0]:r]}else if(this.multipart)return this.multipart.filter(r=>r.when?this.matchesCase(r.when,t):!0).map(r=>Array.isArray(r.apply)?r.apply[0]:r.apply);return[]}getMesh(t,e,r,i,s){var c,l,h,d,f;const a=this.getModelVariants(e),o=new rt;for(const p of a){const v=u.Cull.rotate(s,(c=p.x)!=null?c:0,(l=p.y)!=null?l:0),g=i.getBlockModel(B.parse(p.model));if(!g)throw new Error(`Cannot find block model ${p.model}`);const w=t?(h=Oe[t.path])==null?void 0:h.call(Oe,e):void 0,S=g.getMesh(r,v,w);if(p.x||p.y){const E=it();q(E,E,[8,8,8]),wt(E,E,-Kr((d=p.y)!=null?d:0)),Rn(E,E,-Kr((f=p.x)!=null?f:0)),q(E,E,[-8,-8,-8]),S.transform(E)}o.merge(S)}const m=it();return Ct(m,m,[.0625,.0625,.0625]),o.transform(m)}matchesVariant(t,e){return t.split(",").every(r=>{const[i,s]=r.split("=");return e[i]===s})}matchesCase(t,e){if(Array.isArray(t.OR))return t.OR.some(i=>this.matchesCase(i,e));if(Array.isArray(t.AND))return t.AND.every(i=>this.matchesCase(i,e));const r=t;return Object.keys(r).every(i=>r[i].split("|").includes(e[i]))}static fromJson(t){return new ii(t.variants,t.multipart)}}class Wt{constructor(t,e,r,i){this.v1=t,this.v2=e,this.v3=r,this.v4=i}vertices(){return[this.v1,this.v2,this.v3,this.v4]}forEach(t){return t(this.v1),t(this.v2),t(this.v3),t(this.v4),this}transform(t){return this.forEach(e=>e.transform(t)),this}normal(){const t=this.v2.pos.sub(this.v1.pos),e=this.v3.pos.sub(this.v1.pos);return t.cross(e).normalize()}reverse(){return[this.v1,this.v2,this.v3,this.v4]=[this.v4,this.v3,this.v2,this.v1],this}setColor(t){return this.forEach(e=>e.color=t),this}setTexture(t,e){return this.v1.textureLimit=e,this.v2.textureLimit=e,this.v3.textureLimit=e,this.v4.textureLimit=e,this.v1.texture=[t[0],t[1]],this.v2.texture=[t[2],t[3]],this.v3.texture=[t[4],t[5]],this.v4.texture=[t[6],t[7]],this}toString(){return`Quad(${this.v1.pos.toString()}, ${this.v2.pos.toString()}, ${this.v3.pos.toString()}, ${this.v4.pos.toString()})`}static fromPoints(t,e,r,i){return new Wt(Pt.fromPos(t),Pt.fromPos(e),Pt.fromPos(r),Pt.fromPos(i))}}const eu={0:[0,3,2,3,2,1,0,1],90:[2,3,2,1,0,1,0,3],180:[2,1,0,1,0,3,2,3],270:[0,1,0,3,2,3,2,1]},nu={x:[1,0,0],y:[0,1,0],z:[0,0,1]},je=1.41421356237,ru={x:[1,je,je],y:[je,1,je],z:[je,je,1]},nn=class{constructor(t,e,r,i,s){_(this,"generationMarker",!1);this.parent=t,this.textures=e,this.elements=r,this.display=i,this.guiLight=s}getDisplayTransform(t){var i;const e=(i=this.display)==null?void 0:i[t],r=it();return q(r,r,[8,8,8]),e!=null&&e.translation&&q(r,r,e.translation),e!=null&&e.rotation&&(Rn(r,r,e.rotation[0]*Math.PI/180),wt(r,r,e.rotation[1]*Math.PI/180),Zs(r,r,-e.rotation[2]*Math.PI/180)),e!=null&&e.scale&&Ct(r,r,e.scale),q(r,r,[-8,-8,-8]),r}getMesh(t,e,r){var a;const i=new rt,s=o=>r===void 0?[1,1,1]:o===void 0||o<0?[1,1,1]:typeof r=="function"?r(o):r;for(const o of(a=this.elements)!=null?a:[])i.merge(this.getElementMesh(o,t,e,s));return i}getElementMesh(t,e,r,i){var p,v,g,w,S,E,y,R,A,I,x,C;const s=new rt,[a,o,m]=t.from,[c,l,h]=t.to,d=(M,N,P)=>{var b,L,D,Z,Q,kt,At,St,lt;const H=Wt.fromPoints(new $(P[0],P[1],P[2]),new $(P[3],P[4],P[5]),new $(P[6],P[7],P[8]),new $(P[9],P[10],P[11])),F=i(M.tintindex);H.setColor(F);const[T,J,U,W]=e.getTextureUV(this.getTexture(M.texture)),j=(U-T)/16,et=(W-J)/16;N[0]=((L=(b=M.uv)==null?void 0:b[0])!=null?L:N[0])*j,N[1]=((Z=(D=M.uv)==null?void 0:D[1])!=null?Z:N[1])*et,N[2]=((kt=(Q=M.uv)==null?void 0:Q[2])!=null?kt:N[2])*j,N[3]=((St=(At=M.uv)==null?void 0:At[3])!=null?St:N[3])*et;const k=eu[(lt=M.rotation)!=null?lt:0];H.setTexture([T+N[k[0]],J+N[k[1]],T+N[k[2]],J+N[k[3]],T+N[k[4]],J+N[k[5]],T+N[k[6]],J+N[k[7]]],[T+Math.min(N[0],N[2]),J+Math.min(N[1],N[3]),T+Math.max(N[0],N[2]),J+Math.max(N[1],N[3])]),s.quads.push(H)};((v=(p=t.faces)==null?void 0:p.up)==null?void 0:v.texture)&&(!t.faces.up.cullface||!r[t.faces.up.cullface])&&d(t.faces.up,[a,16-h,c,16-m],[a,l,h,c,l,h,c,l,m,a,l,m]),((w=(g=t.faces)==null?void 0:g.down)==null?void 0:w.texture)&&(!t.faces.down.cullface||!r[t.faces.down.cullface])&&d(t.faces.down,[16-h,16-c,16-m,16-a],[a,o,m,c,o,m,c,o,h,a,o,h]),((E=(S=t.faces)==null?void 0:S.south)==null?void 0:E.texture)&&(!t.faces.south.cullface||!r[t.faces.south.cullface])&&d(t.faces.south,[a,16-l,c,16-o],[a,o,h,c,o,h,c,l,h,a,l,h]),((R=(y=t.faces)==null?void 0:y.north)==null?void 0:R.texture)&&(!t.faces.north.cullface||!r[t.faces.north.cullface])&&d(t.faces.north,[16-c,16-l,16-a,16-o],[c,o,m,a,o,m,a,l,m,c,l,m]),((I=(A=t.faces)==null?void 0:A.east)==null?void 0:I.texture)&&(!t.faces.east.cullface||!r[t.faces.east.cullface])&&d(t.faces.east,[16-h,16-l,16-m,16-o],[c,o,h,c,o,m,c,l,m,c,l,h]),((C=(x=t.faces)==null?void 0:x.west)==null?void 0:C.texture)&&(!t.faces.west.cullface||!r[t.faces.west.cullface])&&d(t.faces.west,[m,16-l,h,16-o],[a,o,m,a,o,h,a,l,h,a,l,m]);const f=it();if(t.rotation){const M=Gl(...t.rotation.origin);q(f,f,M),Tl(f,f,Kr(t.rotation.angle),nu[t.rotation.axis]),t.rotation.rescale&&Ct(f,f,ru[t.rotation.axis]),Vl(M,M),q(f,f,M)}return s.transform(f)}getTexture(t){var e,r,i,s;for(t=t.startsWith("#")?t.slice(1):t,t=(r=(e=this.textures)==null?void 0:e[t])!=null?r:"";t.startsWith("#");)t=(s=(i=this.textures)==null?void 0:i[t.slice(1)])!=null?s:"";return B.parse(t)}flatten(t){var r,i,s,a;if(!this.parent)return;if(this.parent.equals(nn.BUILTIN_GENERATED)){this.generationMarker=!0;return}const e=this.getParent(t);if(!e){console.warn(`parent ${this.parent} does not exist!`),this.parent=void 0;return}if(e.flatten(t),this.elements||(this.elements=e.elements),this.textures||(this.textures={}),Object.keys((r=e.textures)!=null?r:{}).forEach(o=>{this.textures[o]||(this.textures[o]=e.textures[o])}),this.display||(this.display={}),Object.keys((i=e.display)!=null?i:{}).forEach(o=>{var c;const m=o;this.display[m]?Object.keys((c=e.display[m])!=null?c:{}).forEach(l=>{const h=l;this.display[m][h]||(this.display[m][h]=e.display[m][h])}):this.display[m]=e.display[m]}),this.guiLight||(this.guiLight=e.guiLight),e.generationMarker&&(this.generationMarker=!0),this.generationMarker&&((a=(s=this.elements)==null?void 0:s.length)!=null?a:0)===0)for(let o=0;o<nn.GENERATED_LAYERS.length;o+=1){const m=nn.GENERATED_LAYERS[o];if(!Object.hasOwn(this.textures,m))break;this.elements||(this.elements=[]),this.elements.push({from:[0,0,0],to:[16,16,0],faces:{south:{texture:`#${m}`,tintindex:o}}})}this.parent=void 0}getParent(t){return this.parent?t.getBlockModel(this.parent):null}static fromJson(t){const e=t.parent===void 0?void 0:B.parse(t.parent);return new nn(e,t.textures,t.elements,t.display)}};let ct=nn;_(ct,"BUILTIN_GENERATED",B.create("builtin/generated")),_(ct,"GENERATED_LAYERS",["layer0","layer1","layer2","layer3","layer4"]);function si(n,t,e,r,i){var a;const s=r.up?16:[14.2,12.5,10.5,9,7,5.3,3.7,1.9,16,16,16,16,16,16,16,16][t];return new ct(void 0,{still:`block/${n}_still`,flow:`block/${n}_flow`},[{from:[0,0,0],to:[16,s,16],faces:{up:{texture:"#still",tintindex:i,cullface:u.Direction.UP},down:{texture:"#still",tintindex:i,cullface:u.Direction.DOWN},north:{texture:"#flow",tintindex:i,cullface:u.Direction.NORTH},east:{texture:"#flow",tintindex:i,cullface:u.Direction.EAST},south:{texture:"#flow",tintindex:i,cullface:u.Direction.SOUTH},west:{texture:"#flow",tintindex:i,cullface:u.Direction.WEST}}}]).getMesh(e,r,(a=Oe[n])==null?void 0:a.call(Oe,{}))}const Nn={white:u.Color.intToRgb(16383998),orange:u.Color.intToRgb(16351261),magenta:u.Color.intToRgb(13061821),light_blue:u.Color.intToRgb(3847130),yellow:u.Color.intToRgb(16701501),lime:u.Color.intToRgb(8439583),pink:u.Color.intToRgb(15961002),gray:u.Color.intToRgb(4673362),light_gray:u.Color.intToRgb(10329495),cyan:u.Color.intToRgb(1481884),purple:u.Color.intToRgb(8991416),blue:u.Color.intToRgb(3949738),brown:u.Color.intToRgb(8606770),green:u.Color.intToRgb(6192150),red:u.Color.intToRgb(11546150),black:u.Color.intToRgb(1908001)};u.SpecialRenderers=void 0,(n=>{function t(T){return J=>new ct(void 0,{0:T.withPrefix("entity/chest/").toString()},[{from:[1,0,1],to:[15,10,15],faces:{north:{uv:[10.5,8.25,14,10.75],rotation:180,texture:"#0"},east:{uv:[7,8.25,10.5,10.75],rotation:180,texture:"#0"},south:{uv:[3.5,8.25,7,10.75],rotation:180,texture:"#0"},west:{uv:[0,8.25,3.5,10.75],rotation:180,texture:"#0"},up:{uv:[7,4.75,10.5,8.25],texture:"#0"},down:{uv:[3.5,4.75,7,8.25],texture:"#0"}}},{from:[1,10,1],to:[15,14,15],faces:{north:{uv:[10.5,3.75,14,4.75],rotation:180,texture:"#0"},east:{uv:[7,3.75,10.5,4.75],rotation:180,texture:"#0"},south:{uv:[3.5,3.75,7,4.75],rotation:180,texture:"#0"},west:{uv:[0,3.75,3.5,4.75],rotation:180,texture:"#0"},up:{uv:[7,0,10.5,3.5],texture:"#0"},down:{uv:[3.5,0,7,3.5],texture:"#0"}}},{from:[7,7,0],to:[9,11,2],faces:{north:{uv:[.25,.25,.75,1.25],rotation:180,texture:"#0"},east:{uv:[0,.25,.25,1.25],rotation:180,texture:"#0"},south:{uv:[1,.25,1.5,1.25],rotation:180,texture:"#0"},west:{uv:[.75,.25,1,1.25],rotation:180,texture:"#0"},up:{uv:[.25,0,.75,.25],rotation:180,texture:"#0"},down:{uv:[.75,0,1.25,.25],rotation:180,texture:"#0"}}}]).getMesh(J,u.Cull.none())}n.chestRenderer=t;function e(T){return new ct(void 0,{0:"entity/decorated_pot/decorated_pot_side",1:"entity/decorated_pot/decorated_pot_base"},[{from:[1,0,1],to:[15,16,15],faces:{north:{uv:[1,0,15,16],texture:"#0"},east:{uv:[1,0,15,16],texture:"#0"},south:{uv:[1,0,15,16],texture:"#0"},west:{uv:[1,0,15,16],texture:"#0"},up:{uv:[0,6.5,7,13.5],texture:"#1"},down:{uv:[7,6.5,14,13.5],texture:"#1"}}},{from:[5,16,5],to:[11,17,11],faces:{north:{uv:[0,5.5,3,6],texture:"#1"},east:{uv:[3,5.5,6,6],texture:"#1"},south:{uv:[6,5.5,9,6],texture:"#1"},west:{uv:[9,5.5,12,6],texture:"#1"}}},{from:[4,17,4],to:[12,20,12],faces:{north:{uv:[0,4,4,5.5],texture:"#1"},east:{uv:[4,4,8,5.5],texture:"#1"},south:{uv:[8,4,12,5.5],texture:"#1"},west:{uv:[12,4,16,5.5],texture:"#1"},up:{uv:[4,0,8,4],texture:"#1"},down:{uv:[8,0,12,4],texture:"#1"}}}]).getMesh(T,u.Cull.none())}n.decoratedPotRenderer=e;function r(T){return new ct(void 0,{0:"entity/shield_base_nopattern"},[{from:[-6,-11,-2],to:[6,11,-1],faces:{north:{uv:[3.5,.25,6.5,5.75],texture:"#0"},east:{uv:[3.25,.25,3.5,5.75],texture:"#0"},south:{uv:[.25,.25,3.25,5.75],texture:"#0"},west:{uv:[0,.25,.25,5.75],texture:"#0"},up:{uv:[.25,0,3.25,.25],texture:"#0"},down:{uv:[3.25,0,6.25,.25],texture:"#0"}}}]).getMesh(T,u.Cull.none())}n.shieldRenderer=r;function i(T,J){return U=>new ct(void 0,{0:T.withPrefix("entity/").toString()},[{from:[4,0,4],to:[12,8,12],faces:{north:{uv:[6,2*J,8,4*J],texture:"#0"},east:{uv:[2,2*J,0,4*J],texture:"#0"},south:{uv:[2,2*J,4,4*J],texture:"#0"},west:{uv:[6,2*J,4,4*J],texture:"#0"},up:{uv:[2,0*J,4,2*J],texture:"#0"},down:{uv:[4,0*J,6,2*J],texture:"#0"}}}]).getMesh(U,u.Cull.none())}n.headRenderer=i;function s(T=B.create("enderdragon/dragon")){return J=>{const U=it();return q(U,U,[8,8,8]),Ct(U,U,[.75,.75,.75]),wt(U,U,Math.PI),q(U,U,[-8,-11.2,-8]),new ct(void 0,{0:T.withPrefix("entity/").toString()},[{from:[2,4,-16],to:[14,9,0],faces:{north:{uv:[12,3.75,12.75,4.0625],texture:"#0"},east:{uv:[11,3.75,12,4.0625],texture:"#0"},south:{uv:[13.75,3.75,14.5,4.0625],texture:"#0"},west:{uv:[12.75,3.75,13.75,4.0625],texture:"#0"},up:{uv:[12.75,3.75,12,2.75],texture:"#0"},down:{uv:[13.5,2.75,12.75,3.75],texture:"#0"}}},{from:[0,0,-2],to:[16,16,14],faces:{north:{uv:[8,2.875,9,3.875],texture:"#0"},east:{uv:[7,2.875,8,3.875],texture:"#0"},south:{uv:[10,2.875,11,3.875],texture:"#0"},west:{uv:[9,2.875,10,3.875],texture:"#0"},up:{uv:[9,2.875,8,1.875],texture:"#0"},down:{uv:[10,1.875,9,2.875],texture:"#0"}}},{from:[2,0,-16],to:[14,4,0],rotation:{angle:-.2*180/Math.PI,axis:"x",origin:[8,4,-2]},faces:{north:{uv:[12,5.0625,12.75,5.3125],texture:"#0"},east:{uv:[11,5.0625,12,5.3125],texture:"#0"},south:{uv:[13.75,5.0625,14.5,5.3125],texture:"#0"},west:{uv:[12.75,5.0625,13.75,5.3125],texture:"#0"},up:{uv:[12.75,5.0625,12,4.0625],texture:"#0"},down:{uv:[13.5,4.0625,12.75,5.0625],texture:"#0"}}},{from:[3,16,4],to:[5,20,10],faces:{north:{uv:[.375,.375,.5,.625],texture:"#0"},east:{uv:[0,.375,.375,.625],texture:"#0"},south:{uv:[.875,.375,1,.625],texture:"#0"},west:{uv:[.5,.375,.875,.625],texture:"#0"},up:{uv:[.5,.375,.375,0],texture:"#0"},down:{uv:[.625,0,.5,.375],texture:"#0"}}},{from:[11,16,4],to:[13,20,10],faces:{north:{uv:[.375,.375,.5,.625],texture:"#0"},east:{uv:[0,.375,.375,.625],texture:"#0"},south:{uv:[.875,.375,1,.625],texture:"#0"},west:{uv:[.5,.375,.875,.625],texture:"#0"},up:{uv:[.5,.375,.375,0],texture:"#0"},down:{uv:[.625,0,.5,.375],texture:"#0"}}},{from:[3,9,-14],to:[5,11,-10],faces:{north:{uv:[7.25,.25,7.375,.375],texture:"#0"},east:{uv:[7,.25,7.25,.375],texture:"#0"},south:{uv:[7.625,.25,7.75,.375],texture:"#0"},west:{uv:[7.375,.25,7.625,.375],texture:"#0"},up:{uv:[7.375,.25,7.25,0],texture:"#0"},down:{uv:[7.5,0,7.375,.25],texture:"#0"}}},{from:[11,9,-14],to:[13,11,-10],faces:{north:{uv:[7.25,.25,7.375,.375],texture:"#0"},east:{uv:[7,.25,7.25,.375],texture:"#0"},south:{uv:[7.625,.25,7.75,.375],texture:"#0"},west:{uv:[7.375,.25,7.625,.375],texture:"#0"},up:{uv:[7.375,.25,7.25,0],texture:"#0"},down:{uv:[7.5,0,7.375,.25],texture:"#0"}}}]).getMesh(J,u.Cull.none()).transform(U)}}n.dragonHeadRenderer=s;function a(T=B.create("piglin/piglin")){return J=>new ct(void 0,{0:T.withPrefix("entity/").toString()},[{from:[3,0,4],to:[13,8,12],faces:{north:{uv:[6.5,2,9,4],texture:"#0"},east:{uv:[2,2,0,4],texture:"#0"},south:{uv:[2,2,4.5,4],texture:"#0"},west:{uv:[6.5,2,4.5,4],texture:"#0"},up:{uv:[2,0,4.5,2],texture:"#0"},down:{uv:[4.5,0,7,2],texture:"#0"}}},{from:[6,0,12],to:[10,4,13],faces:{north:{uv:[9.25,.5,10.25,1.5],texture:"#0"},east:{uv:[7.75,.5,8,1.5],texture:"#0"},south:{uv:[8,.5,9,1.5],texture:"#0"},west:{uv:[9,.5,9.25,1.5],texture:"#0"},up:{uv:[8,.25,9,.5],texture:"#0"},down:{uv:[9,.25,10,.5],texture:"#0"}}},{from:[5,0,12],to:[6,2,13],faces:{north:{uv:[1.25,.25,1.5,.75],texture:"#0"},east:{uv:[.5,.25,.75,.75],texture:"#0"},south:{uv:[.75,.25,1,.75],texture:"#0"},west:{uv:[1,.25,1.25,.75],texture:"#0"},up:{uv:[.75,0,1,.25],texture:"#0"},down:{uv:[1,0,1.25,.25],texture:"#0"}}},{from:[10,0,12],to:[11,2,13],faces:{north:{uv:[1.25,1.25,1.5,1.75],texture:"#0"},east:{uv:[.5,1.25,.75,1.75],texture:"#0"},south:{uv:[.75,1.25,1,1.75],texture:"#0"},west:{uv:[1,1.25,1.25,1.75],texture:"#0"},up:{uv:[.75,1,1,1.25],texture:"#0"},down:{uv:[1,1,1.25,1.25],texture:"#0"}}},{from:[2.5,1.5,6],to:[3.5,6.5,10],rotation:{angle:-30,axis:"z",origin:[3,7,8]},faces:{north:{uv:[12,2.5,12.25,3.75],texture:"#0"},east:{uv:[9.75,2.5,10.75,3.75],texture:"#0"},south:{uv:[10.75,2.5,11,3.75],texture:"#0"},west:{uv:[11,2.5,12,3.75],texture:"#0"},up:{uv:[10.75,1.5,11,2.5],texture:"#0"},down:{uv:[11,1.5,11.25,2.5],texture:"#0"}}},{from:[12.5,1.5,6],to:[13.5,6.5,10],rotation:{angle:30,axis:"z",origin:[13,7,8]},faces:{north:{uv:[15.25,2.5,15,3.75],texture:"#0"},east:{uv:[15,2.5,14,3.75],texture:"#0"},south:{uv:[14,2.5,13.75,3.75],texture:"#0"},west:{uv:[13.75,2.5,12.75,3.75],texture:"#0"},up:{uv:[14,1.5,13.75,2.5],texture:"#0"},down:{uv:[14.25,1.5,14,2.5],texture:"#0"}}}]).getMesh(J,u.Cull.none())}n.piglinHeadRenderer=a;function o(T){return J=>new ct(void 0,{0:T.withPrefix("entity/signs/").toString()},[{from:[-4,8,7],to:[20,20,9],faces:{north:{uv:[.5,1,6.5,7],texture:"#0"},east:{uv:[0,1,.5,7],texture:"#0"},south:{uv:[7,1,13,7],texture:"#0"},west:{uv:[6.5,1,7,7],texture:"#0"},up:{uv:[6.5,1,.5,0],texture:"#0"},down:{uv:[12.5,0,6.5,1],texture:"#0"}}},{from:[7,-6,7],to:[9,8,9],faces:{north:{uv:[.5,8,1,15],texture:"#0"},east:{uv:[0,8,.5,15],texture:"#0"},south:{uv:[1.5,8,2,15],texture:"#0"},west:{uv:[1,8,1.5,15],texture:"#0"},up:{uv:[1,8,.5,7],texture:"#0"},down:{uv:[1.5,7,1,8],texture:"#0"}}}]).getMesh(J,u.Cull.none())}n.signRenderer=o;function m(T){return J=>new ct(void 0,{0:T.withPrefix("entity/signs/").toString()},[{from:[-4,4,17],to:[20,16,19],faces:{north:{uv:[.5,1,6.5,7],texture:"#0"},east:{uv:[0,1,.5,7],texture:"#0"},south:{uv:[7,1,13,7],texture:"#0"},west:{uv:[6.5,1,7,7],texture:"#0"},up:{uv:[6.5,1,.5,0],texture:"#0"},down:{uv:[12.5,0,6.5,1],texture:"#0"}}}]).getMesh(J,u.Cull.none())}n.wallSignRenderer=m;function c(T){return(J,U)=>J?new ct(void 0,{0:T.withPrefix("entity/signs/hanging/").toString()},[{from:[1,0,7],to:[15,10,9],faces:{north:{uv:[.5,7,4,12],texture:"#0"},east:{uv:[0,7,.5,12],texture:"#0"},south:{uv:[4.5,7,8,12],texture:"#0"},west:{uv:[4,7,4.5,12],texture:"#0"},up:{uv:[4,7,.5,6],texture:"#0"},down:{uv:[7.5,6,4,7],texture:"#0"}}},{from:[2,10,8],to:[14,16,8],faces:{north:{uv:[3.5,3,6.5,6],texture:"#0"},south:{uv:[3.5,3,6.5,6],texture:"#0"}}}]).getMesh(U,u.Cull.none()):new ct(void 0,{0:T.withPrefix("entity/signs/hanging/").toString()},[{from:[1,0,7],to:[15,10,9],faces:{north:{uv:[.5,7,4,12],texture:"#0"},east:{uv:[0,7,.5,12],texture:"#0"},south:{uv:[4.5,7,8,12],texture:"#0"},west:{uv:[4,7,4.5,12],texture:"#0"},up:{uv:[4,7,.5,6],texture:"#0"},down:{uv:[7.5,6,4,7],texture:"#0"}}},{from:[1.5,10,8],to:[4.5,16,8],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[3,10,6.5],to:[3,16,9.5],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}},{from:[11.5,10,8],to:[14.5,16,8],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[13,10,6.5],to:[13,16,9.5],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}}]).getMesh(U,u.Cull.none())}n.hangingSignRenderer=c;function l(T){return J=>new ct(void 0,{0:`entity/signs/hanging/${T}`},[{from:[1,0,7],to:[15,10,9],faces:{north:{uv:[.5,7,4,12],texture:"#0"},east:{uv:[0,7,.5,12],texture:"#0"},south:{uv:[4.5,7,8,12],texture:"#0"},west:{uv:[4,7,4.5,12],texture:"#0"},up:{uv:[4,7,.5,6],texture:"#0"},down:{uv:[7.5,6,4,7],texture:"#0"}}},{from:[0,14,6],to:[16,16,10],faces:{north:{uv:[1,2,5,3],texture:"#0"},east:{uv:[0,2,1,3],texture:"#0"},south:{uv:[6,2,10,3],texture:"#0"},west:{uv:[5,2,6,3],texture:"#0"},up:{uv:[5,2,1,0],texture:"#0"},down:{uv:[9,0,5,2],texture:"#0"}}},{from:[1.5,10,8],to:[4.5,16,8],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[3,10,6.5],to:[3,16,9.5],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}},{from:[11.5,10,8],to:[14.5,16,8],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[13,10,6.5],to:[13,16,9.5],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}}]).getMesh(J,u.Cull.none())}n.wallHangingSignRenderer=l;function h(T){return new ct(void 0,{0:"entity/conduit/base"},[{from:[5,5,5],to:[11,11,11],faces:{north:{uv:[3,6,6,12],texture:"#0"},east:{uv:[0,6,3,12],texture:"#0"},south:{uv:[9,6,12,12],texture:"#0"},west:{uv:[6,6,9,12],texture:"#0"},up:{uv:[6,6,3,0],texture:"#0"},down:{uv:[9,0,6,6],texture:"#0"}}}]).getMesh(T,u.Cull.none())}n.conduitRenderer=h;function d(T){return J=>new ct(void 0,{0:T.withPrefix("entity/shulker/").toString()},[{from:[0,0,0],to:[16,8,16],faces:{north:{uv:[4,11,8,13],texture:"#0"},east:{uv:[0,11,4,13],texture:"#0"},south:{uv:[12,11,16,13],texture:"#0"},west:{uv:[8,11,12,13],texture:"#0"},up:{uv:[8,11,4,7],texture:"#0"},down:{uv:[12,7,8,11],texture:"#0"}}},{from:[0,4,0],to:[16,16,16],faces:{north:{uv:[4,4,8,7],texture:"#0"},east:{uv:[0,4,4,7],texture:"#0"},south:{uv:[12,4,16,7],texture:"#0"},west:{uv:[8,4,12,7],texture:"#0"},up:{uv:[8,4,4,0],texture:"#0"},down:{uv:[12,0,8,4],texture:"#0"}}}]).getMesh(J,u.Cull.none())}n.shulkerBoxRenderer=d;const f=T=>({north:{uv:[.25,.25,5.25,10.25],texture:`#${T}`,tintindex:T},east:{uv:[0,.25,.25,10.25],texture:`#${T}`,tintindex:T},south:{uv:[5.5,.25,10.5,10.25],texture:`#${T}`,tintindex:T},west:{uv:[5.25,.25,5.5,10.25],texture:`#${T}`,tintindex:T},up:{uv:[5.25,.25,.25,0],texture:`#${T}`,tintindex:T},down:{uv:[10.25,0,5.25,.25],texture:`#${T}`,tintindex:T}});function p(T,J){return(U,W)=>{const j={0:"entity/banner_base"},et=[...J.base],k=[T];return W==null||W.forEach((b,L)=>{const D=B.parse(b.getString("pattern")).path,Z=b.getString("color");L++,j[L]=`entity/banner/${D}`,et.push(J.pattern(L)),k.push(Z)}),new ct(void 0,j,et).getMesh(U,u.Cull.none(),b=>Nn[k[b]])}}n.bannerRenderer=T=>p(T,{base:[{from:[-2,-8,6],to:[18,32,7],faces:f(0)},{from:[7,-12,7],to:[9,30,9],faces:{north:{uv:[11.5,.5,12,11],texture:"#0"},east:{uv:[11,.5,11.5,11],texture:"#0"},south:{uv:[12.5,.5,13,11],texture:"#0"},west:{uv:[12,.5,12.5,11],texture:"#0"},up:{uv:[12,.5,11.5,0],texture:"#0"},down:{uv:[12.5,0,12,.5],texture:"#0"}}},{from:[-2,30,7],to:[18,32,9],faces:{north:{uv:[.5,11,5.5,11.5],texture:"#0"},east:{uv:[0,11,.5,11.5],texture:"#0"},south:{uv:[6,11,11,11.5],texture:"#0"},west:{uv:[5.5,11,6,11.5],texture:"#0"},up:{uv:[5.5,11,.5,10.5],texture:"#0"},down:{uv:[10.5,10.5,5.5,11],texture:"#0"}}}],pattern:J=>({from:[-2,-8,6],to:[18,32,7],faces:f(J)})}),n.wallBannerRenderer=T=>p(T,{base:[{from:[-2,-8,-1.5],to:[18,32,-.5],faces:f(0)},{from:[-2,30,-3.5],to:[18,32,-1.5],faces:{north:{uv:[.5,11,5.5,11.5],texture:"#0"},east:{uv:[0,11,.5,11.5],texture:"#0"},south:{uv:[6,11,11,11.5],texture:"#0"},west:{uv:[5.5,11,6,11.5],texture:"#0"},up:{uv:[5.5,11,.5,10.5],texture:"#0"},down:{uv:[10.5,10.5,5.5,11],texture:"#0"}}}],pattern:J=>({from:[-2,-8,-1.5],to:[18,32,-.5],faces:f(J)})});function v(T){return new ct(void 0,{0:"entity/bell/bell_body"},[{from:[5,3,5],to:[11,10,11],faces:{north:{uv:[3,3,6,6.5],texture:"#0"},east:{uv:[0,3,3,6.5],texture:"#0"},south:{uv:[9,3,12,6.5],texture:"#0"},west:{uv:[6,3,9,6.5],texture:"#0"},up:{uv:[6,3,3,0],texture:"#0"},down:{uv:[9,0,6,3],texture:"#0"}}},{from:[4,10,4],to:[12,12,12],faces:{north:{uv:[4,10.5,8,11.5],texture:"#0"},east:{uv:[0,10.5,4,11.5],texture:"#0"},south:{uv:[12,10.5,16,11.5],texture:"#0"},west:{uv:[8,10.5,12,11.5],texture:"#0"},up:{uv:[8,10.5,4,6.5],texture:"#0"},down:{uv:[12,6.5,8,10.5],texture:"#0"}}}]).getMesh(T,u.Cull.none())}n.bellRenderer=v;function g(T){return(J,U)=>J==="foot"?new ct(void 0,{0:T.withPrefix("entity/bed/").toString()},[{from:[0,3,0],to:[16,9,16],faces:{north:{uv:[5.5,5.5,9.5,7],rotation:180,texture:"#0"},east:{uv:[0,7,1.5,11],rotation:270,texture:"#0"},west:{uv:[5.5,7,7,11],rotation:90,texture:"#0"},up:{uv:[5.5,11,1.5,7],texture:"#0"},down:{uv:[11,7,7,11],texture:"#0"}}},{from:[0,0,0],to:[3,3,3],faces:{north:{uv:[12.5,5.25,13.25,6],texture:"#0"},east:{uv:[14.75,5.25,15.5,6],texture:"#0"},south:{uv:[14,5.25,14.75,6],texture:"#0"},west:{uv:[13.25,5.25,14,6],texture:"#0"},up:{uv:[13.25,4.5,14,5.25],texture:"#0"},down:{uv:[14,4.5,14.75,5.25],texture:"#0"}}},{from:[13,0,0],to:[16,3,3],faces:{north:{uv:[13.25,3.75,14,4.5],texture:"#0"},east:{uv:[12.5,3.75,13.25,4.5],texture:"#0"},south:{uv:[14.75,3.75,15.5,4.5],texture:"#0"},west:{uv:[14,3.75,14.75,4.5],texture:"#0"},up:{uv:[13.25,3,14,3.75],texture:"#0"},down:{uv:[14,3,14.75,3.75],texture:"#0"}}}]).getMesh(U,u.Cull.none()):new ct(void 0,{0:T.withPrefix("entity/bed/").toString()},[{from:[0,3,0],to:[16,9,16],faces:{east:{uv:[0,1.5,1.5,5.5],rotation:270,texture:"#0"},south:{uv:[1.5,0,5.5,1.5],rotation:180,texture:"#0"},west:{uv:[5.5,1.5,7,5.5],rotation:90,texture:"#0"},up:{uv:[5.5,5.5,1.5,1.5],texture:"#0"},down:{uv:[11,1.5,7,5.5],texture:"#0"}}},{from:[0,0,13],to:[3,3,16],faces:{north:{uv:[14.75,.75,15.5,1.5],texture:"#0"},east:{uv:[14,.75,14.75,1.5],texture:"#0"},south:{uv:[13.25,.75,14,1.5],texture:"#0"},west:{uv:[12.5,.75,13.25,1.5],texture:"#0"},up:{uv:[13.25,0,14,.75],texture:"#0"},down:{uv:[14,0,14.75,.75],texture:"#0"}}},{from:[13,0,13],to:[16,3,16],faces:{north:{uv:[14,2.25,14.75,3],texture:"#0"},east:{uv:[13.25,2.25,14,3],texture:"#0"},south:{uv:[12.5,2.25,13.25,3],texture:"#0"},west:{uv:[14.75,2.25,15.5,3],texture:"#0"},up:{uv:[13.25,1.5,14,2.25],texture:"#0"},down:{uv:[14,1.5,14.75,2.25],texture:"#0"}}}]).getMesh(U,u.Cull.none())}n.bedRenderer=g;function w(T,J,U=""){var W;return(W=T.getProperty(J))!=null?W:U}function S(T,J,U="0"){var W;return parseInt((W=T.getProperty(J))!=null?W:U)}const E=new Map(Object.entries({"minecraft:chest":n.chestRenderer(B.create("normal")),"minecraft:ender_chest":n.chestRenderer(B.create("ender")),"minecraft:trapped_chest":n.chestRenderer(B.create("trapped")),"minecraft:copper_chest":n.chestRenderer(B.create("copper")),"minecraft:exposed_copper_chest":n.chestRenderer(B.create("copper_exposed")),"minecraft:weathered_copper_chest":n.chestRenderer(B.create("copper_weathered")),"minecraft:oxidized_copper_chest":n.chestRenderer(B.create("copper_oxidized")),"minecraft:waxed_copper_chest":n.chestRenderer(B.create("copper")),"minecraft:waxed_exposed_copper_chest":n.chestRenderer(B.create("copper_exposed")),"minecraft:waxed_weathered_copper_chest":n.chestRenderer(B.create("copper_weathered")),"minecraft:waxed_oxidized_copper_chest":n.chestRenderer(B.create("copper_oxidized"))})),y=new Map(Object.entries({"minecraft:skeleton_skull":n.headRenderer(B.create("skeleton/skeleton"),2),"minecraft:wither_skeleton_skull":n.headRenderer(B.create("skeleton/wither_skeleton"),2),"minecraft:zombie_head":n.headRenderer(B.create("zombie/zombie"),1),"minecraft:creeper_head":n.headRenderer(B.create("creeper/creeper"),2),"minecraft:dragon_head":n.dragonHeadRenderer(),"minecraft:piglin_head":n.piglinHeadRenderer(),"minecraft:player_head":n.headRenderer(B.create("player/wide/steve"),1)})),R=["oak","spruce","birch","jungle","acacia","dark_oak","mangrove","cherry","bamboo","crimson","warped"],A=new Map(R.map(T=>[`minecraft:${T}_sign`,n.signRenderer(B.create(T))])),I=new Map(R.map(T=>[`minecraft:${T}_wall_sign`,n.wallSignRenderer(B.create(T))])),x=new Map(R.map(T=>[`minecraft:${T}_hanging_sign`,n.hangingSignRenderer(B.create(T))])),C=new Map(R.map(T=>[`minecraft:${T}_wall_hanging_sign`,n.wallHangingSignRenderer(T)])),M=new Map(Object.keys(Nn).map(T=>[`minecraft:${T}_shulker_box`,n.shulkerBoxRenderer(B.create(`shulker_${T}`))])),N=new Map(Object.keys(Nn).map(T=>[`minecraft:${T}_bed`,n.bedRenderer(B.create(T))])),P=new Map(Object.keys(Nn).map(T=>[`minecraft:${T}_banner`,n.bannerRenderer(T)])),H=new Map(Object.keys(Nn).map(T=>[`minecraft:${T}_wall_banner`,n.wallBannerRenderer(T)]));function F(T,J,U,W){const j=new rt;T.is("water")&&j.merge(si("water",S(T,"level"),U,W,0)),T.is("lava")&&j.merge(si("lava",S(T,"level"),U,W));const et=E.get(T.getName().toString());if(et!==void 0){const G=w(T,"facing","south"),O=it();q(O,O,[8,8,8]),wt(O,O,G==="west"?Math.PI/2:G==="south"?Math.PI:G==="east"?Math.PI*3/2:0),q(O,O,[-8,-8,-8]),j.merge(et(U).transform(O))}T.is("decorated_pot")&&j.merge(e(U));const k=y.get(T.getName().toString());if(k!==void 0){const G=S(T,"rotation")/16*Math.PI*2,O=it();q(O,O,[8,8,8]),wt(O,O,G),q(O,O,[-8,-8,-8]),j.merge(k(U).transform(O))}const b=A.get(T.getName().toString());if(b!==void 0){const G=S(T,"rotation")/16*Math.PI*2,O=it();q(O,O,[8,8,8]),wt(O,O,G),Ct(O,O,[2/3,2/3,2/3]),q(O,O,[-8,-8,-8]),j.merge(b(U).transform(O))}const L=I.get(T.getName().toString());if(L!==void 0){const G=w(T,"facing","south"),O=it();q(O,O,[8,8,8]),wt(O,O,G==="west"?Math.PI/2:G==="south"?Math.PI:G==="east"?Math.PI*3/2:0),Ct(O,O,[2/3,2/3,2/3]),q(O,O,[-8,-8,-8]),j.merge(L(U).transform(O))}const D=x.get(T.getName().toString());if(D!==void 0){const G=w(T,"attached","false")==="true",O=S(T,"rotation")/16*Math.PI*2,ut=it();q(ut,ut,[8,8,8]),wt(ut,ut,O),Ct(ut,ut,[2/3,2/3,2/3]),q(ut,ut,[-8,-8,-8]),j.merge(D(G,U).transform(ut))}const Z=C.get(T.getName().toString());if(Z!==void 0){const G=w(T,"facing","south"),O=it();q(O,O,[8,8,8]),wt(O,O,G==="west"?Math.PI/2:G==="south"?Math.PI:G==="east"?Math.PI*3/2:0),q(O,O,[-8,-8,-8]),j.merge(Z(U).transform(O))}T.is("conduit")&&j.merge(h(U));const Q=M.get(T.getName().toString());if(Q!==void 0){const G=w(T,"facing","up"),O=it();q(O,O,[8,8,8]),G==="down"?Rn(O,O,Math.PI):G!=="up"&&(wt(O,O,G==="east"?Math.PI/2:G==="north"?Math.PI:G==="west"?Math.PI*3/2:0),Rn(O,O,Math.PI/2)),q(O,O,[-8,-8,-8]),j.merge(Q(U).transform(O))}if(T.is("bell")){const G=it();q(G,G,[8,8,8]),Ct(G,G,[1,-1,-1]),q(G,G,[-8,-8,-8]),j.merge(v(U).transform(G))}const kt=N.get(T.getName().toString());if(kt!==void 0){const G=w(T,"part","head"),O=w(T,"facing","south"),ut=it();q(ut,ut,[8,8,8]),wt(ut,ut,O==="east"?Math.PI/2:O==="north"?Math.PI:O==="west"?Math.PI*3/2:0),q(ut,ut,[-8,-8,-8]),j.merge(kt(G,U).transform(ut))}const At=P.get(T.getName().toString());if(At!==void 0){const G=S(T,"rotation")/16*Math.PI*2,O=it();q(O,O,[8,24,8]),wt(O,O,G),Ct(O,O,[2/3,2/3,2/3]),q(O,O,[-8,-24,-8]),j.merge(At(U,J==null?void 0:J.getList("patterns",z.Compound)).transform(O))}const St=H.get(T.getName().toString());if(St!==void 0){const G=w(T,"facing","south"),O=it();q(O,O,[8,8,8]),wt(O,O,G==="east"?Math.PI/2:G==="north"?Math.PI:G==="west"?Math.PI*3/2:0),Ct(O,O,[2/3,2/3,2/3]),q(O,O,[-8,-23.2,-8]),j.merge(St(U,J==null?void 0:J.getList("patterns",z.Compound)).transform(O))}!T.is("water")&&!T.is("lava")&&T.isWaterlogged()&&j.merge(si("water",0,U,W,0));const lt=it();return Ct(lt,lt,[.0625,.0625,.0625]),j.transform(lt)}n.getBlockMesh=F})(u.SpecialRenderers||(u.SpecialRenderers={}));class Xs{constructor(t,e,r,i=16){_(this,"chunks",[]);_(this,"chunkSize");this.gl=t,this.structure=e,this.resources=r,this.chunkSize=typeof i=="number"?[i,i,i]:i,this.updateStructureBuffers()}setStructure(t){this.structure=t,this.updateStructureBuffers()}updateStructureBuffers(t){var e,r;if(!!this.structure){t?t.forEach(i=>{const s=this.getChunk(i);s.mesh.clear(),s.transparentMesh.clear()}):this.chunks.forEach(i=>i.forEach(s=>s.forEach(a=>{a.mesh.clear(),a.transparentMesh.clear()})));for(const i of this.structure.getBlocks()){const s=i.state.getName(),a=i.state.getProperties(),o=(e=this.resources.getDefaultBlockProperties(s))!=null?e:{};Object.entries(o).forEach(([l,h])=>{a[l]||(a[l]=h)});const m=[Math.floor(i.pos[0]/this.chunkSize[0]),Math.floor(i.pos[1]/this.chunkSize[1]),Math.floor(i.pos[2]/this.chunkSize[2])];if(t&&!t.some(l=>Yl(l,m)))continue;const c=this.getChunk(m);try{const l=this.resources.getBlockDefinition(s),h={up:this.needsCull(i,u.Direction.UP),down:this.needsCull(i,u.Direction.DOWN),west:this.needsCull(i,u.Direction.WEST),east:this.needsCull(i,u.Direction.EAST),north:this.needsCull(i,u.Direction.NORTH),south:this.needsCull(i,u.Direction.SOUTH)},d=new rt;l&&d.merge(l.getMesh(s,a,this.resources,this.resources,h));const f=u.SpecialRenderers.getBlockMesh(i.state,i.nbt,this.resources,h);f.isEmpty()||d.merge(f),d.isEmpty()||(this.finishChunkMesh(d,i.pos),(r=this.resources.getBlockFlags(i.state.getName()))!=null&&r.semi_transparent?c.transparentMesh.merge(d):c.mesh.merge(d))}catch(l){console.error(`Error rendering block ${s}`,l)}}t?t.forEach(i=>{const s=this.getChunk(i);s.mesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0}),s.transparentMesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0})}):this.chunks.forEach(i=>i.forEach(s=>s.forEach(a=>{a.mesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0}),a.transparentMesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0})})))}}getMeshes(){const t=this.chunks.flatMap(e=>e.flatMap(r=>r.flatMap(i=>i!=null?i:[])));return t.flatMap(e=>e.mesh.isEmpty()?[]:e.mesh).concat(t.flatMap(e=>e.transparentMesh.isEmpty()?[]:e.transparentMesh))}needsCull(t,e){var s;const r=(s=this.structure.getBlock(u.BlockPos.towards(t.pos,e)))==null?void 0:s.state;if(!r)return!1;const i=this.resources.getBlockFlags(r.getName());return t.state.getName().equals(r.getName())&&(i==null?void 0:i.self_culling)?!0:i!=null&&i.opaque?!(e===u.Direction.UP&&t.state.isWaterlogged()):t.state.isWaterlogged()&&r.isWaterlogged()}finishChunkMesh(t,e){const r=it();q(r,r,e),t.transform(r);for(const i of t.quads){const s=i.normal();i.forEach(a=>a.normal=s),i.forEach(a=>a.blockPos=new $(e[0],e[1],e[2]))}}getChunk(t){const e=Math.abs(t[0])*2+(t[0]<0?1:0),r=Math.abs(t[1])*2+(t[1]<0?1:0),i=Math.abs(t[2])*2+(t[2]<0?1:0);return this.chunks[e]||(this.chunks[e]=[]),this.chunks[e][r]||(this.chunks[e][r]=[]),this.chunks[e][r][i]||(this.chunks[e][r][i]={mesh:new rt,transparentMesh:new rt}),this.chunks[e][r][i]}}class Bn{constructor(t,e,r){_(this,"gl");_(this,"program");this.gl=t,this.program=this.initShaderProgram(e,r)}getProgram(){return this.program}initShaderProgram(t,e){const r=this.loadShader(this.gl.VERTEX_SHADER,t),i=this.loadShader(this.gl.FRAGMENT_SHADER,e),s=this.gl.createProgram();if(this.gl.attachShader(s,r),this.gl.attachShader(s,i),this.gl.linkProgram(s),!this.gl.getProgramParameter(s,this.gl.LINK_STATUS))throw new Error(`Unable to link shader program: ${this.gl.getProgramInfoLog(s)}`);return s}loadShader(t,e){const r=this.gl.createShader(t);if(this.gl.shaderSource(r,e),this.gl.compileShader(r),!this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)){const i=new Error(`Compiling ${t===this.gl.VERTEX_SHADER?"vertex":"fragment"} shader: ${this.gl.getShaderInfoLog(r)}`);throw this.gl.deleteShader(r),i}return r}}const iu=`
  attribute vec4 vertPos;
  attribute vec2 texCoord;
  attribute vec4 texLimit;
  attribute vec3 vertColor;
  attribute vec3 normal;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec2 vTexCoord;
  varying highp vec4 vTexLimit;
  varying highp vec3 vTintColor;
  varying highp float vLighting;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vTexCoord = texCoord;
	vTexLimit = texLimit;
    vTintColor = vertColor;
    vLighting = normal.y * 0.2 + abs(normal.z) * 0.1 + 0.8;
  }
`,su=`
  precision highp float;
  varying highp vec2 vTexCoord;
  varying highp vec4 vTexLimit;
  varying highp vec3 vTintColor;
  varying highp float vLighting;

  uniform sampler2D sampler;
  uniform highp float pixelSize;

  void main(void) {
		vec4 texColor = texture2D(sampler, clamp(vTexCoord,
			vTexLimit.xy + vec2(0.5, 0.5) * pixelSize,
			vTexLimit.zw - vec2(0.5, 0.5) * pixelSize
		));
		if(texColor.a < 0.01) discard;
		gl_FragColor = vec4(texColor.xyz * vTintColor * vLighting, texColor.a);
  }
`;class fr{constructor(t){_(this,"shaderProgram");_(this,"projMatrix");_(this,"activeShader");_(this,"pixelSize",0);this.gl=t,this.shaderProgram=new Bn(t,iu,su).getProgram(),this.activeShader=this.shaderProgram,this.projMatrix=this.getPerspective(),this.initialize()}setViewport(t,e,r,i){this.gl.viewport(t,e,r,i),this.projMatrix=this.getPerspective()}getPerspective(){const t=70*Math.PI/180,e=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,r=it();return Ol(r,t,e,.1,500),r}initialize(){this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK)}setShader(t){this.gl.useProgram(t),this.activeShader=t}setVertexAttr(t,e,r){if(r===void 0)throw new Error(`Expected buffer for ${t}`);const i=this.gl.getAttribLocation(this.activeShader,t);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r),this.gl.vertexAttribPointer(i,e,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(i)}setUniform(t,e){const r=this.gl.getUniformLocation(this.activeShader,t);this.gl.uniformMatrix4fv(r,!1,e)}setTexture(t,e){this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.pixelSize=e!=null?e:0}createAtlasTexture(t){const e=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),e}prepareDraw(t){this.setUniform("mView",t),this.setUniform("mProj",this.projMatrix);const e=this.gl.getUniformLocation(this.activeShader,"pixelSize");this.gl.uniform1f(e,this.pixelSize)}drawMesh(t,e){if(t.quadVertices()>0){if(e.pos&&this.setVertexAttr("vertPos",3,t.posBuffer),e.color&&this.setVertexAttr("vertColor",3,t.colorBuffer),e.texture&&(this.setVertexAttr("texCoord",2,t.textureBuffer),this.setVertexAttr("texLimit",4,t.textureLimitBuffer)),e.normal&&this.setVertexAttr("normal",3,t.normalBuffer),e.blockPos&&this.setVertexAttr("blockPos",3,t.blockPosBuffer),!t.indexBuffer)throw new Error("Expected index buffer");this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t.indexBuffer),this.gl.drawElements(this.gl.TRIANGLES,t.quadIndices(),this.gl.UNSIGNED_SHORT,0)}t.lineVertices()>0&&(e.pos&&this.setVertexAttr("vertPos",3,t.linePosBuffer),e.color&&this.setVertexAttr("vertColor",3,t.lineColorBuffer),this.gl.drawArrays(this.gl.LINES,0,t.lineVertices()))}}class dr extends fr{constructor(e,r,i,s={}){super(e);_(this,"mesh");_(this,"atlasTexture");this.item=r,this.resources=i,this.updateMesh(s),this.atlasTexture=this.createAtlasTexture(this.resources.getTextureAtlas())}setItem(e,r={}){this.item=e,this.updateMesh(r)}updateMesh(e={}){this.mesh=dr.getItemMesh(this.item,this.resources,e),this.mesh.computeNormals(),this.mesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0})}static getItemMesh(e,r,i){var m;const s=(m=e.getComponent("item_model",r))==null?void 0:m.getAsString();if(s===void 0)return new rt;const a=r.getItemModel(B.parse(s));if(!a)throw new Error(`Item model ${s} does not exist (defined by item ${e.toString()})`);return a.getMesh(e,r,i)}getPerspective(){const e=it();return Jl(e,0,16,0,16,.1,500),e}drawItem(){var r,i;const e=it();q(e,e,[0,0,-32]),this.setShader(this.shaderProgram),this.setTexture(this.atlasTexture,(i=(r=this.resources).getPixelSize)==null?void 0:i.call(r)),this.prepareDraw(e),this.drawMesh(this.mesh,{pos:!0,color:!0,texture:!0,normal:!0})}}const Je=[0,0,0];u.ItemTint=void 0,(n=>{function t(l){var f,p,v,g,w,S,E,y,R,A,I,x;const h=(f=u.Json.readObject(l))!=null?f:{},d=(p=u.Json.readString(h.type))==null?void 0:p.replace(/^minecraft:/,"");switch(d){case"constant":return new e((v=u.Color.fromJson(h.value))!=null?v:Je);case"dye":return new r((g=u.Color.fromJson(h.default))!=null?g:Je);case"grass":return new i((w=u.Json.readNumber(h.temperature))!=null?w:0,(S=u.Json.readNumber(h.downfall))!=null?S:0);case"firework":return new s((E=u.Color.fromJson(h.default))!=null?E:Je);case"potion":return new a((y=u.Color.fromJson(h.default))!=null?y:Je);case"map_color":return new o((R=u.Color.fromJson(h.default))!=null?R:Je);case"custom_model_data":return new m((A=u.Json.readInt(h.index))!=null?A:0,(I=u.Color.fromJson(h.default))!=null?I:Je);case"team":return new c((x=u.Color.fromJson(h.default))!=null?x:Je);default:throw new Error(`Invalid item tint type ${d}`)}}n.fromJson=t;class e{constructor(h){this.value=h}getTint(h){return this.value}}n.Constant=e;class r{constructor(h){this.default_color=h}getTint(h,d){const f=h.getComponent("dyed_color",d);return f?f.isCompound()?u.Color.intToRgb(f.getNumber("rgb")):u.Color.intToRgb(f.getAsNumber()):this.default_color}}n.Dye=r;class i{constructor(h,d){this.temperature=h,this.downfall=d}getTint(h){return[124/255,189/255,107/255]}}n.Grass=i;class s{constructor(h){this.default_color=h}getTint(h,d){const f=h.getComponent("firework_explosion",d);if(!(f!=null&&f.isCompound()))return this.default_color;const p=f.get("colors");return!p||!p.isListOrArray()?this.default_color:(()=>{if(p.length===1)return u.Color.intToRgb(p.get(0).getAsNumber());let[g,w,S]=[0,0,0];for(const E of p.getItems())g+=(E.getAsNumber()&16711680)>>16,w+=(E.getAsNumber()&65280)>>8,S+=(E.getAsNumber()&255)>>0;return g/=p.length,w/=p.length,S/=p.length,[g/255,w/255,S/255]})()}}n.Firework=s;class a{constructor(h){this.default_color=h}getTint(h,d){const f=h.getComponent("potion_contents",d);if(!f)return this.default_color;const p=u.PotionContents.fromNbt(f);return u.PotionContents.getColor(p)}}n.Potion=a;class o{constructor(h){this.default_color=h}getTint(h,d){const f=h.getComponent("map_color",d);return f?u.Color.intToRgb(f.getAsNumber()):this.default_color}}n.MapColor=o;class m{constructor(h,d){this.index=h,this.default_color=d}getTint(h,d){var v;const f=h.getComponent("custom_model_data",d);if(!(f!=null&&f.isCompound()))return this.default_color;const p=f.getList("colors").get(this.index);return p?(v=u.Color.fromNbt(p))!=null?v:this.default_color:this.default_color}}n.CustomModelData=m;class c{constructor(h){this.default_color=h}getTint(h,d,f){var p;return(p=f.context_entity_team_color)!=null?p:this.default_color}}n.Team=c})(u.ItemTint||(u.ItemTint={}));var ai;(n=>{function t(f){var g,w,S,E,y,R,A,I,x,C,M,N,P;const p=(g=u.Json.readObject(f))!=null?g:{},v=(w=u.Json.readString(p.type))==null?void 0:w.replace(/^minecraft:/,"");switch(v){case"bed":return new e(B.parse((S=u.Json.readString(p.texture))!=null?S:""));case"banner":return new r((E=u.Json.readString(p.color))!=null?E:"");case"conduit":return new i;case"chest":return new s(B.parse((y=u.Json.readString(p.texture))!=null?y:""),(R=u.Json.readNumber(p.openness))!=null?R:0);case"head":return new a((A=u.Json.readString(p.kind))!=null?A:"",typeof p.texture=="string"?B.parse(p.texture):void 0,(I=u.Json.readNumber(p.animation))!=null?I:0);case"player_head":return new a("player",void 0,0);case"shulker_box":return new o(B.parse((x=u.Json.readString(p.texture))!=null?x:""),(C=u.Json.readNumber(p.openness))!=null?C:0,(M=u.Json.readString(p.orientation))!=null?M:"up");case"shield":return new m;case"trident":return new c;case"decorated_pot":return new l;case"standing_sign":return new h((N=u.Json.readString(p.wood_type))!=null?N:"",typeof p.texture=="string"?B.parse(p.texture):void 0);case"hanging_sign":return new d((P=u.Json.readString(p.wood_type))!=null?P:"",typeof p.texture=="string"?B.parse(p.texture):void 0);default:return console.warn(`[deepslate]: Unknown special model ${v}`),{getMesh:()=>new rt}}}n.fromJson=t;class e{constructor(p){_(this,"renderer");this.renderer=u.SpecialRenderers.bedRenderer(p)}getMesh(p,v){const g=this.renderer("head",v),w=this.renderer("foot",v),S=it();return q(S,S,[0,0,-16]),g.merge(w.transform(S))}}class r{constructor(p){_(this,"renderer");this.renderer=u.SpecialRenderers.bannerRenderer(p)}getMesh(p,v){const g=p.getComponent("banner_patterns",void 0),w=it();return q(w,w,[8,24,8]),wt(w,w,Math.PI),Ct(w,w,[2/3,2/3,2/3]),q(w,w,[-8,-24,-8]),this.renderer(v,g instanceof xt?g:void 0).transform(w)}}class i{getMesh(p,v){return u.SpecialRenderers.conduitRenderer(v)}}class s{constructor(p,v){_(this,"renderer");this.renderer=u.SpecialRenderers.chestRenderer(p)}getMesh(p,v){const g=it();return q(g,g,[8,8,8]),wt(g,g,Math.PI),q(g,g,[-8,-8,-8]),this.renderer(v).transform(g)}}class a{constructor(p,v,g){_(this,"renderer");var w;this.renderer=((w={skeleton:()=>u.SpecialRenderers.headRenderer(v!=null?v:B.create("skeleton/skeleton"),2),wither_skeleton:()=>u.SpecialRenderers.headRenderer(v!=null?v:B.create("skeleton/wither_skeleton"),2),zombie:()=>u.SpecialRenderers.headRenderer(v!=null?v:B.create("zombie/zombie"),1),creeper:()=>u.SpecialRenderers.headRenderer(v!=null?v:B.create("creeper/creeper"),2),dragon:()=>u.SpecialRenderers.dragonHeadRenderer(v),piglin:()=>u.SpecialRenderers.piglinHeadRenderer(v),player:()=>u.SpecialRenderers.headRenderer(v!=null?v:B.create("player/wide/steve"),1)}[p])!=null?w:()=>()=>new rt)()}getMesh(p,v){return this.renderer(v)}}class o{constructor(p,v,g){_(this,"renderer");this.renderer=u.SpecialRenderers.shulkerBoxRenderer(p)}getMesh(p,v){return this.renderer(v)}}class m{getMesh(p,v){const g=u.SpecialRenderers.shieldRenderer(v),w=it();return q(w,w,[-3,1,0]),Rn(w,w,-10*Math.PI/180),wt(w,w,-10*Math.PI/180),Zs(w,w,-5*Math.PI/180),g.transform(w)}}class c{getMesh(p,v){return new rt}}class l{getMesh(p,v){return u.SpecialRenderers.decoratedPotRenderer(v)}}class h{constructor(p,v){_(this,"renderer");this.renderer=u.SpecialRenderers.signRenderer(v!=null?v:B.create(p))}getMesh(p,v){return this.renderer(v)}}class d{constructor(p,v){_(this,"renderer");this.renderer=u.SpecialRenderers.hangingSignRenderer(v!=null?v:B.create(p))}getMesh(p,v){return this.renderer(!1,v)}}})(ai||(ai={}));const js=new rt;u.ItemModel=void 0,(n=>{function t(l){var f,p,v,g,w,S,E,y,R;const h=(f=u.Json.readObject(l))!=null?f:{},d=(p=u.Json.readString(h.type))==null?void 0:p.replace(/^minecraft:/,"");switch(d){case"empty":return new e;case"model":return new r(B.parse((v=u.Json.readString(h.model))!=null?v:""),(g=u.Json.readArray(h.tints,u.ItemTint.fromJson))!=null?g:[]);case"composite":return new i((w=u.Json.readArray(h.models,n.fromJson))!=null?w:[]);case"condition":return new s(s.propertyFromJson(h),n.fromJson(h.on_true),n.fromJson(h.on_false));case"select":return new a(a.propertyFromJson(h),new Map((S=u.Json.readArray(h.cases,A=>{var I;return(I=u.Json.readObject(A))!=null?I:{}}))==null?void 0:S.flatMap(A=>{var x;const I=n.fromJson(A.model);return Array.isArray(A.when)?A.when.map(C=>{var M;return[(M=u.Json.readString(C))!=null?M:"",I]}):[[(x=u.Json.readString(A.when))!=null?x:"",I]]})),h.fallback?n.fromJson(h.fallback):void 0);case"range_dispatch":return new o(o.propertyFromJson(h),(E=u.Json.readNumber(h.scale))!=null?E:1,(y=u.Json.readArray(h.entries,A=>{var x,C;const I=(x=u.Json.readObject(A))!=null?x:{};return{threshold:(C=u.Json.readNumber(I.threshold))!=null?C:0,model:n.fromJson(I.model)}}))!=null?y:[],h.fallback?n.fromJson(h.fallback):void 0);case"special":return new m(ai.fromJson(h.model),B.parse((R=u.Json.readString(h.base))!=null?R:""));case"bundle/selected_item":return new c;default:return console.warn(`[deepslate]: Unknown item model type '${d}'`),{getMesh:()=>new rt}}}n.fromJson=t;class e{getMesh(h,d,f){return new rt}}n.Empty=e;class r{constructor(h,d){this.modelId=h,this.tints=d}getMesh(h,d,f){var w;const p=d.getBlockModel(this.modelId);if(!p)return console.warn(`[deepslate]: Model '${this.modelId}' does not exist`),new rt;const v=S=>S<this.tints.length?this.tints[S].getTint(h,d,f):[1,1,1],g=p.getMesh(d,u.Cull.none(),v);return g.transform(p.getDisplayTransform((w=f.display_context)!=null?w:"gui")),g}}n.Model=r;class i{constructor(h){this.models=h}getMesh(h,d,f){const p=new rt;return this.models.forEach(v=>p.merge(v.getMesh(h,d,f))),p}}n.Composite=i;class s{constructor(h,d,f){this.property=h,this.onTrue=d,this.onFalse=f}getMesh(h,d,f){return(this.property(h,d,f)?this.onTrue:this.onFalse).getMesh(h,d,f)}static propertyFromJson(h){var f,p,v,g,w;const d=(f=u.Json.readString(h.property))==null?void 0:f.replace(/^minecraft:/,"");switch(d){case"fishing_rod/cast":case"selected":case"carried":case"extended_view":return(A,I,x)=>{var C;return(C=x[d])!=null?C:!1};case"view_entity":return(A,I,x)=>{var C;return(C=x.context_entity_is_view_entity)!=null?C:!1};case"using_item":return(A,I,x)=>{var C;return((C=x.use_duration)!=null?C:-1)>=0};case"bundle/has_selected_item":return(A,I,x)=>{var C;return((C=x["bundle/selected_item"])!=null?C:-1)>=0};case"broken":return(A,I,x)=>{var N,P;const C=(N=A.getComponent("damage",I))==null?void 0:N.getAsNumber(),M=(P=A.getComponent("max_damage",I))==null?void 0:P.getAsNumber();return C!==void 0&&M!==void 0&&C>=M-1};case"damaged":return(A,I,x)=>{var N,P;const C=(N=A.getComponent("damage",I))==null?void 0:N.getAsNumber(),M=(P=A.getComponent("max_damage",I))==null?void 0:P.getAsNumber();return C!==void 0&&M!==void 0&&C>=1};case"has_component":const S=B.parse((p=u.Json.readString(h.component))!=null?p:""),E=(v=u.Json.readBoolean(h.ignore_default))!=null?v:!1;return(A,I,x)=>A.hasComponent(S,E?void 0:I);case"keybind_down":const y=(g=u.Json.readString(h.keybind))!=null?g:"";return(A,I,x)=>{var C,M;return(M=(C=x.keybind_down)==null?void 0:C.includes(y))!=null?M:!1};case"custom_model_data":const R=(w=u.Json.readInt(h.index))!=null?w:0;return(A,I,x)=>{const C=A.getComponent("custom_model_data",I);if(!(C!=null&&C.isCompound()))return!1;const M=C.getList("flags").getNumber(R);return M!==void 0&&M!==0};default:return console.warn(`[deepslate]: Unknown condition property '${d}'`),()=>!1}}}n.Condition=s;class a{constructor(h,d,f){this.property=h,this.cases=d,this.fallback=f}getMesh(h,d,f){var v,g,w;const p=this.property(h,d,f);return(w=(g=(v=p!==null?this.cases.get(p):void 0)!=null?v:this.fallback)==null?void 0:g.getMesh(h,d,f))!=null?w:js}static propertyFromJson(h){var f,p,v;const d=(f=u.Json.readString(h.property))==null?void 0:f.replace(/^minecraft:/,"");switch(d){case"main_hand":return(E,y,R)=>{var A;return(A=R.main_hand)!=null?A:"right"};case"display_context":return(E,y,R)=>{var A;return(A=R.display_context)!=null?A:"gui"};case"context_dimension":return(E,y,R)=>{var A,I;return(I=(A=R.context_dimension)==null?void 0:A.toString())!=null?I:null};case"charge_type":const g=B.create("firework_rocket");return(E,y,R)=>{const A=E.getComponent("charged_projectiles",y);return!(A!=null&&A.isList())||A.length===0?"none":A.filter(I=>I.isCompound()?B.parse(I.getString("id")).equals(g):!1).length>0?"rocket":"arrow"};case"trim_material":return(E,y,R)=>{const A=E.getComponent("trim",y);return A!=null&&A.isCompound()?B.parse(A.getString("material")).toString():null};case"block_state":const w=(p=u.Json.readString(h.block_state_property))!=null?p:"";return(E,y,R)=>{const A=E.getComponent("block_state",y);return A!=null&&A.isCompound()?A.getString(w):null};case"local_time":return(E,y,R)=>"NOT IMPLEMENTED";case"context_entity_type":return(E,y,R)=>{var A,I;return(I=(A=R.context_entity_type)==null?void 0:A.toString())!=null?I:null};case"custom_model_data":const S=(v=u.Json.readInt(h.index))!=null?v:0;return(E,y,R)=>{const A=E.getComponent("custom_model_data",y);if(!(A!=null&&A.isCompound()))return null;const I=A.getList("strings");return I.length<=S?null:I.getString(S)};default:return console.warn(`[deepslate]: Unknown select property '${d}'`),()=>null}}}n.Select=a;class o{constructor(h,d,f,p){_(this,"entries");this.property=h,this.scale=d,this.fallback=p,this.entries=f.sort((v,g)=>v.threshold-g.threshold)}getMesh(h,d,f){var g;const p=this.property(h,d,f)*this.scale;let v=this.fallback;for(const w of this.entries)if(w.threshold<=p)v=w.model;else break;return(g=v==null?void 0:v.getMesh(h,d,f))!=null?g:js}static propertyFromJson(h){var f,p,v,g,w,S,E;const d=(f=u.Json.readString(h.property))==null?void 0:f.replace(/^minecraft:/,"");switch(d){case"bundle/fullness":let y=function(C,M){const N=C.getComponent("bundle_contents",M);return N!=null&&N.isListOrArray()?N.map(H=>H.isCompound()?Yt.fromNbt(H):void 0).reduce((H,F)=>{var U,W;if(F===void 0)return H;if(F.hasComponent("bundle_contents",M))return H+y(F,M)+.0625;const T=F.getComponent("bees",M);if((T==null?void 0:T.isListOrArray())&&T.length>0)return H+1;const J=(W=(U=F.getComponent("max_stack_size",M))==null?void 0:U.getAsNumber())!=null?W:1;return H+F.count/J},0):0};return(C,M,N)=>y(C,M);case"damage":{const C=(p=u.Json.readBoolean(h.normalize))!=null?p:!0;return(M,N,P)=>{var T,J,U,W;const H=(J=(T=M.getComponent("max_damage",N))==null?void 0:T.getAsNumber())!=null?J:0,F=bt((W=(U=M.getComponent("damage",N))==null?void 0:U.getAsNumber())!=null?W:0,0,H);return C?bt(F/H,0,1):bt(F,0,H)}}case"count":{const C=(v=u.Json.readBoolean(h.normalize))!=null?v:!0;return(M,N,P)=>{var F,T;const H=(T=(F=M.getComponent("max_stack_size",N))==null?void 0:F.getAsNumber())!=null?T:1;return C?bt(M.count/H,0,1):bt(M.count,0,H)}}case"cooldown":return(C,M,N)=>{var F,T,J;const P=C.getComponent("use_cooldown",M),H=P!=null&&P.isCompound()?B.parse((F=P.getString("cooldown_group"))!=null?F:C.id):C.id;return(J=(T=N.cooldown_percentage)==null?void 0:T[H.toString()])!=null?J:0};case"time":switch((g=u.Json.readString(h.source))!=null?g:"daytime"){case"moon_phase":return(C,M,N)=>{var P;return((P=N.game_time)!=null?P:0)/24e3%8/8};case"random":return(C,M,N)=>Math.random();default:return(C,M,N)=>{var T;const H=((T=N.game_time)!=null?T:0)/24e3%1-.25,F=.5-Math.cos(H*Math.PI)/2;return(H*2+F)/3}}case"compass":return(C,M,N)=>{var P;return(P=N.compass_angle)!=null?P:0};case"crossbow/pull":return(C,M,N)=>{var P;return(P=N["crossbow/pull"])!=null?P:0};case"use_duration":const A=(w=u.Json.readBoolean(h.remaining))!=null?w:!0;return(C,M,N)=>{var P;return N.use_duration===void 0||N.use_duration<0?0:A?Math.max(((P=N.max_use_duration)!=null?P:0)-N.use_duration,0):N.use_duration};case"use_cycle":const I=(S=u.Json.readNumber(h.period))!=null?S:1;return(C,M,N)=>{var P,H;return N.use_duration===void 0||N.use_duration<0?0:Math.max(((P=N.max_use_duration)!=null?P:0)-((H=N.use_duration)!=null?H:0),0)%I};case"custom_model_data":const x=(E=u.Json.readInt(h.index))!=null?E:0;return(C,M,N)=>{const P=C.getComponent("custom_model_data",M);return P!=null&&P.isCompound()?P.getList("floats").getNumber(x):0};default:return console.warn(`[deepslate]: Unknown range dispatch property '${d}'`),()=>0}}}n.RangeDispatch=o;class m{constructor(h,d){this.specialModel=h,this.base=d}getMesh(h,d,f){var g;const p=this.specialModel.getMesh(h,d),v=d.getBlockModel(this.base);return v?(p.transform(v.getDisplayTransform((g=f.display_context)!=null?g:"gui")),p):(console.warn(`[deepslate]: Special model base '${this.base}' does not exist`),new rt)}}n.Special=m;class c{getMesh(h,d,f){const p=f["bundle/selected_item"];if(p===void 0||p<0)return new rt;const v=h.getComponent("bundle_contents",d);if(!(v!=null&&v.isListOrArray()))return new rt;const g=v.get(p);if(g===void 0||!g.isCompound())return new rt;const w=Yt.fromNbt(g);return dr.getItemMesh(w,d,{...f,"bundle/selected_item":-1,selected:!1,carried:!1,use_duration:-1})}}n.BundleSelectedItem=c})(u.ItemModel||(u.ItemModel={}));const au=`
  attribute vec4 vertPos;
  attribute vec3 blockPos;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = blockPos / 256.0;
  }
`,ou=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`,cu=`
  attribute vec4 vertPos;
  attribute vec3 vertColor;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = vertColor;
  }
`,lu=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`;class uu extends fr{constructor(e,r,i,s){var o,m;super(e);_(this,"gridShaderProgram");_(this,"colorShaderProgram");_(this,"gridMesh",new rt);_(this,"outlineMesh",new rt);_(this,"invisibleBlocksMesh",new rt);_(this,"atlasTexture");_(this,"useInvisibleBlocks");_(this,"chunkBuilder");this.structure=r,this.resources=i;const a=(o=s==null?void 0:s.chunkSize)!=null?o:16;this.chunkBuilder=new Xs(e,r,i,a),s!=null&&s.facesPerBuffer&&console.warn("[deepslate renderer warning]: facesPerBuffer option has been removed in favor of chunkSize"),this.useInvisibleBlocks=(m=s==null?void 0:s.useInvisibleBlockBuffer)!=null?m:!0,this.gridShaderProgram=new Bn(e,cu,lu).getProgram(),this.colorShaderProgram=new Bn(e,au,ou).getProgram(),this.gridMesh=this.getGridMesh(),this.outlineMesh=this.getOutlineMesh(),this.invisibleBlocksMesh=this.getInvisibleBlocksMesh(),this.atlasTexture=this.createAtlasTexture(this.resources.getTextureAtlas())}setStructure(e){this.structure=e,this.chunkBuilder.setStructure(e),this.gridMesh=this.getGridMesh(),this.invisibleBlocksMesh=this.getInvisibleBlocksMesh()}updateStructureBuffers(e){this.chunkBuilder.updateStructureBuffers(e)}getGridMesh(){const[e,r,i]=this.structure.getSize(),s=new rt;s.addLine(0,0,0,e,0,0,[1,0,0]),s.addLine(0,0,0,0,0,i,[0,0,1]);const a=[.8,.8,.8];s.addLine(0,0,0,0,r,0,a),s.addLine(e,0,0,e,r,0,a),s.addLine(0,0,i,0,r,i,a),s.addLine(e,0,i,e,r,i,a),s.addLine(0,r,0,0,r,i,a),s.addLine(e,r,0,e,r,i,a),s.addLine(0,r,0,e,r,0,a),s.addLine(0,r,i,e,r,i,a);for(let o=1;o<=e;o+=1)s.addLine(o,0,0,o,0,i,a);for(let o=1;o<=i;o+=1)s.addLine(0,0,o,e,0,o,a);return s.rebuild(this.gl,{pos:!0,color:!0})}getOutlineMesh(){return new rt().addLineCube(0,0,0,1,1,1,[1,1,1]).rebuild(this.gl,{pos:!0,color:!0})}getInvisibleBlocksMesh(){const e=new rt;if(!this.useInvisibleBlocks)return e;const r=this.structure.getSize();for(let i=0;i<r[0];i+=1)for(let s=0;s<r[1];s+=1)for(let a=0;a<r[2];a+=1){const o=this.structure.getBlock([i,s,a]);o!==void 0&&(o===null?e.addLineCube(i+.4375,s+.4375,a+.4375,i+.5625,s+.5625,a+.5625,[1,.25,.25]):o.state.is(X.AIR)?e.addLineCube(i+.375,s+.375,a+.375,i+.625,s+.625,a+.625,[.5,.5,1]):o.state.is(new X("cave_air"))&&e.addLineCube(i+.375,s+.375,a+.375,i+.625,s+.625,a+.625,[.5,1,.5]))}return e.rebuild(this.gl,{pos:!0,color:!0})}drawGrid(e){this.setShader(this.gridShaderProgram),this.prepareDraw(e),this.drawMesh(this.gridMesh,{pos:!0,color:!0})}drawInvisibleBlocks(e){!this.useInvisibleBlocks||(this.setShader(this.gridShaderProgram),this.prepareDraw(e),this.drawMesh(this.invisibleBlocksMesh,{pos:!0,color:!0}))}drawStructure(e){var r,i;this.setShader(this.shaderProgram),this.setTexture(this.atlasTexture,(i=(r=this.resources).getPixelSize)==null?void 0:i.call(r)),this.prepareDraw(e),this.chunkBuilder.getMeshes().forEach(s=>{this.drawMesh(s,{pos:!0,color:!0,texture:!0,normal:!0})})}drawColoredStructure(e){this.setShader(this.colorShaderProgram),this.prepareDraw(e),this.chunkBuilder.getMeshes().forEach(r=>{this.drawMesh(r,{pos:!0,color:!0,normal:!0,blockPos:!0})})}drawOutline(e,r){this.setShader(this.gridShaderProgram);const i=it();Rl(i,e),q(i,i,r),this.prepareDraw(i),this.drawMesh(this.outlineMesh,{pos:!0,color:!0})}}class Tn{constructor(t,e){_(this,"part");if(this.img=t,this.idMap=e,!jr(t.width)||!jr(t.height))throw new Error(`Expected texture atlas dimensions to be powers of two, got ${t.width}x${t.height}.`);this.part=16/t.width}getTextureAtlas(){return this.img}getTextureUV(t){var e;return(e=this.idMap[t.toString()])!=null?e:[0,0,this.part,this.part]}getPixelSize(){return this.part/16}static async fromBlobs(t){const e=Math.sqrt(Object.keys(t).length+1),r=Hs(e),i=r*16,s=1/r,a=document.createElement("canvas");a.width=i,a.height=i;const o=a.getContext("2d");this.drawInvalidTexture(o);const m={};let c=1;return await Promise.all(Object.keys(t).map(async l=>{const h=c%r,d=Math.floor(c/r);c+=1,m[l]=[s*h,s*d,s*h+s,s*d+s];const f=await createImageBitmap(t[l]);o.drawImage(f,0,0,16,16,16*h,16*d,16,16)})),new Tn(o.getImageData(0,0,i,i),m)}static empty(){const t=document.createElement("canvas");t.width=16,t.height=16;const e=t.getContext("2d");return Tn.drawInvalidTexture(e),new Tn(e.getImageData(0,0,16,16),{})}static drawInvalidTexture(t){t.fillStyle="black",t.fillRect(0,0,16,16),t.fillStyle="magenta",t.fillRect(0,0,8,8),t.fillRect(8,8,8,8)}}const hu=`
  attribute vec4 vertPos;
  attribute vec3 vertColor;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = vertColor;
  }
`,fu=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`;class du extends fr{constructor(e){super(e);_(this,"voxelShaderProgram");_(this,"voxels",[]);_(this,"quads",[]);_(this,"meshes",[]);this.voxelShaderProgram=new Bn(e,hu,fu).getProgram()}setVoxels(e){this.voxels=e,this.quads=this.getQuads(),this.meshes=this.getMeshes()}getQuads(){var i,s,a,o,m,c,l,h,d,f,p,v;const e=new Map;for(const g of this.voxels)_r(e,g.x,new Map,w=>{_r(w,g.y,new Set,S=>{S.add(g.z)})});const r=[];for(const g of this.voxels)(s=(i=e.get(g.x+1))==null?void 0:i.get(g.y))!=null&&s.has(g.z)||r.push(Wt.fromPoints(new $(g.x+1,g.y,g.z),new $(g.x+1,g.y+1,g.z),new $(g.x+1,g.y+1,g.z+1),new $(g.x+1,g.y,g.z+1)).setColor(g.color)),(o=(a=e.get(g.x-1))==null?void 0:a.get(g.y))!=null&&o.has(g.z)||r.push(Wt.fromPoints(new $(g.x,g.y,g.z+1),new $(g.x,g.y+1,g.z+1),new $(g.x,g.y+1,g.z),new $(g.x,g.y,g.z)).setColor(g.color)),(c=(m=e.get(g.x))==null?void 0:m.get(g.y+1))!=null&&c.has(g.z)||r.push(Wt.fromPoints(new $(g.x,g.y+1,g.z+1),new $(g.x+1,g.y+1,g.z+1),new $(g.x+1,g.y+1,g.z),new $(g.x,g.y+1,g.z)).setColor(g.color)),(h=(l=e.get(g.x))==null?void 0:l.get(g.y-1))!=null&&h.has(g.z)||r.push(Wt.fromPoints(new $(g.x,g.y,g.z),new $(g.x+1,g.y,g.z),new $(g.x+1,g.y,g.z+1),new $(g.x,g.y,g.z+1)).setColor(g.color)),(f=(d=e.get(g.x))==null?void 0:d.get(g.y))!=null&&f.has(g.z+1)||r.push(Wt.fromPoints(new $(g.x,g.y,g.z+1),new $(g.x+1,g.y,g.z+1),new $(g.x+1,g.y+1,g.z+1),new $(g.x,g.y+1,g.z+1)).setColor(g.color)),(v=(p=e.get(g.x))==null?void 0:p.get(g.y))!=null&&v.has(g.z-1)||r.push(Wt.fromPoints(new $(g.x,g.y+1,g.z),new $(g.x+1,g.y+1,g.z),new $(g.x+1,g.y,g.z),new $(g.x,g.y,g.z)).setColor(g.color));return console.debug(`Converted ${this.voxels.length} voxels into ${r.length} quads!`),r}getMeshes(){const e=[];let r=new rt;for(const i of this.quads){const s=i.normal(),a=(s.y*.25+Math.abs(s.z)*.125+.75)/256;i.forEach(o=>o.color=[o.color[0]*a,o.color[1]*a,o.color[2]*a]),r.quads.push(i),r.quadVertices()>65e3&&(e.push(r),r=new rt)}r.isEmpty()||e.push(r);for(const i of e)i.rebuild(this.gl,{pos:!0,color:!0});return e}draw(e){if(console.debug(`Drawing ${this.meshes.length} meshes...`),this.setShader(this.voxelShaderProgram),this.prepareDraw(e),this.meshes.length===0){this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);return}for(const r of this.meshes)this.drawMesh(r,{pos:!0,color:!0})}}u.NoiseRouter=void 0,(n=>{const t=o=>new Y.HolderHolder(u.Holder.parser(u.WorldgenRegistries.DENSITY_FUNCTION,Y.fromJson)(o));function e(o){var c;const m=(c=u.Json.readObject(o))!=null?c:{};return{barrier:t(m.barrier),fluidLevelFloodedness:t(m.fluid_level_floodedness),fluidLevelSpread:t(m.fluid_level_spread),lava:t(m.lava),temperature:t(m.temperature),vegetation:t(m.vegetation),continents:t(m.continents),erosion:t(m.erosion),depth:t(m.depth),ridges:t(m.ridges),preliminarySurfaceLevel:t(m.preliminary_surface_level),finalDensity:t(m.final_density),veinToggle:t(m.vein_toggle),veinRidged:t(m.vein_ridged),veinGap:t(m.vein_gap)}}n.fromJson=e;function r(o){return{barrier:Y.Constant.ZERO,fluidLevelFloodedness:Y.Constant.ZERO,fluidLevelSpread:Y.Constant.ZERO,lava:Y.Constant.ZERO,temperature:Y.Constant.ZERO,vegetation:Y.Constant.ZERO,continents:Y.Constant.ZERO,erosion:Y.Constant.ZERO,depth:Y.Constant.ZERO,ridges:Y.Constant.ZERO,preliminarySurfaceLevel:Y.Constant.ZERO,finalDensity:Y.Constant.ZERO,veinToggle:Y.Constant.ZERO,veinRidged:Y.Constant.ZERO,veinGap:Y.Constant.ZERO,...o}}n.create=r;function i(o,m){return{barrier:o.barrier.mapAll(m),fluidLevelFloodedness:o.fluidLevelFloodedness.mapAll(m),fluidLevelSpread:o.fluidLevelSpread.mapAll(m),lava:o.lava.mapAll(m),temperature:o.temperature.mapAll(m),vegetation:o.vegetation.mapAll(m),continents:o.continents.mapAll(m),erosion:o.erosion.mapAll(m),depth:o.depth.mapAll(m),ridges:o.ridges.mapAll(m),preliminarySurfaceLevel:o.preliminarySurfaceLevel.mapAll(m),finalDensity:o.finalDensity.mapAll(m),veinToggle:o.veinToggle.mapAll(m),veinRidged:o.veinRidged.mapAll(m),veinGap:o.veinGap.mapAll(m)}}n.mapAll=i;const s=new Map;function a(o,m){var f;const c=(f=m.key())==null?void 0:f.toString();if(!c)throw new Error("Cannot instantiate noise from direct holder");const l=o.seedKey(),h=s.get(c);if(h&&h[0]===l[0]&&h[1]===l[1])return h[2];const d=new se(o.fromHashOf(c),m.value());return s.set(c,[l[0],l[1],d]),d}n.instantiate=a})(u.NoiseRouter||(u.NoiseRouter={})),u.NoiseSettings=void 0,(n=>{function t(o){var c,l,h,d,f;const m=(c=u.Json.readObject(o))!=null?c:{};return{minY:(l=u.Json.readInt(m.min_y))!=null?l:0,height:(h=u.Json.readInt(m.height))!=null?h:256,xzSize:(d=u.Json.readInt(m.size_horizontal))!=null?d:1,ySize:(f=u.Json.readInt(m.size_vertical))!=null?f:1}}n.fromJson=t;function e(o){return{minY:0,height:256,xzSize:1,ySize:1,...o}}n.create=e;function r(o){return o.ySize<<2}n.cellHeight=r;function i(o){return o.xzSize<<2}n.cellWidth=i;function s(o){return o.height/r(o)}n.cellCountY=s;function a(o){return Math.floor(o.minY/r(o))}n.minCellY=a})(u.NoiseSettings||(u.NoiseSettings={})),u.NoiseSlideSettings=void 0,(n=>{function t(r){var s,a,o,m;const i=(s=u.Json.readObject(r))!=null?s:{};return{target:(a=u.Json.readNumber(i.target))!=null?a:0,size:(o=u.Json.readInt(i.size))!=null?o:0,offset:(m=u.Json.readInt(i.offset))!=null?m:0}}n.fromJson=t;function e(r,i,s){if(r.size<=0)return i;const a=(s-r.offset)/r.size;return nr(r.target,i,a)}n.apply=e})(u.NoiseSlideSettings||(u.NoiseSlideSettings={})),u.VerticalAnchor=void 0,(n=>{function t(s){var o,m,c,l;const a=(o=u.Json.readObject(s))!=null?o:{};return a.absolute!==void 0?e((m=u.Json.readNumber(a.absolute))!=null?m:0):a.above_bottom!==void 0?r((c=u.Json.readNumber(a.above_bottom))!=null?c:0):a.below_top!==void 0?i((l=u.Json.readNumber(a.below_top))!=null?l:0):()=>0}n.fromJson=t;function e(s){return()=>s}n.absolute=e;function r(s){return a=>a.minY+s}n.aboveBottom=r;function i(s){return a=>a.minY+a.height-1-s}n.belowTop=i})(u.VerticalAnchor||(u.VerticalAnchor={}));class Ks{constructor(t,e,r){_(this,"surfaceNoise");_(this,"surfaceSecondaryNoise");_(this,"random");_(this,"positionalRandoms");this.rule=t,this.defaultBlock=e,this.random=st.create(r).forkPositional(),this.surfaceNoise=u.NoiseRouter.instantiate(this.random,u.WorldgenRegistries.SURFACE_NOISE),this.surfaceSecondaryNoise=u.NoiseRouter.instantiate(this.random,u.WorldgenRegistries.SURFACE_SECONDARY_NOISE),this.positionalRandoms=new Map}buildSurface(t,e,r,i){const s=u.ChunkPos.minBlockX(t.pos),a=u.ChunkPos.minBlockZ(t.pos),o=new Qs(this,t,e,r,i),m=this.rule(o);for(let c=0;c<16;c+=1){const l=s+c;for(let h=0;h<1;h+=1){const d=a+h;o.updateXZ(l,d);let f=0,p=Number.MIN_SAFE_INTEGER,v=Number.MAX_SAFE_INTEGER;for(let g=t.maxY;g>=t.minY;g-=1){const w=u.BlockPos.create(l,g,d),S=t.getBlockState(w);if(S.equals(X.AIR)){f=0,p=Number.MIN_SAFE_INTEGER;continue}if(S.isFluid()){p===Number.MIN_SAFE_INTEGER&&(p=g+1);continue}if(v>=g){v=Number.MIN_SAFE_INTEGER;for(let R=g-1;R>=t.minY;R-=1){const A=t.getBlockState(u.BlockPos.create(l,R,d));if(A.equals(X.AIR)||A.isFluid()){v=R+1;break}}}f+=1;const E=g-v+1;if(!S.equals(this.defaultBlock))continue;o.updateY(f,E,p,g);const y=m(l,g,d);y&&t.setBlockState(w,y)}}}}getSurfaceDepth(t,e){const r=this.surfaceNoise.sample(t,0,e),i=this.random.at(t,0,e).nextDouble()*.25;return r*2.75+3+i}getSurfaceSecondary(t,e){return this.surfaceSecondaryNoise.sample(t,0,e)}getRandom(t){return Ee(this.positionalRandoms,t,()=>this.random.fromHashOf(t))}}class Qs{constructor(t,e,r,i,s){_(this,"blockX",0);_(this,"blockY",0);_(this,"blockZ",0);_(this,"stoneDepthAbove",0);_(this,"stoneDepthBelow",0);_(this,"surfaceDepth",0);_(this,"waterHeight",0);_(this,"biome",()=>"");_(this,"surfaceSecondary",()=>0);_(this,"minSurfaceLevel",()=>0);this.system=t,this.chunk=e,this.noiseChunk=r,this.context=i,this.getBiome=s}updateXZ(t,e){this.blockX=t,this.blockZ=e,this.surfaceDepth=this.system.getSurfaceDepth(t,e),this.surfaceSecondary=an(()=>this.system.getSurfaceSecondary(t,e)),this.minSurfaceLevel=an(()=>this.calculateMinSurfaceLevel(t,e))}updateY(t,e,r,i){this.blockY=i,this.stoneDepthAbove=t,this.stoneDepthBelow=e,this.waterHeight=r,this.biome=an(()=>this.getBiome(u.BlockPos.create(this.blockX,this.blockY,this.blockZ)))}calculateMinSurfaceLevel(t,e){const r=t>>4,i=e>>4,s=this.noiseChunk.getPreliminarySurfaceLevel(r<<4,i<<4),a=this.noiseChunk.getPreliminarySurfaceLevel(r+1<<4,i<<4),o=this.noiseChunk.getPreliminarySurfaceLevel(r<<4,i+1<<4),m=this.noiseChunk.getPreliminarySurfaceLevel(r+1<<4,i+1<<4);return Math.floor(er((t&15)/16,(e&15)/16,s,a,o,m))+this.surfaceDepth-8}}u.SurfaceRule=void 0,(n=>{n.NOOP=()=>()=>{};function t(s){var m,c,l;const a=(m=u.Json.readObject(s))!=null?m:{};switch((c=u.Json.readString(a.type))==null?void 0:c.replace(/^minecraft:/,"")){case"block":return e(X.fromJson(a.result_state));case"sequence":return r((l=u.Json.readArray(a.sequence,n.fromJson))!=null?l:[]);case"condition":return i(u.SurfaceCondition.fromJson(a.if_true),n.fromJson(a.then_run))}return n.NOOP}n.fromJson=t;function e(s){return()=>()=>s}n.block=e;function r(s){return a=>{const o=s.map(m=>m(a));return(m,c,l)=>{for(const h of o){const d=h(m,c,l);if(d)return d}}}}n.sequence=r;function i(s,a){return o=>(m,c,l)=>{if(s(o))return a(o)(m,c,l)}}n.condition=i})(u.SurfaceRule||(u.SurfaceRule={})),u.SurfaceCondition=void 0,(n=>{n.FALSE=()=>!1,n.TRUE=()=>!0;function t(c){var d,f,p,v,g,w,S,E,y,R,A,I;const l=(d=u.Json.readObject(c))!=null?d:{};switch((f=u.Json.readString(l.type))==null?void 0:f.replace(/^minecraft:/,"")){case"above_preliminary_surface":return e();case"biome":return r((p=u.Json.readArray(l.biome_is,x=>{var C;return(C=u.Json.readString(x))!=null?C:""}))!=null?p:[]);case"not":return i(n.fromJson(l.invert));case"stone_depth":return s((v=u.Json.readInt(l.offset))!=null?v:0,(g=u.Json.readBoolean(l.add_surface_depth))!=null?g:!1,(w=u.Json.readInt(l.secondary_depth_range))!=null?w:0,u.Json.readString(l.surface_type)==="ceiling");case"vertical_gradient":return a((S=u.Json.readString(l.random_name))!=null?S:"",u.VerticalAnchor.fromJson(l.true_at_and_below),u.VerticalAnchor.fromJson(l.false_at_and_above));case"water":return o((E=u.Json.readInt(l.offset))!=null?E:0,(y=u.Json.readInt(l.surface_depth_multiplier))!=null?y:0,(R=u.Json.readBoolean(l.add_surface_depth))!=null?R:!1);case"y_above":return m(u.VerticalAnchor.fromJson(l.anchor),(A=u.Json.readInt(l.surface_depth_multiplier))!=null?A:0,(I=u.Json.readBoolean(l.add_surface_depth))!=null?I:!1)}return n.FALSE}n.fromJson=t;function e(){return c=>c.blockY>=c.minSurfaceLevel()}n.abovePreliminarySurface=e;function r(c){const l=new Set(c);return h=>l.has(h.biome())}n.biome=r;function i(c){return l=>!c(l)}n.not=i;function s(c,l,h,d){return f=>{const p=d?f.stoneDepthBelow:f.stoneDepthAbove,v=l?f.surfaceDepth:0,g=h===0?0:xn(f.surfaceSecondary(),-1,1,0,h);return p<=1+c+v+g}}n.stoneDepth=s;function a(c,l,h){return d=>{const f=l(d.context),p=h(d.context);if(d.blockY<=f)return!0;if(d.blockY>=p)return!1;const v=d.system.getRandom(c),g=xn(d.blockY,f,p,1,0);return v.nextFloat()<g}}n.verticalGradient=a;function o(c,l,h){return d=>{if(d.waterHeight===Number.MIN_SAFE_INTEGER)return!0;const f=h?d.stoneDepthAbove:0;return d.blockY+f>=d.waterHeight+c+d.surfaceDepth*l}}n.water=o;function m(c,l,h){return d=>{const f=h?d.stoneDepthAbove:0;return d.blockY+f>=c(d.context)+d.surfaceDepth*l}}n.yAbove=m})(u.SurfaceCondition||(u.SurfaceCondition={})),u.NoiseGeneratorSettings=void 0,(n=>{function t(r){var s,a,o,m,c,l;const i=(s=u.Json.readObject(r))!=null?s:{};return{surfaceRule:u.SurfaceRule.fromJson(i.surface_rule),noise:u.NoiseSettings.fromJson(i.noise),defaultBlock:X.fromJson(i.default_block),defaultFluid:X.fromJson(i.default_fluid),noiseRouter:u.NoiseRouter.fromJson(i.noise_router),seaLevel:(a=u.Json.readInt(i.sea_level))!=null?a:0,disableMobGeneration:(o=u.Json.readBoolean(i.disable_mob_generation))!=null?o:!1,aquifersEnabled:(m=u.Json.readBoolean(i.aquifers_enabled))!=null?m:!1,oreVeinsEnabled:(c=u.Json.readBoolean(i.ore_veins_enabled))!=null?c:!1,legacyRandomSource:(l=u.Json.readBoolean(i.legacy_random_source))!=null?l:!1}}n.fromJson=t;function e(r){return{surfaceRule:u.SurfaceRule.NOOP,noise:u.NoiseSettings.create({}),defaultBlock:X.STONE,defaultFluid:X.WATER,noiseRouter:u.NoiseRouter.create({}),seaLevel:0,disableMobGeneration:!1,aquifersEnabled:!1,oreVeinsEnabled:!1,legacyRandomSource:!1,...r}}n.create=e})(u.NoiseGeneratorSettings||(u.NoiseGeneratorSettings={})),u.WorldgenRegistries=void 0,(n=>{n.NOISE=Rt.createAndRegister("worldgen/noise",u.NoiseParameters.fromJson),n.DENSITY_FUNCTION=Rt.createAndRegister("worldgen/density_function",e=>Y.fromJson(e)),n.NOISE_SETTINGS=Rt.createAndRegister("worldgen/noise_settings",u.NoiseGeneratorSettings.fromJson),n.BIOME=Rt.createAndRegister("worldgen/biome"),n.SURFACE_NOISE=t("surface",-6,[1,1,1]),n.SURFACE_SECONDARY_NOISE=t("surface_secondary",-6,[1,1,0,1]);function t(e,r,i){return n.NOISE.register(B.create(e),u.NoiseParameters.create(r,i),!0)}})(u.WorldgenRegistries||(u.WorldgenRegistries={}));class Y{minValue(){return-this.maxValue()}mapAll(t){return t.map(this)}}(n=>{function t(et,k,b){return{x:et,y:k,z:b}}n.context=t;class e extends n{constructor(k){super(),this.input=k}compute(k){return this.transform(k,this.input.compute(k))}}const r=u.Holder.parser(u.WorldgenRegistries.NOISE,u.NoiseParameters.fromJson);function i(et,k=i){var D,Z,Q,kt,At,St,lt,G,O,ut,rn,sn,Jn,zn,ci,li,ui,na,ra,ia,sa,aa;if(typeof et=="string")return new a(u.Holder.reference(u.WorldgenRegistries.DENSITY_FUNCTION,B.parse(et)));if(typeof et=="number")return new s(et);const b=(D=u.Json.readObject(et))!=null?D:{},L=(Z=u.Json.readString(b.type))==null?void 0:Z.replace(/^minecraft:/,"");switch(L){case"blend_alpha":return new o(1,0,1);case"blend_offset":return new o(0,-1/0,1/0);case"beardifier":return new o(0,-1/0,1/0);case"old_blended_noise":return new m((Q=u.Json.readNumber(b.xz_scale))!=null?Q:1,(kt=u.Json.readNumber(b.y_scale))!=null?kt:1,(At=u.Json.readNumber(b.xz_factor))!=null?At:80,(St=u.Json.readNumber(b.y_factor))!=null?St:160,(lt=u.Json.readNumber(b.smear_scale_multiplier))!=null?lt:8);case"flat_cache":return new l(k(b.argument));case"interpolated":return new p(k(b.argument));case"cache_2d":return new d(k(b.argument));case"cache_once":return new f(k(b.argument));case"cache_all_in_cell":return new h(k(b.argument));case"noise":return new v((G=u.Json.readNumber(b.xz_scale))!=null?G:1,(O=u.Json.readNumber(b.y_scale))!=null?O:1,r(b.noise));case"end_islands":return new g;case"find_top_surface":return new w(k(b.density),k(b.upper_bound),(ut=u.Json.readInt(b.lower_bound))!=null?ut:0,(rn=u.Json.readInt(b.cell_height))!=null?rn:1);case"weird_scaled_sampler":return new E(k(b.input),u.Json.readEnum(b.rarity_value_mapper,S),r(b.noise));case"shifted_noise":return new y(k(b.shift_x),k(b.shift_y),k(b.shift_z),(sn=u.Json.readNumber(b.xz_scale))!=null?sn:1,(Jn=u.Json.readNumber(b.y_scale))!=null?Jn:1,r(b.noise));case"range_choice":return new R(k(b.input),(zn=u.Json.readNumber(b.min_inclusive))!=null?zn:0,(ci=u.Json.readNumber(b.max_exclusive))!=null?ci:1,k(b.when_in_range),k(b.when_out_of_range));case"shift_a":return new I(r(b.argument));case"shift_b":return new x(r(b.argument));case"shift":return new C(r(b.argument));case"blend_density":return new M(k(b.argument));case"clamp":return new N(k(b.input),(li=u.Json.readNumber(b.min))!=null?li:0,(ui=u.Json.readNumber(b.max))!=null?ui:1);case"abs":case"square":case"cube":case"half_negative":case"invert":case"quarter_negative":case"squeeze":return new P(L,k(b.argument));case"add":case"mul":case"min":case"max":return new F(u.Json.readEnum(L,H),k(b.argument1),k(b.argument2));case"spline":return new T(u.CubicSpline.fromJson(b.spline,k));case"constant":return new s((na=u.Json.readNumber(b.argument))!=null?na:0);case"y_clamped_gradient":return new J((ra=u.Json.readInt(b.from_y))!=null?ra:-4064,(ia=u.Json.readInt(b.to_y))!=null?ia:4062,(sa=u.Json.readNumber(b.from_value))!=null?sa:-4064,(aa=u.Json.readNumber(b.to_value))!=null?aa:4062)}return s.ZERO}n.fromJson=i;const U=class extends n{constructor(k){super(),this.value=k}compute(){return this.value}minValue(){return this.value}maxValue(){return this.value}};let s=U;_(s,"ZERO",new U(0)),_(s,"ONE",new U(1)),n.Constant=s;class a extends n{constructor(k){super(),this.holder=k}compute(k){return this.holder.value().compute(k)}minValue(){return this.holder.value().minValue()}maxValue(){return this.holder.value().maxValue()}}n.HolderHolder=a;class o extends n.Constant{constructor(k,b,L){super(k),this.min=b,this.max=L}minValue(){return this.min}maxValue(){return this.max}}n.ConstantMinMax=o;class m extends n{constructor(k,b,L,D,Z,Q){super(),this.xzScale=k,this.yScale=b,this.xzFactor=L,this.yFactor=D,this.smearScaleMultiplier=Z,this.blendedNoise=Q}compute(k){var b,L;return(L=(b=this.blendedNoise)==null?void 0:b.sample(k.x,k.y,k.z))!=null?L:0}maxValue(){var k,b;return(b=(k=this.blendedNoise)==null?void 0:k.maxValue)!=null?b:0}}n.OldBlendedNoise=m;class c extends n{constructor(k){super(),this.wrapped=k}minValue(){return this.wrapped.minValue()}maxValue(){return this.wrapped.maxValue()}}class l extends c{constructor(b){super(b);_(this,"lastQuartX");_(this,"lastQuartZ");_(this,"lastValue",0)}compute(b){const L=b.x>>2,D=b.z>>2;return(this.lastQuartX!==L||this.lastQuartZ!==D)&&(this.lastValue=this.wrapped.compute(n.context(L<<2,0,D<<2)),this.lastQuartX=L,this.lastQuartZ=D),this.lastValue}mapAll(b){return b.map(new l(this.wrapped.mapAll(b)))}}n.FlatCache=l;class h extends c{constructor(k){super(k)}compute(k){return this.wrapped.compute(k)}mapAll(k){return k.map(new h(this.wrapped.mapAll(k)))}}n.CacheAllInCell=h;class d extends c{constructor(b){super(b);_(this,"lastBlockX");_(this,"lastBlockZ");_(this,"lastValue",0)}compute(b){const L=b.x,D=b.z;return(this.lastBlockX!==L||this.lastBlockZ!==D)&&(this.lastValue=this.wrapped.compute(b),this.lastBlockX=L,this.lastBlockZ=D),this.lastValue}mapAll(b){return b.map(new d(this.wrapped.mapAll(b)))}}n.Cache2D=d;class f extends c{constructor(b){super(b);_(this,"lastBlockX");_(this,"lastBlockY");_(this,"lastBlockZ");_(this,"lastValue",0)}compute(b){const L=b.x,D=b.y,Z=b.z;return(this.lastBlockX!==L||this.lastBlockY!==D||this.lastBlockZ!==Z)&&(this.lastValue=this.wrapped.compute(b),this.lastBlockX=L,this.lastBlockY=D,this.lastBlockZ=Z),this.lastValue}mapAll(b){return b.map(new f(this.wrapped.mapAll(b)))}}n.CacheOnce=f;class p extends c{constructor(b,L=4,D=4){super(b);_(this,"values");this.cellWidth=L,this.cellHeight=D,this.values=new Map}compute({x:b,y:L,z:D}){const Z=this.cellWidth,Q=this.cellHeight,kt=(b%Z+Z)%Z/Z,At=(L%Q+Q)%Q/Q,St=(D%Z+Z)%Z/Z,lt=Math.floor(b/Z)*Z,G=Math.floor(L/Q)*Q,O=Math.floor(D/Z)*Z;return zs(kt,At,St,()=>this.computeCorner(lt,G,O),()=>this.computeCorner(lt+Z,G,O),()=>this.computeCorner(lt,G+Q,O),()=>this.computeCorner(lt+Z,G+Q,O),()=>this.computeCorner(lt,G,O+Z),()=>this.computeCorner(lt+Z,G,O+Z),()=>this.computeCorner(lt,G+Q,O+Z),()=>this.computeCorner(lt+Z,G+Q,O+Z))}computeCorner(b,L,D){return Ee(this.values,`${b} ${L} ${D}`,()=>this.wrapped.compute(n.context(b,L,D)))}mapAll(b){return b.map(new p(this.wrapped.mapAll(b)))}withCellSize(b,L){return new p(this.wrapped,b,L)}}n.Interpolated=p;class v extends n{constructor(k,b,L,D){super(),this.xzScale=k,this.yScale=b,this.noiseData=L,this.noise=D}compute(k){var b,L;return(L=(b=this.noise)==null?void 0:b.sample(k.x*this.xzScale,k.y*this.yScale,k.z*this.xzScale))!=null?L:0}maxValue(){var k,b;return(b=(k=this.noise)==null?void 0:k.maxValue)!=null?b:2}}n.Noise=v;class g extends n{constructor(b){super();_(this,"islandNoise");const L=new ot(b!=null?b:BigInt(0));L.consume(17292),this.islandNoise=new pt(L)}getHeightValue(b,L){const D=Math.floor(b/2),Z=Math.floor(L/2),Q=b%2,kt=L%2;let At=bt(100-Math.sqrt(b*b+L*L)*8,-100,80);for(let St=-12;St<=12;St+=1)for(let lt=-12;lt<=12;lt+=1){const G=D+St,O=Z+lt;if(G*G+O*O<=4096||this.islandNoise.sample2D(G,O)>=-.9)continue;const ut=(Math.abs(G)*3439+Math.abs(O)*147)%13+9,rn=Q+St*2,sn=kt+lt*2,Jn=100-Math.sqrt(rn*rn+sn*sn)*ut,zn=bt(Jn,-100,80);At=Math.max(At,zn)}return At}compute({x:b,y:L,z:D}){return(this.getHeightValue(Math.floor(b/8),Math.floor(D/8))-8)/128}minValue(){return-.84375}maxValue(){return .5625}}n.EndIslands=g;class w extends n{constructor(k,b,L,D){super(),this.density=k,this.upperBound=b,this.lowerBound=L,this.cellHeight=D}compute(k){const b=Math.floor(this.upperBound.compute(k)/this.cellHeight)*this.cellHeight;if(b<this.lowerBound)return this.lowerBound;for(let L=b;L>=this.lowerBound;L-=this.cellHeight)if(this.density.compute(n.context(k.x,L,k.z))>0)return L;return this.lowerBound}mapAll(k){return k.map(new w(this.density.mapAll(k),this.upperBound.mapAll(k),this.lowerBound,this.cellHeight))}minValue(){return this.lowerBound}maxValue(){return Math.max(this.lowerBound,this.upperBound.maxValue())}}n.FindTopSurface=w;const S=["type_1","type_2"],W=class extends e{constructor(b,L,D,Z){super(b);_(this,"mapper");this.rarityValueMapper=L,this.noiseData=D,this.noise=Z,this.mapper=W.ValueMapper[this.rarityValueMapper]}transform(b,L){if(!this.noise)return 0;const D=this.mapper(L);return D*Math.abs(this.noise.sample(b.x/D,b.y/D,b.z/D))}mapAll(b){return b.map(new W(this.input.mapAll(b),this.rarityValueMapper,this.noiseData,this.noise))}minValue(){return 0}maxValue(){return this.rarityValueMapper==="type_1"?2:3}static rarityValueMapper1(b){return b<-.5?.75:b<0?1:b<.5?1.5:2}static rarityValueMapper2(b){return b<-.75?.5:b<-.5?.75:b<.5?1:b<.75?2:3}};let E=W;_(E,"ValueMapper",{type_1:W.rarityValueMapper1,type_2:W.rarityValueMapper2}),n.WeirdScaledSampler=E;class y extends v{constructor(k,b,L,D,Z,Q,kt){super(D,Z,Q,kt),this.shiftX=k,this.shiftY=b,this.shiftZ=L}compute(k){var Z,Q;const b=k.x*this.xzScale+this.shiftX.compute(k),L=k.y*this.yScale+this.shiftY.compute(k),D=k.z*this.xzScale+this.shiftZ.compute(k);return(Q=(Z=this.noise)==null?void 0:Z.sample(b,L,D))!=null?Q:0}mapAll(k){return k.map(new y(this.shiftX.mapAll(k),this.shiftY.mapAll(k),this.shiftZ.mapAll(k),this.xzScale,this.yScale,this.noiseData,this.noise))}}n.ShiftedNoise=y;class R extends n{constructor(k,b,L,D,Z){super(),this.input=k,this.minInclusive=b,this.maxExclusive=L,this.whenInRange=D,this.whenOutOfRange=Z}compute(k){const b=this.input.compute(k);return this.minInclusive<=b&&b<this.maxExclusive?this.whenInRange.compute(k):this.whenOutOfRange.compute(k)}mapAll(k){return k.map(new R(this.input.mapAll(k),this.minInclusive,this.maxExclusive,this.whenInRange.mapAll(k),this.whenOutOfRange.mapAll(k)))}minValue(){return Math.min(this.whenInRange.minValue(),this.whenOutOfRange.minValue())}maxValue(){return Math.max(this.whenInRange.maxValue(),this.whenOutOfRange.maxValue())}}n.RangeChoice=R;class A extends n{constructor(k,b){super(),this.noiseData=k,this.offsetNoise=b}compute(k){var b,L;return((L=(b=this.offsetNoise)==null?void 0:b.sample(k.x*.25,k.y*.25,k.z*.25))!=null?L:0)*4}maxValue(){var k,b;return((b=(k=this.offsetNoise)==null?void 0:k.maxValue)!=null?b:2)*4}}n.ShiftNoise=A;class I extends A{constructor(k,b){super(k,b)}compute(k){return super.compute(n.context(k.x,0,k.z))}withNewNoise(k){return new I(this.noiseData,k)}}n.ShiftA=I;class x extends A{constructor(k,b){super(k,b)}compute(k){return super.compute(n.context(k.z,k.x,0))}withNewNoise(k){return new x(this.noiseData,k)}}n.ShiftB=x;class C extends A{constructor(k,b){super(k,b)}withNewNoise(k){return new C(this.noiseData,k)}}n.Shift=C;class M extends e{constructor(k){super(k)}transform(k,b){return b}mapAll(k){return k.map(new M(this.input.mapAll(k)))}minValue(){return-1/0}maxValue(){return 1/0}}n.BlendDensity=M;class N extends e{constructor(k,b,L){super(k),this.min=b,this.max=L}transform(k,b){return bt(b,this.min,this.max)}mapAll(k){return k.map(new N(this.input.mapAll(k),this.min,this.max))}minValue(){return this.min}maxValue(){return this.max}}n.Clamp=N;const j=class extends e{constructor(b,L,D,Z){super(L);_(this,"transformer");this.type=b,this.min=D,this.max=Z,this.transformer=j.MappedTypes[this.type]}transform(b,L){return this.transformer(L)}mapAll(b){return b.map(new j(this.type,this.input.mapAll(b)))}minValue(){var b;return(b=this.min)!=null?b:-1/0}maxValue(){var b;return(b=this.max)!=null?b:1/0}withMinMax(){const b=this.input.minValue();let L=this.transformer(b),D=this.transformer(this.input.maxValue());return this.type==="invert"?L<0&&D>0?[L,D]=[-1/0,1/0]:[L,D]=[D,L]:(this.type==="abs"||this.type==="square")&&(D=Math.max(L,D),L=Math.max(0,b)),new j(this.type,this.input,L,D)}};let P=j;_(P,"MappedTypes",{abs:b=>Math.abs(b),square:b=>b*b,cube:b=>b*b*b,half_negative:b=>b>0?b:b*.5,invert:b=>1/b,quarter_negative:b=>b>0?b:b*.25,squeeze:b=>{const L=bt(b,-1,1);return L/2-L*L*L/24}}),n.Mapped=P;const H=["add","mul","min","max"];class F extends n{constructor(k,b,L,D,Z){super(),this.type=k,this.argument1=b,this.argument2=L,this.min=D,this.max=Z}compute(k){const b=this.argument1.compute(k);switch(this.type){case"add":return b+this.argument2.compute(k);case"mul":return b===0?0:b*this.argument2.compute(k);case"min":return b<this.argument2.minValue()?b:Math.min(b,this.argument2.compute(k));case"max":return b>this.argument2.maxValue()?b:Math.max(b,this.argument2.compute(k))}}mapAll(k){return k.map(new F(this.type,this.argument1.mapAll(k),this.argument2.mapAll(k)))}minValue(){var k;return(k=this.min)!=null?k:-1/0}maxValue(){var k;return(k=this.max)!=null?k:1/0}withMinMax(){const k=this.argument1.minValue(),b=this.argument2.minValue(),L=this.argument1.maxValue(),D=this.argument2.maxValue();(this.type==="min"||this.type==="max")&&(k>=D||b>=L)&&console.warn(`Creating a ${this.type} function between two non-overlapping inputs`);let Z,Q;switch(this.type){case"add":Z=k+b,Q=L+D;break;case"mul":Z=k>0&&b>0?k*b||0:L<0&&D<0?L*D||0:Math.min(k*D||0,b*L||0),Q=k>0&&b>0?L*D||0:L<0&&D<0?k*b||0:Math.max(k*b||0,L*D||0);break;case"min":Z=Math.min(k,b),Q=Math.min(L,D);break;case"max":Z=Math.max(k,b),Q=Math.max(L,D);break}return new F(this.type,this.argument1,this.argument2,Z,Q)}}n.Ap2=F;class T extends n{constructor(k){super(),this.spline=k}compute(k){return this.spline.compute(k)}mapAll(k){const b=this.spline.mapAll(L=>L instanceof n?L.mapAll(k):L);return b.calculateMinMax(),k.map(new T(b))}minValue(){return this.spline.min()}maxValue(){return this.spline.max()}}n.Spline=T;class J extends n{constructor(k,b,L,D){super(),this.fromY=k,this.toY=b,this.fromValue=L,this.toValue=D}compute(k){return Wr(k.y,this.fromY,this.toY,this.fromValue,this.toValue)}minValue(){return Math.min(this.fromValue,this.toValue)}maxValue(){return Math.max(this.fromValue,this.toValue)}}n.YClampedGradient=J})(Y||(Y={}));class Ln{constructor(t,e){this.level=t,this.type=e}at(t){return t<this.level?this.type:X.AIR}}u.Aquifer=void 0,(n=>{function t(e){return{compute({x:r,y:i,z:s},a){if(!(a>0))return e(r,i,s).at(i)}}}n.createDisabled=t})(u.Aquifer||(u.Aquifer={}));const Jt=class{constructor(t,e,r,i,s,a,o){_(this,"minGridX");_(this,"minGridY");_(this,"minGridZ");_(this,"gridSizeX");_(this,"gridSizeZ");_(this,"gridSize");_(this,"aquiferCache");_(this,"aquiferLocationCache");this.noiseChunk=t,this.router=r,this.random=i,this.globalFluidPicker=o,this.minGridX=this.gridX(u.ChunkPos.minBlockX(e))-1,this.gridSizeX=this.gridX(u.ChunkPos.maxBlockX(e))+1-this.minGridX+1,this.minGridY=this.gridY(s)-1,this.minGridZ=this.gridZ(u.ChunkPos.minBlockZ(e))-1,this.gridSizeZ=this.gridZ(u.ChunkPos.maxBlockZ(e))+1-this.minGridZ+1;const m=this.gridY(s+a)+1-this.minGridY+1;this.gridSize=this.gridSizeX*m*this.gridSizeZ,this.aquiferCache=Array(this.gridSize).fill(void 0),this.aquiferLocationCache=Array(this.gridSize).fill(u.BlockPos.ZERO)}compute({x:t,y:e,z:r},i){if(i<=0){if(this.globalFluidPicker(t,e,r).at(e).is(X.LAVA))return X.LAVA;{const s=this.gridX(t-5),a=this.gridY(e+1),o=this.gridZ(r-5);let m=Number.MAX_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,h=u.BlockPos.ZERO,d=u.BlockPos.ZERO,f=u.BlockPos.ZERO;for(let R=0;R<=1;R+=1)for(let A=-1;A<=1;A+=1)for(let I=0;I<=1;I+=1){const x=this.getLocation(s+R,a+A,o+I),C=u.BlockPos.magnitude(x);m>=C?(f=d,d=h,h=x,l=c,c=m,m=C):c>=C?(f=d,d=x,l=c,c=C):l>=C&&(f=x,l=C)}const p=this.getStatus(h),v=this.getStatus(d),g=this.getStatus(f),w=Jt.similarity(m,c),S=Jt.similarity(m,l),E=Jt.similarity(c,l);let y;if(p.at(e).is(X.WATER)&&this.globalFluidPicker(t,e-1,r).at(e-1).is(X.LAVA))y=1;else if(w>-1){const R=an(()=>this.router.barrier.compute(Y.context(t,e*.5,r))),A=this.calculatePressure(e,p,v,R),I=this.calculatePressure(e,p,g,R),x=this.calculatePressure(e,v,g,R),C=Math.max(A,I*Math.max(0,S),x*Math.max(E));y=Math.max(0,2*Math.max(0,w)*C)}else y=0;if(i+y<=0)return p.at(e)}}}static similarity(t,e){return 1-Math.abs(e-t)/25}calculatePressure(t,e,r,i){const s=e.at(t),a=r.at(t);if(s.is(X.LAVA)&&a.is(X.WATER)||s.is(X.WATER)&&a.is(X.LAVA))return 1;const o=Math.abs(e.level-r.level);if(o===0)return 0;const m=(e.level+r.level)/2,c=t+.5-m,l=o/2-Math.abs(c),h=c>0?l>0?l/1.5:l/2.5:l>-3?(l+3)/3:(l+3)/10;return h<-2||h>2?h:h+i()}getStatus(t){const[e,r,i]=t,s=this.getIndex(this.gridX(e),this.gridY(r),this.gridZ(i)),a=this.aquiferCache[s];if(a!==void 0)return a;const o=this.computeStatus(e,r,i);return this.aquiferCache[s]=o,o}computeStatus(t,e,r){const i=this.globalFluidPicker(t,e,r);let s=Number.MAX_SAFE_INTEGER,a=!1;for(const[p,v]of Jt.SURFACE_SAMPLING){const g=t+(v<<4),w=r+(v<<4),S=this.noiseChunk.getPreliminarySurfaceLevel(g,w);s=Math.min(s,S);const E=p===0&&v===0;if(E&&e-12>S+8)return i;if(E||e+12>S+8){const y=this.globalFluidPicker(g,S+8,w);if(!y.at(S+8).is(X.AIR)){if(E)return y;a=!0}}}const o=a?Wr(s+8-e,0,64,1,0):0,m=bt(this.router.fluidLevelFloodedness.compute(Y.context(t,e*.67,r)),-1,1);if(m>xn(o,1,0,-.3,.8))return i;if(m<=xn(o,1,0,-.8,.4))return new Ln(Number.MIN_SAFE_INTEGER,i.type);const c=Math.floor(e/40),l=this.router.fluidLevelSpread.compute(Y.context(Math.floor(t/16),c,Math.floor(r/16))),h=c*40+20+Math.floor(l/3)*3,d=Math.min(s,h),f=this.getFluidType(t,e,r,i.type,h);return new Ln(d,f)}getFluidType(t,e,r,i,s){if(s<=-10){const a=this.router.lava.compute(Y.context(Math.floor(t/64),Math.floor(e/40),Math.floor(r/64)));if(Math.abs(a)>.3)return X.LAVA}return i}getLocation(t,e,r){const i=this.getIndex(t,e,r),s=this.aquiferLocationCache[i];if(u.BlockPos.equals(s,u.BlockPos.ZERO))return s;const a=this.random.at(t,e,r),o=u.BlockPos.create(t*Jt.X_SPACING+a.nextInt(10),e*Jt.Y_SPACING+a.nextInt(9),r*Jt.Z_SPACING+a.nextInt(10));return this.aquiferLocationCache[i]=o,o}getIndex(t,e,r){const i=t-this.minGridX,s=e-this.minGridY,a=r-this.minGridZ,o=(s*this.gridSizeZ+a)*this.gridSizeX+i;if(o<0||o>=this.gridSize)throw new Error(`Invalid aquifer index at ${t} ${e} ${r}: 0 <= ${o} < ${this.gridSize}`);return o}gridX(t){return Math.floor(t/Jt.X_SPACING)}gridY(t){return Math.floor(t/Jt.Y_SPACING)}gridZ(t){return Math.floor(t/Jt.Z_SPACING)}};let ze=Jt;_(ze,"X_SPACING",16),_(ze,"Y_SPACING",12),_(ze,"Z_SPACING",16),_(ze,"SURFACE_SAMPLING",[[-2,-1],[-1,-1],[0,-1],[1,-1],[-3,0],[-2,0],[-1,0],[0,0],[1,0],[-2,1],[-1,1],[0,1],[1,1]]),u.HeightProvider=void 0,(n=>{function t(m){var h,d,f;const c=(h=u.Json.readObject(m))!=null?h:{};switch((d=u.Json.readString(c.type))==null?void 0:d.replace(/^minecraft:/,"")){case void 0:return e(u.VerticalAnchor.fromJson(m));case"constant":return e(u.VerticalAnchor.fromJson(c.value));case"uniform":return r(u.VerticalAnchor.fromJson(c.min_inclusive),u.VerticalAnchor.fromJson(c.max_inclusive));case"biased_to_bottom":return i(u.VerticalAnchor.fromJson(c.min_inclusive),u.VerticalAnchor.fromJson(c.max_inclusive),u.Json.readInt(c.inner));case"very_biased_to_bottom":return s(u.VerticalAnchor.fromJson(c.min_inclusive),u.VerticalAnchor.fromJson(c.max_inclusive),u.Json.readInt(c.inner));case"trapezoid":return a(u.VerticalAnchor.fromJson(c.min_inclusive),u.VerticalAnchor.fromJson(c.max_inclusive),u.Json.readInt(c.plateau));case"weighted_list":return o((f=u.Json.readArray(c.distribution,p=>{var g,w;const v=(g=u.Json.readObject(p))!=null?g:{};return{weight:(w=u.Json.readInt(v.weight))!=null?w:1,data:t(v.data)}}))!=null?f:[])}return()=>0}n.fromJson=t;function e(m){return(c,l)=>m(l)}n.constant=e;function r(m,c){return(l,h)=>{const d=m(h),f=c(h);return d>f?d:l.nextInt(f-d+1)+d}}n.uniform=r;function i(m,c,l=1){return(h,d)=>{const f=m(d),p=c(d);if(p-f-l+1<=0)return f;{const v=h.nextInt(p-f-l+1);return h.nextInt(v+l)+f}}}n.biased_to_bottom=i;function s(m,c,l=1){return(h,d)=>{const f=m(d),p=c(d);if(p-f-l+1<=0)return f;{const v=ar(h,f+l,p),g=ar(h,f,v-1);return ar(h,f,g-1+l)}}}n.very_biased_to_bottom=s;function a(m,c,l=0){return(h,d)=>{const f=m(d),p=c(d);if(f>p)return f;{const v=p-f;if(l>=v)return sr(h,f,p);{const g=(v-l)/2,w=v-g;return f+sr(h,0,w)+sr(h,0,g)}}}}n.trapezoid=a;function o(m){const c=m.reduce((l,h,d)=>l+h.weight,0);return(l,h)=>{let d=l.nextInt(c);for(const f of m)if(d-=f.weight,d<=0)return f.data(l,h);return 0}}n.weighted_list=o})(u.HeightProvider||(u.HeightProvider={})),u.Heightmap=void 0,(n=>{function t(e){if(typeof e=="string"&&(e==="WORLD_SURFACE_WG"||e==="WORLD_SURFACE"||e==="OCEAN_FLOOR_WG"||e==="OCEAN_FLOOR"||e==="MOTION_BLOCKING"||e==="MOTION_BLOCKING_NO_LEAVES"))return e}n.fromJson=t})(u.Heightmap||(u.Heightmap={}));class oi{constructor(t,e,r,i,s,a,o,m,c){_(this,"cellWidth");_(this,"cellHeight");_(this,"firstCellX");_(this,"firstCellZ");_(this,"firstNoiseX");_(this,"firstNoiseZ");_(this,"noiseSizeXZ");_(this,"preliminarySurfaceLevelCache",new Map);_(this,"aquifer");_(this,"materialRule");_(this,"preliminarySurfaceLevel");this.cellCountXZ=t,this.cellCountY=e,this.cellNoiseMinY=r,this.minX=s,this.minZ=a,this.settings=o,this.cellWidth=u.NoiseSettings.cellWidth(o),this.cellHeight=u.NoiseSettings.cellHeight(o),this.firstCellX=Math.floor(s/this.cellWidth),this.firstCellZ=Math.floor(a/this.cellWidth),this.firstNoiseX=s>>2,this.firstNoiseZ=a>>2,this.noiseSizeXZ=t*this.cellWidth>>2,this.aquifer=u.Aquifer.createDisabled(c);const l=i.router.finalDensity;this.materialRule=u.MaterialRule.fromList([h=>this.aquifer.compute(h,l.compute(h))]),this.preliminarySurfaceLevel=i.router.preliminarySurfaceLevel}getFinalState(t,e,r){return this.materialRule({x:t,y:e,z:r})}getPreliminarySurfaceLevel(t,e){return Ee(this.preliminarySurfaceLevelCache,u.ChunkPos.asLong(t,e),()=>{const r=t<<2,i=e<<2;return Math.floor(this.preliminarySurfaceLevel.compute(Y.context(r,0,i)))})}}u.MaterialRule=void 0,(n=>{function t(e){return r=>{for(const i of e){const s=i(r);if(s)return s}}}n.fromList=t})(u.MaterialRule||(u.MaterialRule={}));class ta{constructor(t,e){_(this,"noiseChunkCache");_(this,"globalFluidPicker");this.biomeSource=t,this.settings=e,this.noiseChunkCache=new Map;const r=new Ln(-54,X.LAVA),i=new Ln(e.seaLevel,e.defaultFluid);this.globalFluidPicker=(s,a,o)=>a<Math.min(-54,e.seaLevel)?r:i}getBaseHeight(t,e,r,i){var a;let s;return r==="OCEAN_FLOOR"||r==="OCEAN_FLOOR_WG"?s=o=>o.equals(X.STONE):s=o=>!o.equals(X.AIR),(a=this.iterateNoiseColumn(i,t,e,void 0,s,X.STONE))!=null?a:this.settings.noise.minY}iterateNoiseColumn(t,e,r,i,s,a){var v,g;const o=this.settings.noise.minY,m=u.NoiseSettings.cellHeight(this.settings.noise),c=Math.floor(o/m),l=Math.floor(this.settings.noise.height/m);if(l<=0)return;const h=u.NoiseSettings.cellWidth(this.settings.noise),d=Math.floor(e/h),f=Math.floor(r/h),p=new oi(1,l,c,t,d,f,this.settings.noise,this.settings.aquifersEnabled,this.globalFluidPicker);for(let w=l-1;w>=0;w-=1)for(let S=m-1;S>=0;S-=1){const E=(c+w)*m+S,y=(g=(v=p.getFinalState(e,E,r))!=null?v:a)!=null?g:this.settings.defaultBlock;if(i!==void 0&&(i[E+o]=y),s!==void 0&&s(y))return E+1}}fill(t,e,r=!1){var p;const i=Math.max(e.minY,this.settings.noise.minY),s=Math.min(e.maxY,this.settings.noise.minY+this.settings.noise.height),a=u.NoiseSettings.cellWidth(this.settings.noise),o=u.NoiseSettings.cellHeight(this.settings.noise),m=Math.floor(16/a),c=Math.floor(i/o),l=Math.floor((s-i)/o),h=u.ChunkPos.minBlockX(e.pos),d=u.ChunkPos.minBlockZ(e.pos),f=this.getOrCreateNoiseChunk(t,e);for(let v=0;v<m;v+=1)for(let g=0;g<(r?1:m);g+=1){let w=e.getOrCreateSection(e.sectionsCount-1);for(let S=l-1;S>=0;S-=1)for(let E=o-1;E>=0;E-=1){const y=(c+S)*o+E,R=y&15,A=e.getSectionIndex(y);e.getSectionIndex(w.minBlockY)!==A&&(w=e.getOrCreateSection(A));for(let I=0;I<a;I+=1){const x=h+v*a+I,C=x&15;for(let M=0;M<(r?1:a);M+=1){const N=d+g*a+M,P=N&15,H=(p=f.getFinalState(x,y,N))!=null?p:this.settings.defaultBlock;w.setBlockState(C,R,P,H)}}}}}buildSurface(t,e,r="minecraft:plains"){const i=this.getOrCreateNoiseChunk(t,e),s=this.settings.noise;t.surfaceSystem.buildSurface(e,i,s,()=>r)}computeBiome(t,e,r,i){return this.biomeSource.getBiome(e,r,i,t.sampler)}getOrCreateNoiseChunk(t,e){return Ee(this.noiseChunkCache,u.ChunkPos.toLong(e.pos),()=>{const r=Math.max(e.minY,this.settings.noise.minY),i=Math.min(e.maxY,this.settings.noise.minY+this.settings.noise.height),s=u.NoiseSettings.cellWidth(this.settings.noise),a=u.NoiseSettings.cellHeight(this.settings.noise),o=Math.floor(16/s),m=Math.floor(r/a),c=Math.floor((i-r)/a),l=u.ChunkPos.minBlockX(e.pos),h=u.ChunkPos.minBlockZ(e.pos);return new oi(o,c,m,t,l,h,this.settings.noise,this.settings.aquifersEnabled,this.globalFluidPicker)})}}class mr{constructor(t,e){_(this,"n");if(this.shift=t,this.biomes=e,e.length===0)throw new Error("Cannot create checkerboard biome source without biomes");this.n=e.length}getBiome(t,e,r){const i=(((t>>this.shift)+(r>>this.shift))%this.n+this.n)%this.n;return B.parse(this.biomes[i].toString())}static fromJson(t){var s,a,o;const e=(s=u.Json.readObject(t))!=null?s:{},r=(a=u.Json.readInt(e.scale))!=null?a:2;let i;return typeof e.biomes=="string"?i=[B.parse(e.biomes)]:i=(o=u.Json.readArray(e.biomes,m=>{var c;return B.parse((c=u.Json.readString(m))!=null?c:"")}))!=null?o:[],new mr(r+2,i)}}class Ke{constructor(t){this.biome=t}getBiome(){return this.biome}static fromJson(t){var i,s;const e=(i=u.Json.readObject(t))!=null?i:{},r=B.parse((s=u.Json.readString(e.biome))!=null?s:"plains");return new Ke(r)}}u.Climate=void 0,(n=>{function e(v,g,w,S,E,y){return new o(v,g,w,S,E,y)}n.target=e;function r(v,g,w,S,E,y,R){return new a(i(v),i(g),i(w),i(S),i(E),i(y),R)}n.parameters=r;function i(v,g){return typeof v=="number"?new s(v,g!=null?g:v):v}n.param=i;class s{constructor(g,w){this.min=g,this.max=w}distance(g){const w=(typeof g=="number"?g:g.min)-this.max,S=this.min-(typeof g=="number"?g:g.max);return w>0?w:Math.max(S,0)}union(g){return new s(Math.min(this.min,g.min),Math.max(this.max,g.max))}static fromJson(g){var E;if(typeof g=="number")return new s(g,g);const[w,S]=(E=u.Json.readArray(g,y=>u.Json.readNumber(y)))!=null?E:[];return new s(w!=null?w:0,S!=null?S:0)}}n.Param=s;class a{constructor(g,w,S,E,y,R,A){this.temperature=g,this.humidity=w,this.continentalness=S,this.erosion=E,this.depth=y,this.weirdness=R,this.offset=A}fittness(g){return re(this.temperature.distance(g.temperature))+re(this.humidity.distance(g.humidity))+re(this.continentalness.distance(g.continentalness))+re(this.erosion.distance(g.erosion))+re(this.depth.distance(g.depth))+re(this.weirdness.distance(g.weirdness))+re(this.offset-g.offset)}space(){return[this.temperature,this.humidity,this.continentalness,this.erosion,this.depth,this.weirdness,new s(this.offset,this.offset)]}static fromJson(g){var S,E;const w=(S=u.Json.readObject(g))!=null?S:{};return new a(s.fromJson(w.temperature),s.fromJson(w.humidity),s.fromJson(w.continentalness),s.fromJson(w.erosion),s.fromJson(w.depth),s.fromJson(w.weirdness),(E=u.Json.readNumber(w.offset))!=null?E:0)}}n.ParamPoint=a;class o{constructor(g,w,S,E,y,R){this.temperature=g,this.humidity=w,this.continentalness=S,this.erosion=E,this.depth=y,this.weirdness=R}get offset(){return 0}toArray(){return[this.temperature,this.humidity,this.continentalness,this.erosion,this.depth,this.weirdness,this.offset]}}n.TargetPoint=o;class m{constructor(g){_(this,"index");this.things=g,this.index=new l(g)}find(g){return this.index.search(g,(w,S)=>w.distance(S))}}n.Parameters=m;class c{constructor(g,w,S,E,y,R){this.temperature=g,this.humidity=w,this.continentalness=S,this.erosion=E,this.depth=y,this.weirdness=R}static fromRouter(g){return new n.Sampler(g.temperature,g.vegetation,g.continents,g.erosion,g.depth,g.ridges)}sample(g,w,S){const E=Y.context(g<<2,w<<2,S<<2);return n.target(this.temperature.compute(E),this.humidity.compute(E),this.continentalness.compute(E),this.erosion.compute(E),this.depth.compute(E),this.weirdness.compute(E))}}n.Sampler=c;const p=class{constructor(g){_(this,"root");_(this,"last_leaf",null);if(g.length===0)throw new Error("At least one point is required to build search tree");this.root=p.build(g.map(([w,S])=>new f(w,S)))}static build(g){if(g.length===1)return g[0];if(g.length<=p.CHILDREN_PER_NODE){const y=g.map(R=>{let A=0;for(let I=0;I<7;I+=1){const x=R.space[I];A+=Math.abs((x.min+x.max)/2)}return{key:A,node:R}}).sort((R,A)=>R.key-A.key).map(({node:R})=>R);return new d(y)}let w=1/0,S=-1,E=[];for(let y=0;y<7;++y){g=p.sort(g,y,!1),E=p.bucketize(g);let R=0;for(const A of E)R+=p.area(A.space);w>R&&(w=R,S=y)}return g=p.sort(g,S,!1),E=p.bucketize(g),E=p.sort(E,S,!0),new d(E.map(y=>p.build(y.children)))}static sort(g,w,S){return g.map(E=>{const y=E.space[w],R=(y.min+y.max)/2;return{key:S?Math.abs(R):R,node:E}}).sort((E,y)=>E.key-y.key).map(({node:E})=>E)}static bucketize(g){const w=[];let S=[];const E=Math.pow(10,Math.floor(Math.log(g.length-.01)/Math.log(10)));for(const y of g)S.push(y),!(S.length<E)&&(w.push(new d(S)),S=[]);return S.length!==0&&w.push(new d(S)),w}static area(g){let w=0;for(const S of g)w+=Math.abs(S.max-S.min);return w}search(g,w){const S=this.root.search(g.toArray(),this.last_leaf,w);return this.last_leaf=S,S.thing()}};let l=p;_(l,"CHILDREN_PER_NODE",10),n.RTree=l;class h{constructor(g){this.space=g}distance(g){let w=0;for(let S=0;S<7;S+=1)w+=re(this.space[S].distance(g[S]));return w}}n.RNode=h;class d extends h{constructor(g){super(d.buildSpace(g)),this.children=g}static buildSpace(g){let w=[...Array(7)].map(()=>new s(1/0,-1/0));for(const S of g)w=[...Array(7)].map((E,y)=>w[y].union(S.space[y]));return w}search(g,w,S){let E=w?S(w,g):1/0,y=w;for(const R of this.children){const A=S(R,g);if(E<=A)continue;const I=R.search(g,y,S);if(I===null)continue;const x=R==I?A:S(I,g);if(x===0)return I;E<=x||(E=x,y=I)}return y}}n.RSubTree=d;class f extends h{constructor(g,w){super(g.space()),this.thing=w}search(){return this}}n.RLeaf=f})(u.Climate||(u.Climate={}));class gr{constructor(t){_(this,"parameters");this.parameters=new u.Climate.Parameters(t)}getBiome(t,e,r,i){const s=i.sample(t,e,r);return this.parameters.find(s)}static fromJson(t){var s,a;const e=(s=u.Json.readObject(t))!=null?s:{},i=((a=u.Json.readArray(e.biomes,o=>{var m;return(c=>{var l;return{biome:B.parse((l=u.Json.readString(c.biome))!=null?l:"plains"),parameters:u.Climate.ParamPoint.fromJson(c.parameters)}})((m=u.Json.readObject(o))!=null?m:{})}))!=null?a:[]).map(o=>[o.parameters,()=>o.biome]);return new gr(i)}}const ye=class{getBiome(t,e,r,i){const s=t<<2,a=e<<2,o=r<<2,m=s>>4,c=o>>4;if(m*m+c*c<=4096)return ye.END;const l=Y.context((m*2+1)*8,a,(c*2+1)*8),h=i.erosion.compute(l);return h>.25?ye.HIGHLANDS:h>=-.0625?ye.MIDLANDS:h>=-.21875?ye.BARRENS:ye.ISLANDS}static fromJson(t){return new ye}};let _e=ye;_(_e,"END",B.create("the_end")),_(_e,"HIGHLANDS",B.create("end_highlands")),_(_e,"MIDLANDS",B.create("end_midlands")),_(_e,"ISLANDS",B.create("small_end_islands")),_(_e,"BARRENS",B.create("end_barrens")),u.BiomeSource=void 0,(n=>{function t(r){var a,o;const i=(a=u.Json.readObject(r))!=null?a:{};switch((o=u.Json.readString(i.type))==null?void 0:o.replace(/^minecraft:/,"")){case"fixed":return Ke.fromJson(r);case"checkerboard":return mr.fromJson(r);case"multi_noise":return gr.fromJson(r);case"the_end":return _e.fromJson(r);default:return new Ke(B.create("plains"))}}n.fromJson=t;function e(r,i,s,a,o,m,c,l,h=1,d=!1){if(r instanceof Ke)return m(r.getBiome())?d?{pos:u.BlockPos.create(i,s,a),biome:r.getBiome()}:{pos:u.BlockPos.create(i-o+c.nextInt(o*2+1),s,a-o+c.nextInt(o*2+1)),biome:r.getBiome()}:void 0;const f=i>>2,p=a>>2,v=o>>2,g=s>>2;for(var w=void 0,S=0,E=d?0:v,y=E;y<=v;y+=h)for(var R=-y;R<=y;R+=h){const I=Math.abs(R)===y;for(var A=-y;A<=y;A+=h){if(d&&!(Math.abs(A)===y)&&!I)continue;const x=f+A,C=p+R,M=r.getBiome(x,g,C,l);if(m(M)){if((w===void 0||c.nextInt(S+1)<=.5)&&(w={pos:u.BlockPos.create(x<<2,s,C<<2),biome:M},d))return w;S++}}}return w}n.findBiomeHorizontal=e})(u.BiomeSource||(u.BiomeSource={}));class ea{constructor(t,e){_(this,"noiseCache");_(this,"randomCache");_(this,"random");_(this,"aquiferRandom");_(this,"oreRandom");_(this,"surfaceSystem");_(this,"router");_(this,"sampler");this.seed=e,this.noiseCache=new Map,this.randomCache=new Map,this.random=(t.legacyRandomSource?new ot(e):st.create(e)).forkPositional(),this.aquiferRandom=this.random.fromHashOf(B.create("aquifer").toString()).forkPositional(),this.oreRandom=this.random.fromHashOf(B.create("ore").toString()).forkPositional(),this.surfaceSystem=new Ks(t.surfaceRule,t.defaultBlock,e),this.router=u.NoiseRouter.mapAll(t.noiseRouter,this.createVisitor(t.noise,t.legacyRandomSource)),this.sampler=u.Climate.Sampler.fromRouter(this.router)}createVisitor(t,e){const r=new Map,i=a=>{const o=a.key();if(o===void 0)throw new Error("Cannot create noise without key");if(e){if(o.equals(B.create("temperature")))return new se(new ot(this.seed+BigInt(0)),u.NoiseParameters.create(-7,[1,1]));if(o.equals(B.create("vegetation")))return new se(new ot(this.seed+BigInt(1)),u.NoiseParameters.create(-7,[1,1]));if(o.equals(B.create("offset")))return new se(this.random.fromHashOf("offset"),u.NoiseParameters.create(0,[0]))}return this.getOrCreateNoise(o)},s={map:a=>{if(a instanceof Y.HolderHolder){const o=a.holder.key();if(o!==void 0&&r.has(o.toString()))return r.get(o.toString());{const m=a.holder.value().mapAll(s);return o!==void 0&&r.set(o.toString(),m),m}}if(a instanceof Y.Interpolated)return a.withCellSize(u.NoiseSettings.cellWidth(t),u.NoiseSettings.cellHeight(t));if(a instanceof Y.ShiftedNoise)return new Y.ShiftedNoise(a.shiftX,a.shiftY,a.shiftZ,a.xzScale,a.yScale,a.noiseData,i(a.noiseData));if(a instanceof Y.Noise)return new Y.Noise(a.xzScale,a.yScale,a.noiseData,i(a.noiseData));if(a instanceof Y.ShiftNoise)return a.withNewNoise(i(a.noiseData));if(a instanceof Y.WeirdScaledSampler)return new Y.WeirdScaledSampler(a.input,a.rarityValueMapper,a.noiseData,i(a.noiseData));if(a instanceof Y.OldBlendedNoise){const o=e?new ot(this.seed+BigInt(0)):this.random.fromHashOf(B.create("terrain").toString());return new Y.OldBlendedNoise(a.xzScale,a.yScale,a.xzFactor,a.yFactor,a.smearScaleMultiplier,new Ws(o,a.xzScale,a.yScale,a.xzFactor,a.yFactor,a.smearScaleMultiplier))}return a instanceof Y.EndIslands?new Y.EndIslands(this.seed):a instanceof Y.Mapped||a instanceof Y.Ap2?a.withMinMax():a}};return s}getOrCreateNoise(t){const e=Rt.REGISTRY.getOrThrow(B.create("worldgen/noise"));return Ee(this.noiseCache,t.toString(),r=>new se(this.random.fromHashOf(r),e.getOrThrow(t)))}getOrCreateRandom(t){return Ee(this.randomCache,t.toString(),e=>this.random.fromHashOf(e).forkPositional())}}class Ht{static fromJson(t){var r,i,s,a;const e=(r=u.Json.readObject(t))!=null?r:{};switch((i=u.Json.readString(e.element_type))==null?void 0:i.replace(/^minecraft:/,"")){case"single_pool_element":case"legacy_single_pool_element":const o=B.parse((s=u.Json.readString(e.location))!=null?s:""),m={key:()=>o,value:()=>{var l;return(l=ne.REGISTRY.get(o))!=null?l:ne.EMPTY}};return new Ht.SinlgePoolElement(m);case"list_pool_element":const c=(a=u.Json.readArray("elements",Ht.fromJson))!=null?a:[];return new Ht.ListPoolElement(c);case"feature_pool_element":return new Ht.FeaturePoolElement;case"empty_pool_element":default:return new Ht.EmptyPoolElement}}}(n=>{class t extends n{getBoundingBox(o,m){throw new Error("Invalid call of EmptyPoolElement")}getShuffledJigsawBlocks(o,m){return[]}toString(){return"[Empty Pool Element]"}}n.EmptyPoolElement=t;class e extends n{constructor(){super();_(this,"defaultJigsawNBT");const m=new Map;m.set("name",new _t("minecraft:bottom")),m.set("final_state",new _t("minecraft:air")),m.set("pool",new _t("minecraft:empty")),m.set("target",new _t("minecraft:empty")),m.set("joint",new _t("rollable")),this.defaultJigsawNBT=new mt(m)}getBoundingBox(m,c){return[m,m]}getShuffledJigsawBlocks(m,c){return[{pos:[0,0,0],state:new X(B.create("jigsaw"),{orientation:"down_south"}),nbt:this.defaultJigsawNBT}]}toString(){return"[Feature Pool Element]"}}n.FeaturePoolElement=e;const s=class extends n{constructor(o){super(),this.template=o}getBoundingBox(o,m){const c=u.BlockPos.offset(this.template.value().getSize(),-1,-1,-1),l=o,h=u.BlockPos.add(ne.transform(c,m,u.BlockPos.ZERO),o),d=u.BlockPos.create(Math.min(l[0],h[0]),l[1],Math.min(l[2],h[2])),f=u.BlockPos.create(Math.max(l[0],h[0]),h[1],Math.max(l[2],h[2]));return[d,f]}getShuffledJigsawBlocks(o,m){const c=this.template.value().getBlocks().filter(l=>l.state.getName().equals(s.JIGSAW_ID));return c.forEach(l=>l.pos=ne.transform(l.pos,o,u.BlockPos.ZERO)),Us(c,m),c}toString(){return`[Single Pool Element: ${this.template.key()}]`}};let r=s;_(r,"JIGSAW_ID",B.parse("jigsaw")),n.SinlgePoolElement=r;class i extends n{constructor(o){super(),this.elements=o}getBoundingBox(o,m){var c=void 0,l=void 0;for(const h of this.elements){const d=h.getBoundingBox(o,m);!c||!l?(c=d[0],l=d[1]):(c[0]=Math.min(c[0],d[0][0]),c[1]=Math.min(c[1],d[0][1]),c[2]=Math.min(c[2],d[0][2]),l[0]=Math.min(c[0],d[1][0]),l[1]=Math.min(c[1],d[1][1]),l[2]=Math.min(c[2],d[1][2]))}return[c,l]}getShuffledJigsawBlocks(o,m){return this.elements[0].getShuffledJigsawBlocks(o,m)}toString(){return`[List Pool Element: ${"; ".concat(...this.elements.map(o=>o.toString()))}]`}}n.ListPoolElement=i})(Ht||(Ht={}));const Ze=class{constructor(t,e){_(this,"totalWeight");this.rawTemplates=t,this.fallback=e,this.totalWeight=t.reduce((r,i)=>r+i.weight,0)}static fromJson(t){var s,a,o;const e=(s=u.Json.readObject(t))!=null?s:{},r=Ze.structurePoolParser((a=e.fallback)!=null?a:""),i=(o=u.Json.readArray(e.elements,m=>{var d,f;const c=(d=u.Json.readObject(m))!=null?d:{},l=Ht.fromJson(c.element),h=(f=u.Json.readInt(c.weight))!=null?f:1;return{element:l,weight:h}}))!=null?o:[];return new Ze(i,r)}getRandomTemplate(t){var e=t.nextInt(this.totalWeight);for(const r of this.rawTemplates)if(e-=r.weight,e<0)return r.element;return this.rawTemplates[this.rawTemplates.length-1].element}};let De=Ze;_(De,"REGISTRY",Rt.createAndRegister("worldgen/template_pool",Ze.fromJson)),_(De,"structurePoolParser",u.Holder.parser(Ze.REGISTRY,Ze.fromJson));class pr{constructor(t){this.settings=t}onTopOfChunkCenter(t,e,r,i="WORLD_SURFACE_WG"){const s=(e<<4)+8,a=(r<<4)+8;return[s,t.chunkGenerator.getBaseHeight(s,a,i,t.randomState)-1,a]}getLowestY(t,e,r,i,s){return Math.min(t.chunkGenerator.getBaseHeight(e,r,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(e,r+s,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(e+i,r,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(e+i,r+s,"WORLD_SURFACE_WG",t.randomState)-1)}getLowestYIn5by5BoxOffset7Blocks(t,e,r,i){let s=5,a=5;i===u.Rotation.CLOCKWISE_90?s=-5:i===u.Rotation.CLOCKWISE_180?(s=-5,a=-5):i===u.Rotation.COUNTERCLOCKWISE_90&&(a=-5);const o=(e<<4)+7,m=(r<<4)+7;return u.BlockPos.create(o,this.getLowestY(t,o,m,s,a),m)}tryGenerate(t,e,r){const i=ot.fromLargeFeatureSeed(r.seed,t,e),s=this.findGenerationPoint(t,e,i,r);if(s===void 0)return;const a=r.biomeSource.getBiome(s[0]>>2,s[1]>>2,s[2]>>2,r.randomState.sampler);return[...this.settings.validBiomes.getEntries()].findIndex(o=>{var m;return(m=o.key())==null?void 0:m.equals(a)})>=0?s:void 0}}(n=>{n.REGISTRY=Rt.createAndRegister("worldgen/structure",i);class t{constructor(I){this.validBiomes=I}}n.StructureSettings=t;class e{constructor(I,x,C,M){_(this,"chunkGenerator");_(this,"randomState");this.seed=I,this.biomeSource=x,this.settings=C,this.levelHeight=M,this.randomState=new ea(C,I),this.chunkGenerator=new ta(x,C)}}n.GenerationContext=e;const r=u.Holder.parser(De.REGISTRY,De.fromJson);function i(A){var N,P,H;const I=ve.parser(u.WorldgenRegistries.BIOME),x=(N=u.Json.readObject(A))!=null?N:{},C=I(x.biomes),M=new t(C.value());switch((P=u.Json.readString(x.type))==null?void 0:P.replace(/^minecraft:/,"")){case"buried_treasure":return new a(M);case"desert_pyramid":return new m(M);case"end_city":return new c(M);case"fortress":return new l(M);case"igloo":return new h(M);case"jigsaw":const F=u.HeightProvider.fromJson(x.start_height),T=r(x.start_pool),J=u.Json.readString(x.start_jigsaw_name),U=J?B.parse(J):void 0,W=u.Heightmap.fromJson(x.project_start_to_heightmap),j=s.DimensionPadding.fromJson(x.dimension_padding);return new s(M,T,F,W,U,j);case"jungle_temple":return new d(M);case"mineshaft":const et=u.Json.readString(x.mineshaft_type)==="mesa"?"mesa":"normal";return new f(M,et);case"nether_fossil":return new l(M);case"ocean_monument":return new v(M);case"ocean_ruin":return new g(M);case"ruined_portal":return new w(M);case"shipwreck":const k=(H=u.Json.readBoolean(x.is_beached))!=null?H:!1;return new S(M,k);case"stronghold":return new E(M);case"swamp_hut":return new y(M);case"woodland_mansion":return new R(M)}return new a(M)}n.fromJson=i;class s extends n{constructor(I,x,C,M,N,P){super(I),this.startingPoolHolder=x,this.startHeight=C,this.projectStartToHeightmap=M,this.startJigsawName=N,this.dimensionPadding=P}findGenerationPoint(I,x,C,M){var N=this.startHeight(C,M.settings.noise);const P=u.BlockPos.create(I<<4,N,x<<4),H=u.Rotation.getRandom(C),T=this.startingPoolHolder.value().getRandomTemplate(C);if(!(T instanceof Ht.EmptyPoolElement)){var J;if(this.startJigsawName){const L=s.getRandomNamedJigsaw(T,this.startJigsawName,H,C);if(L===void 0)return;J=L}else J=u.BlockPos.ZERO;const U=u.BlockPos.subtract(P,J),W=T.getBoundingBox(U,H),j=(W[1][0]+W[0][0])/2^0,et=(W[1][2]+W[0][2])/2^0;var N;return this.projectStartToHeightmap?N=P[1]+M.chunkGenerator.getBaseHeight(j,et,this.projectStartToHeightmap,M.randomState):N=U[1],W.forEach(L=>L[1]+=N-W[0][1]-1),s.isStartTooCloseToWorldHeightLimits(this.dimensionPadding,W,M.levelHeight)?void 0:u.BlockPos.create(j,N+J[1],et)}}static isStartTooCloseToWorldHeightLimits(I,x,C){if(I===s.DimensionPadding.ZERO)return!1;const M=C.minY+I.bottom,N=C.minY+C.height-I.top;return x[0][1]<M||x[1][1]>N}static getRandomNamedJigsaw(I,x,C,M){var P,H;const N=I.getShuffledJigsawBlocks(C,M);for(const F of N)if(B.parse((H=(P=F.nbt)==null?void 0:P.getString("name"))!=null?H:"minecraft:empty").equals(x))return F.pos}}n.JigsawStructure=s,(A=>{const x=class{constructor(M,N){this.top=M,this.bottom=N}static fromJson(M){var P,H,F;if(M===void 0)return x.ZERO;if(typeof M=="number")return new x(M,M);const N=(P=u.Json.readObject(M))!=null?P:{};return new x((H=u.Json.readInt(N.top))!=null?H:0,(F=u.Json.readInt(N.bottom))!=null?F:0)}};let I=x;_(I,"ZERO",new x(0,0)),A.DimensionPadding=I})(s=n.JigsawStructure||(n.JigsawStructure={}));class a extends n{findGenerationPoint(I,x,C,M){return this.onTopOfChunkCenter(M,I,x,"OCEAN_FLOOR_WG")}}n.BuriedTreasureStructure=a;class o extends n{constructor(I,x,C){super(I),this.width=x,this.depth=C}findGenerationPoint(I,x,C,M){if(!(this.getLowestY(M,I<<4,x<<4,this.width,this.depth)<M.settings.seaLevel))return this.onTopOfChunkCenter(M,I,x)}}class m extends o{constructor(I){super(I,21,21)}}n.DesertPyramidStructure=m;class c extends n{findGenerationPoint(I,x,C,M){const N=u.Rotation.getRandom(C),P=this.getLowestYIn5by5BoxOffset7Blocks(M,I,x,N);if(!(P[1]<60))return P}}n.EndCityStructure=c;class l extends n{findGenerationPoint(I,x){return u.BlockPos.create(I<<4,64,x<<4)}}n.NetherFortressStructure=l;class h extends n{findGenerationPoint(I,x,C,M){return this.onTopOfChunkCenter(M,I,x)}}n.IglooStructure=h;class d extends o{constructor(I){super(I,12,15)}}n.JungleTempleStructure=d;class f extends n{constructor(I,x){super(I),this.type=x}findGenerationPoint(I,x,C,M){throw new Error("Method not implemented.")}}n.MineshaftStructure=f;class p extends n{constructor(I,x){super(I),this.height=x}findGenerationPoint(I,x){throw new Error("Method not implemented.")}}n.NetherFossilStructure=p;class v extends n{findGenerationPoint(I,x){throw new Error("Method not implemented.")}}n.OceanMonumentStructure=v;class g extends n{findGenerationPoint(I,x,C,M){return this.onTopOfChunkCenter(M,I,x,"OCEAN_FLOOR_WG")}}n.OceanRuinStructure=g;class w extends n{findGenerationPoint(I,x){throw new Error("Method not implemented.")}}n.RuinedPortalStructure=w;class S extends n{constructor(I,x){super(I),this.isBeached=x}findGenerationPoint(I,x,C,M){return this.onTopOfChunkCenter(M,I,x,this.isBeached?"WORLD_SURFACE_WG":"OCEAN_FLOOR_WG")}}n.ShipwreckStructure=S;class E extends n{findGenerationPoint(I,x){return u.BlockPos.create(I<<4,0,x<<4)}}n.StrongholdStructure=E;class y extends n{findGenerationPoint(I,x,C,M){return this.onTopOfChunkCenter(M,I,x)}}n.SwampHutStructure=y;class R extends n{findGenerationPoint(I,x,C,M){const N=u.Rotation.getRandom(C),P=this.getLowestYIn5by5BoxOffset7Blocks(M,I,x,N);if(!(P[1]<60))return P}}n.WoodlandMansionStructure=R})(pr||(pr={}));const On=class{constructor(t,e){this.structures=t,this.placement=e}static fromJson(t){var s,a;const e=(s=u.Json.readObject(t))!=null?s:{},r=(a=u.Json.readArray(e.structures,On.StructureSelectionEntry.fromJson))!=null?a:[],i=Ot.fromJson(e.placement);return new On(r,i)}getStructureInChunk(t,e,r){if(this.placement.prepare(r.biomeSource,r.randomState.sampler,r.seed),!!this.placement.isStructureChunk(r.seed,t,e)&&this.structures.length!==0)if(this.structures.length===1){const i=this.structures[0].structure.value().tryGenerate(t,e,r);if(i!==void 0)return{id:this.structures[0].structure.key(),pos:i}}else{const i=ot.fromLargeFeatureSeed(r.seed,t,e),s=Object.assign([],this.structures);let a=s.reduce((o,m,c)=>o+m.weight,0);for(;s.length>0;){let o=i.nextInt(a),m,c;for([m,c]of s.entries())if(o-=c.weight,o<0)break;const l=c.structure.value().tryGenerate(t,e,r);if(l!==void 0)return{id:c.structure.key(),pos:l};s.splice(m,1),a-=c.weight}}}};let Fe=On;_(Fe,"REGISTRY",Rt.createAndRegister("worldgen/structure_set",On.fromJson)),(n=>{class t{constructor(r,i){this.structure=r,this.weight=i}static fromJson(r){var s,a,o;const i=(s=u.Json.readObject(r))!=null?s:{};return new t(u.Holder.reference(pr.REGISTRY,B.parse((a=u.Json.readString(i.structure))!=null?a:"minecraft:empty")),(o=u.Json.readInt(i.weight))!=null?o:1)}}n.StructureSelectionEntry=t})(Fe||(Fe={}));class Ot{constructor(t,e,r,i,s){this.locateOffset=t,this.frequencyReductionMethod=e,this.frequency=r,this.salt=i,this.exclusionZone=s}static fromJson(t){var c,l,h,d,f,p,v,g,w,S;const e=(c=u.Json.readObject(t))!=null?c:{},r=(l=u.Json.readString(e.type))==null?void 0:l.replace(/^minecraft:/,""),i=u.BlockPos.fromJson(e.locate_offset),s=Ot.FrequencyReducer.fromType((h=u.Json.readString(e.frequency_reduction_method))!=null?h:"default"),a=(d=u.Json.readNumber(e.frequency))!=null?d:1,o=(f=u.Json.readInt(e.salt))!=null?f:0,m="exclusion_zone"in e?Ot.ExclusionZone.fromJson(e.exclusion_zone):void 0;switch(r){case"random_spread":const E=(p=u.Json.readInt(e.spacing))!=null?p:1,y=(v=u.Json.readInt(e.separation))!=null?v:1,R=Ot.SpreadType.fromJson(e.spread_type);return new Ot.RandomSpreadStructurePlacement(i,s,a,o,m,E,y,R);case"concentric_rings":const A=(g=u.Json.readInt(e.distance))!=null?g:1,I=(w=u.Json.readInt(e.spread))!=null?w:1,x=(S=u.Json.readInt(e.count))!=null?S:1,C=ve.parser(u.WorldgenRegistries.BIOME)(e.preferred_biomes);return new Ot.ConcentricRingsStructurePlacement(i,s,a,o,m,A,I,x,C)}return new Ot.RandomSpreadStructurePlacement([0,0,0],Ot.FrequencyReducer.ProbabilityReducer,1,0,void 0,1,1,"linear")}isStructureChunk(t,e,r){return this.isPlacementChunk(t,e,r)?this.frequency<1&&!this.frequencyReductionMethod(t,this.salt,e,r,this.frequency)?!1:!(this.exclusionZone&&this.exclusionZone.isPlacementForbidden(t,e,r)):!1}prepare(t,e,r){}}(n=>{(s=>{function a(h){switch(h){case"legacy_type_1":return l;case"legacy_type_2":return c;case"legacy_type_3":return m;case"default":default:return o}}s.fromType=a;function o(h,d,f,p,v){return ot.fromLargeFeatureWithSalt(h,d,f,p).nextFloat()<v}s.ProbabilityReducer=o;function m(h,d,f,p,v){return ot.fromLargeFeatureSeed(h,f,p).nextDouble()<v}s.LegacyProbabilityReducerWithDouble=m;function c(h,d,f,p,v){return ot.fromLargeFeatureWithSalt(h,f,p,10387320).nextFloat()<v}s.LegacyArbitrarySaltProbabilityReducer=c;function l(h,d,f,p,v){const g=f>>4,w=p>>4,S=new ot(BigInt(g^w<<4)^h);return S.nextInt(),S.nextInt(Math.floor(1/v))===0}s.LegacyPillagerOutpostReducer=l})(n.FrequencyReducer||(n.FrequencyReducer={}));class t{constructor(a,o){this.otherSet=a,this.chunkCount=o}static fromJson(a){var m,c,l;const o=(m=u.Json.readObject(a))!=null?m:{};return new t(u.Holder.reference(Fe.REGISTRY,B.parse((c=u.Json.readString(o.other_set))!=null?c:"")),(l=u.Json.readInt(o.chunk_count))!=null?l:1)}isPlacementForbidden(a,o,m){const c=this.otherSet.value().placement;return c.getPotentialStructureChunks(a,o-this.chunkCount,m-this.chunkCount,o+this.chunkCount,m+this.chunkCount).findIndex(l=>Math.abs(l[0]-o)<=this.chunkCount&&Math.abs(l[1]-m)<=this.chunkCount&&c.isStructureChunk(a,l[0],l[1]))>=0}}n.ExclusionZone=t,(s=>{function a(o){var c;return((c=u.Json.readString(o))!=null?c:"linear")==="triangular"?"triangular":"linear"}s.fromJson=a})(n.SpreadType||(n.SpreadType={}));class e extends n{constructor(a,o,m,c,l,h,d,f){super(a,o,m,c,l),this.spacing=h,this.separation=d,this.spreadType=f}evaluateSpread(a,o){switch(this.spreadType){case"linear":return a.nextInt(o);case"triangular":return Math.floor((a.nextInt(o)+a.nextInt(o))/2)}}getPotentialStructureChunk(a,o,m){const c=Math.floor(o/this.spacing),l=Math.floor(m/this.spacing),h=ot.fromLargeFeatureWithSalt(a,c,l,this.salt),d=this.spacing-this.separation,f=this.evaluateSpread(h,d),p=this.evaluateSpread(h,d);return[c*this.spacing+f,l*this.spacing+p]}isPlacementChunk(a,o,m){const[c,l]=this.getPotentialStructureChunk(a,o,m);return c===o&&l===m}getPotentialStructureChunks(a,o,m,c,l){const h=[];for(let d=Math.floor(o/this.spacing)*this.spacing;d<=c;d+=this.spacing)for(let f=Math.floor(m/this.spacing)*this.spacing;f<=l;f+=this.spacing)h.push(this.getPotentialStructureChunk(a,d,f));return h}}n.RandomSpreadStructurePlacement=e;const r=112;class i extends n{constructor(o,m,c,l,h,d,f,p,v){super(o,m,c,l,h);_(this,"positions");this.distance=d,this.spread=f,this.count=p,this.preferredBiomes=v}prepare(o,m,c){if(this.positions!==void 0||(this.positions=[],this.count===0))return;const l=new ot(c);var h=l.nextDouble()*Math.PI*2,d=this.spread,f=0,p=0;const v=[...this.preferredBiomes.value().getEntries()].flatMap(w=>{var S;return(S=w.key())!=null?S:[]});for(var g=0;g<this.count;g++){const w=4*this.distance+this.distance*f*6+(l.nextDouble()-.5)*this.distance*2.5,S=Math.round(Math.cos(h)*w),E=Math.round(Math.sin(h)*w),y=(S<<4)+8,R=(E<<4)+8,A=l.fork(),I=()=>{const x=u.BiomeSource.findBiomeHorizontal(o,y,0,R,r,C=>v.findIndex(M=>M.equals(C))>=0,A,m);return x?[x.pos[0]>>4,x.pos[2]>>4]:[S,E]};this.positions.push({center:[S,E],real:I}),h+=Math.PI*2/d,p++,p==d&&(f++,p=0,d+=2*d/(f+1),d=Math.min(d,this.count-g),h+=l.nextDouble()*Math.PI*2)}}isPlacementChunk(o,m,c){return this.positions===void 0?(console.warn("trying to access concentric rings placement before position calculation"),!1):this.getPotentialStructureChunks(o,m,c,m,c).findIndex(l=>l[0]===m&&l[1]===c)>=0}getPotentialStructureChunks(o,m,c,l,h){if(this.positions===void 0)return console.warn("trying to access concentric rings placement before position calculation"),[];const d=[];for(const f of this.positions)f.center[0]<m-(r>>4)||f.center[0]>l+(r>>4)||f.center[1]<c-(r>>4)||f.center[1]>h+(r>>4)||(f.real instanceof Function&&(f.real=f.real()),d.push(f.real));return d}}n.ConcentricRingsStructurePlacement=i})(Ot||(Ot={})),u.BlendedNoise=Ws,u.BlockColors=Oe,u.BlockDefinition=ii,u.BlockModel=ct,u.BlockState=X,u.CheckerboardBiomeSource=mr,u.Chunk=ol,u.ChunkBuilder=Xs,u.ChunkSection=We,u.DensityFunction=Y,u.EFFECT_COLORS=Ps,u.FixedBiomeSource=Ke,u.FluidStatus=Ln,u.HolderSet=ve,u.Identifier=B,u.ImprovedNoise=ri,u.ItemRenderer=dr,u.ItemStack=Yt,u.LegacyPositionalRandom=Ys,u.LegacyRandom=ot,u.Line=hr,u.Matrix3=Cn,u.Matrix4=cr,u.Mesh=rt,u.MultiNoiseBiomeSource=gr,u.NbtAbstractList=kn,u.NbtByte=Lt,u.NbtByteArray=me,u.NbtChunk=te,u.NbtCompound=mt,u.NbtDouble=ee,u.NbtEnd=An,u.NbtFile=$t,u.NbtFloat=Be,u.NbtInt=Dt,u.NbtIntArray=ge,u.NbtList=xt,u.NbtLong=Te,u.NbtLongArray=pe,u.NbtRegion=we,u.NbtShort=Le,u.NbtString=_t,u.NbtTag=nt,u.NbtType=z,u.NoiseAquifer=ze,u.NoiseChunk=oi,u.NoiseChunkGenerator=ta,u.NormalNoise=se,u.POTION_EFFECTS=Os,u.PalettedContainer=Ls,u.PerlinNoise=vt,u.PerlinSimplexNoise=Xl,u.Quad=Wt,u.RandomState=ea,u.RawDataInput=hi,u.RawDataOutput=fi,u.Registry=Rt,u.Renderer=fr,u.ShaderProgram=Bn,u.SimplexNoise=pt,u.StringReader=Et,u.Structure=ne,u.StructurePlacement=Ot,u.StructurePoolElement=Ht,u.StructureRenderer=uu,u.StructureSet=Fe,u.StructureTemplatePool=De,u.SurfaceContext=Qs,u.SurfaceSystem=Ks,u.TextureAtlas=Tn,u.Vector=$,u.Vertex=Pt,u.VoxelRenderer=du,u.WorldgenStructure=pr,u.XoroshiroPositionalRandom=qs,u.XoroshiroRandom=st,u.binarySearch=Fs,u.clamp=bt,u.clampedLerp=nr,u.clampedMap=Wr,u.computeIfAbsent=Ee,u.floatLerp=$r,u.getSeed=Xr,u.intFloor=qt,u.inverseLerp=qr,u.isPowerOfTwo=jr,u.jsonToNbt=Vr,u.lazy=an,u.lazyLerp=Mn,u.lazyLerp2=Yr,u.lazyLerp3=zs,u.lerp=Pe,u.lerp2=er,u.lerp3=Js,u.longFloor=Ds,u.longfromBytes=ir,u.map=xn,u.mutateWithDefault=_r,u.nextInt=ar,u.randomBetweenInclusive=sr,u.shuffle=Us,u.smoothstep=rr,u.square=re,u.upperPowerOfTwo=Hs,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
